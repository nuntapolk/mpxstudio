<!DOCTYPE html>
<html lang="th" data-theme="dark">
<script>
  // Apply system theme immediately before render to avoid flash
  (function(){
    const mq = window.matchMedia('(prefers-color-scheme: dark)');
    document.documentElement.setAttribute('data-theme', mq.matches ? 'dark' : 'light');
  })();
</script>
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>MPX Studio EA Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}

/* ── THEME VARIABLES ─────────────────────────────────────── */
:root{
  --font:'Syne',system-ui,sans-serif;
  --mono:'JetBrains Mono',monospace;
  --invest:#00d68f;--grow:#4a9eff;--tolerate:#ffa000;--retire:#ff4757;
  --accent:#00e5ff;--accent2:#7b61ff;--accent3:#ff9f43;
  --green:#00d68f;--red:#ff4757;--yellow:#ffa000;--blue:#4a9eff;
  --radius:12px;
  --transition:.22s ease;
}

/* DARK */
[data-theme="dark"]{
  --bg:#070d1a;--bg2:#0d1626;
  --card:#0f1c2e;--card2:#142035;--card3:#1a2a40;
  --border:#1a2d47;--border2:#243d5e;
  --text:#dde6f0;--dim:#6b84a0;--muted:#3d5470;
  --nav-bg:rgba(7,13,26,.88);
  --shadow:0 8px 32px rgba(0,0,0,.5);
  --chart-grid:rgba(26,45,71,.5);
}

/* LIGHT */
[data-theme="light"]{
  --bg:#f0f4fb;--bg2:#e6ecf7;
  --card:#ffffff;--card2:#f5f8ff;--card3:#edf1f9;
  --border:#d4dff0;--border2:#b8cce4;
  --text:#1a2540;--dim:#5872a0;--muted:#9aaecc;
  --nav-bg:rgba(240,244,251,.92);
  --shadow:0 4px 20px rgba(0,60,160,.08);
  --chart-grid:rgba(180,200,230,.4);
  --accent:#0066cc;--accent2:#5a3fd4;--accent3:#c47800;
  --invest:#00a068;--grow:#2272cc;--tolerate:#c47800;--retire:#d43030;
  --green:#00a068;--red:#d43030;--yellow:#c47800;--blue:#2272cc;
}

body{
  font-family:var(--font);
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  overflow-x:hidden;
  transition:background var(--transition),color var(--transition);
  display:flex;
  flex-direction:column;
}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:var(--bg2)}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:3px}

/* ── TOP BAR ─────────────────────────────────────────────── */
#topbar{
  position:fixed;top:0;left:0;right:0;z-index:300;
  height:52px;
  background:var(--nav-bg);
  backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);
  border-bottom:1px solid var(--border);
  display:flex;align-items:center;padding:0 16px;gap:12px;
}
.logo{display:flex;align-items:center;gap:10px;flex-shrink:0}
.logo-icon{
  width:44px;height:44px;border-radius:8px;
  overflow:hidden;flex-shrink:0;
  display:flex;align-items:center;justify-content:center;
  background:#000;
}
.logo-icon img{
  width:100%;height:100%;object-fit:contain;
  display:block;
}
.logo-title{font-size:14px;font-weight:800;color:var(--text);letter-spacing:-.3px;line-height:1.1}
.logo-sub{font-size:10px;color:var(--dim);font-family:var(--mono)}

/* Sidebar toggle */
#sidebar-toggle{
  background:none;border:none;cursor:pointer;
  color:var(--dim);padding:7px;border-radius:7px;
  font-size:16px;transition:all .15s;line-height:1;
  display:flex;align-items:center;justify-content:center;
}
#sidebar-toggle:hover{background:var(--card);color:var(--text)}

/* Breadcrumb */
#topbar-breadcrumb{
  flex:1;font-size:12px;color:var(--dim);font-family:var(--mono);
  display:flex;align-items:center;gap:6px;overflow:hidden;white-space:nowrap;
}
#topbar-breadcrumb .bc-sep{opacity:.3}
#topbar-breadcrumb .bc-current{color:var(--text);font-weight:600}

/* Topbar right */
.topbar-right{display:flex;align-items:center;gap:8px;flex-shrink:0;margin-left:auto}
.btn-add{
  padding:6px 14px;border-radius:8px;border:1px solid var(--accent);
  background:rgba(0,229,255,.1);color:var(--accent);cursor:pointer;font-size:12px;font-weight:700;
  font-family:var(--font);white-space:nowrap;transition:all .18s;
}
.btn-add:hover{background:rgba(0,229,255,.2)}
[data-theme="light"] .btn-add{background:rgba(0,102,204,.08);border-color:rgba(0,102,204,.4);color:var(--accent)}

/* Theme toggle */
.theme-toggle{
  display:flex;align-items:center;gap:2px;background:var(--card3);
  border:1px solid var(--border2);border-radius:8px;padding:3px;
}
.theme-btn{
  padding:4px 7px;border-radius:5px;border:none;background:none;
  color:var(--dim);cursor:pointer;font-size:13px;transition:all .15s;line-height:1;
}
.theme-btn:hover{color:var(--text)}
.theme-btn.active{background:var(--accent);color:#000}
[data-theme="light"] .theme-btn.active{background:var(--accent);color:#fff}

/* ── APP SHELL ───────────────────────────────────────────── */
#app-shell{
  display:flex;
  padding-top:52px;
  min-height:100vh;
}

/* ── SIDEBAR ─────────────────────────────────────────────── */
#sidebar{
  width:240px;
  flex-shrink:0;
  background:var(--bg2);
  border-right:1px solid var(--border);
  position:fixed;
  top:52px;left:0;bottom:0;
  overflow-y:auto;overflow-x:hidden;
  transition:width .25s ease, transform .25s ease;
  z-index:200;
  display:flex;flex-direction:column;
}
#sidebar.collapsed{width:54px}
#sidebar::-webkit-scrollbar{width:3px}

/* Sidebar sections */
.sb-section{padding:10px 8px 4px}
.sb-section-label{
  font-size:9px;font-family:var(--mono);text-transform:uppercase;
  letter-spacing:.8px;color:var(--muted);padding:0 6px 4px;
  display:flex;align-items:center;gap:6px;white-space:nowrap;overflow:hidden;
}
.sb-section-label .sl-line{flex:1;height:1px;background:var(--border);min-width:0}
#sidebar.collapsed .sb-section-label span{display:none}
#sidebar.collapsed .sb-section-label .sl-line{display:none}
#sidebar.collapsed .sb-section-label{justify-content:center;padding:4px 0}
#sidebar.collapsed .sb-section-label::before{content:'·';color:var(--border2);font-size:14px}

/* Sidebar nav items */
.sb-item{
  display:flex;align-items:center;gap:10px;
  padding:8px 10px;border-radius:8px;
  cursor:pointer;font-size:12px;font-weight:600;font-family:var(--font);
  color:var(--dim);border:none;background:none;width:100%;text-align:left;
  transition:all .15s;white-space:nowrap;overflow:hidden;
  position:relative;
}
.sb-item:hover{color:var(--text);background:var(--card)}
.sb-item.active{
  background:rgba(0,229,255,.12);color:var(--accent);
}
[data-theme="light"] .sb-item.active{background:rgba(0,102,204,.1);color:var(--accent)}
.sb-item.active::before{
  content:'';position:absolute;left:0;top:4px;bottom:4px;
  width:3px;border-radius:0 2px 2px 0;background:var(--accent);
}
.sb-item .si-icon{
  font-size:15px;flex-shrink:0;width:22px;text-align:center;
  transition:transform .15s;
}
.sb-item .si-label{flex:1;overflow:hidden;text-overflow:ellipsis}
.sb-item .si-badge{
  font-size:9px;background:var(--red);color:#fff;border-radius:10px;
  padding:1px 5px;font-family:var(--mono);font-weight:700;flex-shrink:0;
  transition:opacity .2s;
}
#sidebar.collapsed .si-label{display:none}
#sidebar.collapsed .si-badge{display:none}
#sidebar.collapsed .sb-item{justify-content:center;padding:8px 0}
#sidebar.collapsed .sb-item.active::before{left:0;top:0;bottom:0;width:3px;border-radius:0}

/* Sidebar tooltip — always-on rich tooltip */
.sb-item{position:relative}
.sb-tooltip-popup{
  position:fixed;left:0;top:0;
  background:var(--card2);border:1px solid var(--border2);
  border-radius:8px;padding:8px 12px;
  box-shadow:0 4px 16px rgba(0,0,0,.18);
  pointer-events:none;opacity:0;transition:opacity .15s;
  z-index:9999;min-width:180px;max-width:240px;
}
.sb-tooltip-popup.visible{opacity:1}
.sb-tooltip-title{
  font-size:12px;font-weight:700;color:var(--text);
  font-family:var(--font);line-height:1.3;margin-bottom:3px;
}
.sb-tooltip-desc{
  font-size:11px;color:var(--dim);font-family:var(--font);
  line-height:1.5;
}

/* Keep old collapsed tooltip hidden (replaced by JS tooltip) */
#sidebar.collapsed .sb-item::after{display:none}

/* Sidebar divider */
.sb-divider{height:1px;background:var(--border);margin:6px 10px}

/* ─── ASSET MANAGEMENT STYLES ─── */
.wt-item{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid var(--border2)}
.wt-item:last-child{border-bottom:none}
.wt-bar{flex:1;height:6px;background:var(--card2);border-radius:3px;overflow:hidden}
.wt-fill{height:100%;border-radius:3px}
.comp-bar{height:12px;background:var(--card2);border-radius:6px;overflow:hidden;margin:4px 0}
.comp-fill{height:100%;border-radius:6px;transition:width .6s}
.vg{display:grid;grid-template-columns:repeat(4,1fr);gap:7px}
.asset-vc{background:var(--card2);border:1px solid var(--border2);border-radius:7px;padding:9px;text-align:center}
.asset-vn{font-size:11px;font-weight:600;color:var(--text);margin-bottom:3px}
.asset-vv{font-family:var(--mono);font-size:18px;font-weight:800;margin-bottom:1px}
.asset-ic{background:var(--card2);border:1px solid var(--border2);border-radius:7px;padding:10px;border-left:3px solid}
.asset-ic.warn{border-left-color:#f0c040}.asset-ic.danger{border-left-color:#e05a5a}.asset-ic.ok{border-left-color:#2ecc8a}.asset-ic.info{border-left-color:var(--accent)}
.asset-it2{font-size:11px;font-weight:600;color:var(--text);margin-bottom:3px}
.asset-ib2{font-size:10px;color:var(--dim);line-height:1.5}
.asset-ic-g3{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:14px}
.eyr{margin-bottom:12px}
.eyl{font-family:var(--mono);font-size:10px;margin-bottom:5px;display:flex;align-items:center;gap:7px}
.ech{display:flex;flex-wrap:wrap;gap:4px}
.ec{padding:2px 8px;border-radius:4px;font-size:10px}
.asset-mo{display:none;position:fixed;inset:0;background:rgba(0,0,0,.65);backdrop-filter:blur(6px);z-index:200;align-items:center;justify-content:center}
.asset-mo.open{display:flex}
.asset-mdl{background:var(--card);border:1px solid var(--border2);border-radius:14px;padding:22px;width:640px;max-height:90vh;overflow-y:auto}
.asset-mdt{font-size:16px;font-weight:800;margin-bottom:14px;display:flex;align-items:center;color:var(--text)}
.asset-mcl{margin-left:auto;background:none;border:none;color:var(--dim);cursor:pointer;font-size:17px;border-radius:4px;padding:2px 5px}
.asset-mcl:hover{background:var(--card2);color:var(--text)}
.asset-fss{font-family:var(--mono);font-size:9px;color:var(--dim);letter-spacing:1.5px;text-transform:uppercase;margin:12px 0 6px;border-bottom:1px solid var(--border);padding-bottom:4px}
.asset-fr2{display:grid;grid-template-columns:1fr 1fr;gap:9px}
.asset-fr3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:9px}
.asset-fg{display:flex;flex-direction:column;gap:4px;margin-bottom:9px}
.asset-fl{font-size:11px;color:var(--dim)}
.asset-fi,.asset-fsl,.asset-fta{background:var(--card2);border:1px solid var(--border2);border-radius:7px;padding:7px 10px;color:var(--text);font-size:12px;outline:none;transition:border-color .15s;font-family:inherit}
.asset-fi:focus,.asset-fsl:focus,.asset-fta:focus{border-color:var(--accent)}
.asset-fta{resize:vertical;min-height:50px}
.asset-fsl option{background:var(--card2)}
.asset-mff{display:flex;justify-content:flex-end;gap:7px;margin-top:14px;padding-top:11px;border-top:1px solid var(--border)}
.asset-conf{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:300;align-items:center;justify-content:center}
.asset-conf.open{display:flex}
.asset-cb2{background:var(--card);border:1px solid var(--border2);border-radius:12px;padding:22px;width:380px}
.asset-filter-row{display:flex;gap:6px;margin-bottom:12px;flex-wrap:wrap;align-items:center}
.asset-ft{padding:5px 12px;border-radius:20px;border:1px solid var(--border2);background:transparent;color:var(--dim);font-size:11px;cursor:pointer;transition:all .15s}
.asset-ft:hover{background:var(--card2);color:var(--text)}
.asset-ft.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.asset-search{background:var(--card2);border:1px solid var(--border2);border-radius:7px;padding:5px 10px;color:var(--text);font-size:11px;outline:none;margin-left:auto;min-width:160px}
.asset-search:focus{border-color:var(--accent)}

/* Sidebar bottom */
.sb-bottom{margin-top:auto;padding:8px;border-top:1px solid var(--border)}
.sb-app-count{
  font-size:10px;color:var(--muted);font-family:var(--mono);
  text-align:center;padding:6px;
}
#sidebar.collapsed .sb-app-count{display:none}

/* ── MAIN CONTENT ────────────────────────────────────────── */
#content-area{
  flex:1;
  margin-left:240px;
  transition:margin-left .25s ease;
  min-width:0;
}
#app-shell.sidebar-collapsed #content-area{margin-left:54px}

#main{padding:22px;max-width:1400px;margin:0 auto}
.view{display:none;animation:fadeIn .25s ease}
.view.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

/* Page header */
.page-header{
  display:flex;align-items:center;gap:10px;margin-bottom:20px;padding-bottom:14px;
  border-bottom:1px solid var(--border);
}
.page-header-icon{
  width:38px;height:38px;border-radius:10px;
  display:flex;align-items:center;justify-content:center;font-size:18px;
  flex-shrink:0;
}
.page-header-title{font-size:18px;font-weight:800;color:var(--text);letter-spacing:-.3px;line-height:1.1}
.page-header-sub{font-size:11px;color:var(--dim);font-family:var(--mono);margin-top:2px}

@media(max-width:900px){
  #sidebar{transform:translateX(-100%)}
  #sidebar.mobile-open{transform:translateX(0);width:240px}
  #sidebar.mobile-open .si-label{display:block}
  #sidebar.mobile-open .si-badge{display:block}
  #sidebar.mobile-open .sb-item{justify-content:flex-start;padding:8px 10px}
  #content-area{margin-left:0 !important}
  #main{padding:14px}
  .grid-2,.grid-3{grid-template-columns:1fr}
  .kpi{min-width:140px}
  .form-grid,.grid-4{grid-template-columns:1fr}
  .form-field.full{grid-column:span 1}
  .modal{width:95vw;padding:20px}
  .rm-label{width:120px}
  .rm-headers{margin-left:132px}
  .release-calendar{grid-template-columns:repeat(6,1fr)}
}

/* ── CARDS ───────────────────────────────────────────────── */
.card{
  background:var(--card);border:1px solid var(--border);
  border-radius:var(--radius);padding:20px;
  transition:background var(--transition),border-color var(--transition);
}
.card-title{
  font-size:14px;font-weight:700;color:var(--text);
  margin-bottom:14px;letter-spacing:-.2px;
  display:flex;align-items:center;gap:8px;
}
.card-title::before{content:'';display:block;width:3px;height:14px;border-radius:2px;background:var(--accent)}

/* ── CHART EXPAND BUTTON ─────────────────────────────────── */
.chart-expand-wrap{position:relative}
.chart-expand-btn{
  position:absolute;top:0;right:0;
  width:26px;height:26px;border-radius:6px;border:1px solid var(--border2);
  background:var(--card2);color:var(--dim);cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  font-size:13px;opacity:0;transition:opacity .2s,color .15s,border-color .15s;
  z-index:5;line-height:1;
}
.chart-expand-wrap:hover .chart-expand-btn,
.card:hover .chart-expand-btn{opacity:1}
.chart-expand-btn:hover{color:var(--accent);border-color:var(--accent);background:rgba(0,229,255,.08)}

/* ── CHART MODAL ─────────────────────────────────────────── */
.chart-modal-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.72);backdrop-filter:blur(4px);
  z-index:9000;display:flex;align-items:center;justify-content:center;
  opacity:0;transition:opacity .22s ease;pointer-events:none;
}
.chart-modal-overlay.open{opacity:1;pointer-events:all}
.chart-modal-box{
  background:var(--card);border:1px solid var(--border2);border-radius:16px;
  width:min(92vw,1200px);max-height:88vh;
  display:flex;flex-direction:column;
  box-shadow:0 24px 80px rgba(0,0,0,.5);
  transform:translateY(24px) scale(.97);
  transition:transform .22s cubic-bezier(.34,1.56,.64,1);
  overflow:hidden;
}
.chart-modal-overlay.open .chart-modal-box{transform:translateY(0) scale(1)}
.chart-modal-header{
  display:flex;align-items:center;gap:10px;
  padding:16px 20px;border-bottom:1px solid var(--border);flex-shrink:0;
}
.chart-modal-header .card-title{margin:0;flex:1;font-size:16px}
.chart-modal-header .card-title::before{height:16px}
.chart-modal-close{
  width:32px;height:32px;border-radius:8px;border:1px solid var(--border2);
  background:var(--card2);color:var(--dim);cursor:pointer;
  display:flex;align-items:center;justify-content:center;font-size:16px;
  transition:all .15s;flex-shrink:0;
}
.chart-modal-close:hover{color:var(--red);border-color:var(--red);background:rgba(255,71,87,.08)}
.chart-modal-body{
  flex:1;padding:24px;overflow:auto;
  display:flex;flex-direction:column;gap:16px;
}
.chart-modal-canvas-wrap{
  position:relative;width:100%;flex:1;min-height:420px;
}
.chart-modal-actions{
  display:flex;gap:10px;justify-content:flex-end;flex-shrink:0;
  padding-top:12px;border-top:1px solid var(--border);
}
.chart-modal-action-btn{
  display:flex;align-items:center;gap:6px;padding:7px 16px;
  border-radius:8px;border:1px solid var(--border2);background:var(--card2);
  color:var(--dim);font-size:12px;font-weight:600;cursor:pointer;
  font-family:var(--font);transition:all .15s;
}
.chart-modal-action-btn:hover{border-color:var(--accent);color:var(--accent);background:rgba(0,229,255,.07)}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
/* Asset Dashboard tiles */
.dash-ht{background:var(--card2);border:1px solid var(--border2);border-radius:8px;padding:12px 10px;text-align:center;cursor:pointer;transition:border-color .12s,transform .12s}
.dash-ht:hover{border-color:var(--accent);transform:translateY(-2px)}
.dash-ht-type{font-size:8px;font-family:var(--mono);color:var(--dim);letter-spacing:.8px;margin-bottom:5px;text-transform:uppercase}
.dash-ht-score{font-size:20px;font-weight:700;font-family:var(--mono);line-height:1;margin-bottom:4px}
.dash-ht-bar{height:3px;background:var(--border);border-radius:2px;overflow:hidden;margin-bottom:5px}
.dash-ht-fill{height:100%;border-radius:2px;transition:width .6s ease}
.dash-ht-count{font-size:10px;color:var(--dim)}
.dash-ht-warn{font-size:9px;font-family:var(--mono);margin-top:3px}
.dash-exp-row{display:flex;align-items:center;gap:9px;padding:8px 0;border-bottom:1px solid var(--border);cursor:pointer;transition:background .1s}
.dash-exp-row:hover{background:var(--card2);margin:0 -4px;padding-left:4px;padding-right:4px;border-radius:4px}
.dash-exp-row:last-child{border:none;padding-bottom:0}
.dash-exp-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.dash-exp-info{flex:1;min-width:0}
.dash-exp-name{font-size:11px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--text)}
.dash-exp-meta{font-size:9px;color:var(--dim);font-family:var(--mono);margin-top:1px}
.dash-exp-tag{font-size:9px;font-family:var(--mono);font-weight:600;padding:2px 8px;border-radius:3px;white-space:nowrap;flex-shrink:0}
.dash-comp-row{margin-bottom:9px}
.dash-comp-row:last-child{margin-bottom:0}
.dash-comp-hd{display:flex;justify-content:space-between;align-items:center;margin-bottom:3px}
.dash-comp-name{font-size:11px;color:var(--text)}
.dash-comp-pct{font-size:11px;font-family:var(--mono);font-weight:700}
.dash-comp-track{height:4px;background:var(--border);border-radius:2px;overflow:hidden}
.dash-comp-fill{height:100%;border-radius:2px;transition:width .6s ease}
.dash-vrow{display:flex;align-items:center;justify-content:space-between;padding:6px 10px;background:var(--card2);border:1px solid var(--border);border-radius:6px;margin-bottom:5px}
.dash-vrow:last-child{margin-bottom:0}
.dash-arow{display:flex;align-items:flex-start;gap:10px;background:var(--card2);border:1px solid var(--border);border-radius:8px;padding:10px 12px;cursor:pointer;transition:border-color .12s;margin-bottom:7px}
.dash-arow:last-child{margin-bottom:0}
.dash-arow:hover{border-color:var(--border2)}
.dash-arow-crit{border-left:3px solid var(--red)}
.dash-arow-high{border-left:3px solid #f07840}
.dash-arow-med{border-left:3px solid var(--yellow)}
.dash-arow-prog{border-left:3px solid var(--accent)}
.dash-ago{font-size:9px;font-family:var(--mono);font-weight:600;padding:3px 9px;border-radius:4px;flex-shrink:0;align-self:center;border:1px solid var(--border2);color:var(--dim);background:var(--card);white-space:nowrap;cursor:pointer;transition:all .12s}
.dash-ago:hover{color:var(--text);border-color:var(--border2)}
.grid-4{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:14px}
.row{display:flex;gap:14px;margin-bottom:16px;flex-wrap:wrap}
.mb16{margin-bottom:16px}

/* ── KPI CARDS ───────────────────────────────────────────── */
.kpi{
  background:var(--card);border:1px solid var(--border);border-radius:var(--radius);
  padding:18px 20px;flex:1;min-width:160px;position:relative;overflow:hidden;
  transition:all var(--transition);
}
.kpi::after{
  content:'';position:absolute;top:-30px;right:-30px;width:80px;height:80px;
  border-radius:50%;background:var(--kpi-color,var(--accent));opacity:.07;pointer-events:none;
}
.kpi-label{font-size:11px;color:var(--dim);font-family:var(--mono);text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.kpi-value{font-size:28px;font-weight:800;color:var(--kpi-color,var(--accent));letter-spacing:-1px;line-height:1}
.kpi-sub{font-size:11px;color:var(--dim);margin-top:5px}

/* ── BADGES ──────────────────────────────────────────────── */
.badge{
  display:inline-flex;align-items:center;border-radius:4px;
  padding:2px 8px;font-size:11px;font-weight:700;
  font-family:var(--mono);letter-spacing:.2px;flex-shrink:0;
}

/* ── HEALTH BAR ──────────────────────────────────────────── */
.hbar-wrap{background:var(--border);border-radius:4px;overflow:hidden;flex-shrink:0}
.hbar-fill{height:100%;border-radius:4px;transition:width .4s ease}

/* ── TABLE ───────────────────────────────────────────────── */
.tbl{width:100%;border-collapse:collapse;font-size:13px}
.tbl th{
  color:var(--dim);font-size:11px;font-family:var(--mono);padding:9px 12px;
  border-bottom:1px solid var(--border);text-align:left;font-weight:600;
  text-transform:uppercase;letter-spacing:.4px;white-space:nowrap;
}
.tbl td{padding:9px 12px;border-bottom:1px solid var(--border);opacity:.95;vertical-align:middle}
.tbl tr:hover td{background:rgba(0,229,255,.03)}
.tbl-scroll{overflow-x:auto;max-height:500px;overflow-y:auto}
.sticky-header th{position:sticky;top:0;background:var(--card);z-index:10}
[data-theme="light"] .tbl tr:hover td{background:rgba(0,102,204,.04)}

/* ── PORTFOLIO CARDS ─────────────────────────────────────── */
#port-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(290px,1fr));gap:14px}
.app-card{
  background:var(--card);border:1px solid var(--border);border-radius:var(--radius);
  padding:18px;cursor:pointer;transition:all .2s;position:relative;overflow:hidden;
}
.app-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;border-radius:12px 12px 0 0}
.app-card.invest::before{background:var(--invest)}.app-card.grow::before{background:var(--grow)}
.app-card.tolerate::before{background:var(--tolerate)}.app-card.retire::before{background:var(--retire)}
.app-card:hover{border-color:var(--border2);transform:translateY(-2px);box-shadow:var(--shadow)}
.app-name{font-size:14px;font-weight:700;color:var(--text);margin-bottom:2px}
.app-id{font-size:11px;color:var(--dim);font-family:var(--mono)}
.app-meta{display:flex;gap:6px;margin:10px 0;flex-wrap:wrap}
.app-stats{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:12px;font-size:12px}
.app-stat-item{color:var(--dim)}.app-stat-item span{color:var(--text);font-weight:600}
.tech-tags{display:flex;gap:4px;flex-wrap:wrap;margin-top:10px}
.tech-tag{
  background:rgba(0,229,255,.08);color:var(--accent);
  border:1px solid rgba(0,229,255,.15);border-radius:4px;padding:1px 6px;
  font-size:10px;font-family:var(--mono);
}
[data-theme="light"] .tech-tag{background:rgba(0,102,204,.06);border-color:rgba(0,102,204,.2)}

/* ── APP ZOOM BUTTON ─────────────────────────────────────── */
.app-zoom-btn{
  position:absolute;top:10px;right:10px;
  width:26px;height:26px;border-radius:7px;
  border:1px solid var(--border2);background:var(--card2);
  color:var(--dim);cursor:pointer;font-size:13px;
  display:flex;align-items:center;justify-content:center;
  opacity:0;transition:opacity .18s,color .15s,border-color .15s,background .15s;
  z-index:4;line-height:1;
}
.app-card:hover .app-zoom-btn{opacity:1}
.app-zoom-btn:hover{color:var(--accent);border-color:var(--accent);background:rgba(0,229,255,.1)!important}

/* ── APP QUICK VIEW MODAL ────────────────────────────────── */
.aqv-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.72);backdrop-filter:blur(5px);
  z-index:9100;display:flex;align-items:center;justify-content:center;
  opacity:0;transition:opacity .22s;pointer-events:none;
}
.aqv-overlay.open{opacity:1;pointer-events:all}
.aqv-box{
  background:var(--card);border:1px solid var(--border2);border-radius:18px;
  width:min(95vw,920px);max-height:90vh;display:flex;flex-direction:column;
  box-shadow:0 28px 80px rgba(0,0,0,.55);
  transform:translateY(28px) scale(.97);
  transition:transform .24s cubic-bezier(.34,1.4,.64,1);
  overflow:hidden;
}
.aqv-overlay.open .aqv-box{transform:translateY(0) scale(1)}

/* Header */
.aqv-header{
  padding:18px 20px 14px;border-bottom:1px solid var(--border);
  display:flex;align-items:flex-start;gap:14px;flex-shrink:0;
}
.aqv-header-accent{
  width:5px;align-self:stretch;border-radius:4px;flex-shrink:0;margin-top:2px;
}
.aqv-header-main{flex:1;min-width:0}
.aqv-app-name{font-size:18px;font-weight:800;color:var(--text);letter-spacing:-.3px;margin-bottom:4px}
.aqv-app-sub{font-size:12px;color:var(--dim);font-family:var(--mono);display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.aqv-app-sub span{display:flex;align-items:center;gap:4px}
.aqv-header-actions{display:flex;gap:8px;flex-shrink:0;align-items:flex-start}
.aqv-insight-btn{
  display:flex;align-items:center;gap:6px;padding:7px 14px;
  border-radius:8px;border:1px solid rgba(0,229,255,.3);
  background:rgba(0,229,255,.07);color:var(--accent);
  font-size:12px;font-weight:700;cursor:pointer;font-family:var(--font);
  transition:all .15s;white-space:nowrap;
}
.aqv-insight-btn:hover{background:rgba(0,229,255,.15);border-color:var(--accent)}
.aqv-close-btn{
  width:32px;height:32px;border-radius:8px;border:1px solid var(--border2);
  background:var(--card2);color:var(--dim);cursor:pointer;
  display:flex;align-items:center;justify-content:center;font-size:16px;
  transition:all .15s;flex-shrink:0;
}
.aqv-close-btn:hover{color:var(--red);border-color:var(--red);background:rgba(255,71,87,.08)}

/* Body */
.aqv-body{flex:1;overflow-y:auto;padding:18px 20px 20px;display:flex;flex-direction:column;gap:14px}

/* 3-column grid */
.aqv-grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}
@media(max-width:700px){.aqv-grid3{grid-template-columns:1fr}}

/* Zone cards */
.aqv-zone{
  background:var(--card2);border:1px solid var(--border);border-radius:12px;
  padding:14px 16px;
}
.aqv-zone-title{
  font-size:10px;font-weight:700;color:var(--muted);letter-spacing:.8px;
  text-transform:uppercase;margin-bottom:12px;font-family:var(--mono);
  display:flex;align-items:center;gap:6px;
}
.aqv-zone-title::after{content:'';flex:1;height:1px;background:var(--border)}

/* Row inside zone */
.aqv-row{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid var(--border)22}
.aqv-row:last-child{border-bottom:none;padding-bottom:0}
.aqv-row-key{font-size:11px;color:var(--dim);flex-shrink:0;padding-right:8px}
.aqv-row-val{font-size:12px;font-weight:600;color:var(--text);text-align:right;word-break:break-word}

/* Score bar row */
.aqv-score-row{padding:6px 0;border-bottom:1px solid var(--border)22}
.aqv-score-row:last-child{border-bottom:none}
.aqv-score-label{display:flex;justify-content:space-between;margin-bottom:4px}
.aqv-score-key{font-size:11px;color:var(--dim)}
.aqv-score-num{font-size:12px;font-weight:700;font-family:var(--mono)}

/* Tech stack chips */
.aqv-stack{display:flex;flex-wrap:wrap;gap:4px;margin-top:6px}
.aqv-chip{
  background:rgba(0,229,255,.08);color:var(--accent);
  border:1px solid rgba(0,229,255,.18);border-radius:5px;
  padding:2px 8px;font-size:10px;font-family:var(--mono);font-weight:600;
}

/* Zone D — EA breadcrumb */
.aqv-ea-path{
  display:flex;align-items:center;gap:6px;flex-wrap:wrap;
  padding:10px 12px;border-radius:9px;
  background:rgba(123,97,255,.07);border:1px solid rgba(123,97,255,.18);
}
.aqv-ea-seg{font-size:12px;font-weight:700;color:var(--accent2)}
.aqv-ea-sep{color:var(--muted);font-size:14px}
.aqv-ea-sub{font-size:11px;color:var(--dim);font-style:italic}

/* Zone E — Ownership */
.aqv-owners{display:flex;gap:14px;flex-wrap:wrap}
.aqv-owner-card{
  flex:1;min-width:180px;display:flex;align-items:center;gap:10px;
  background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:10px 14px;
}
.aqv-owner-avatar{
  width:34px;height:34px;border-radius:50%;display:flex;align-items:center;
  justify-content:center;font-size:15px;flex-shrink:0;
}
.aqv-owner-info .aqv-owner-role{font-size:10px;color:var(--dim);font-family:var(--mono);margin-bottom:2px}
.aqv-owner-info .aqv-owner-name{font-size:13px;font-weight:700;color:var(--text)}

/* ── FILTERS ─────────────────────────────────────────────── */
.filter-bar{display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap;align-items:center}
.search-input{
  flex:1;min-width:200px;background:var(--card2);border:1px solid var(--border);
  border-radius:8px;padding:9px 14px;color:var(--text);font-size:13px;font-family:var(--font);outline:none;
  transition:border-color .15s;
}
.search-input::placeholder{color:var(--muted)}
.search-input:focus{border-color:var(--border2)}
.filter-sel{
  background:var(--card2);border:1px solid var(--border);border-radius:8px;
  padding:9px 13px;color:var(--text);font-size:12px;font-family:var(--font);outline:none;cursor:pointer;
}
.filter-sel option{background:var(--card2)}

/* ── ROADMAP ─────────────────────────────────────────────── */
.rm-row{display:flex;align-items:center;margin-bottom:6px;gap:12px}
.rm-label{width:180px;flex-shrink:0}
.rm-label .name{font-size:12px;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.rm-label .domain{font-size:10px;color:var(--dim);font-family:var(--mono)}
.rm-track{flex:1;height:28px;background:var(--border);border-radius:4px;position:relative;overflow:hidden}
.rm-bar{position:absolute;top:3px;height:22px;border-radius:4px;display:flex;align-items:center;padding:0 8px;overflow:hidden;transition:opacity .15s;cursor:default}
.rm-bar:hover{opacity:.85;filter:brightness(1.1)}
.rm-bar-label{font-size:10px;font-weight:700;color:#fff;white-space:nowrap;font-family:var(--mono);text-shadow:0 1px 2px rgba(0,0,0,.4)}
.rm-headers{display:flex;margin-left:192px;margin-bottom:6px;position:relative}
.rm-qtr{flex:1;text-align:center;font-size:10px;font-weight:600;font-family:var(--mono);padding:4px 0;border-radius:4px;transition:background .2s}
.rm-qtr.current-qtr{color:var(--accent);background:rgba(0,229,255,.08);border:1px solid rgba(0,229,255,.2)}
.rm-qtr:not(.current-qtr){color:var(--muted)}
/* Today vertical line */
.rm-today-line{position:absolute;top:0;bottom:0;width:2px;background:rgba(0,229,255,.7);pointer-events:none;z-index:10}
.rm-today-line::before{content:'Today';position:absolute;top:-18px;left:50%;transform:translateX(-50%);font-size:9px;font-weight:700;color:var(--accent);font-family:var(--mono);white-space:nowrap;background:var(--card);padding:1px 5px;border-radius:3px}
/* Navigator */
.rm-nav{display:flex;align-items:center;gap:6px}
.rm-nav-btn{background:var(--card2);border:1px solid var(--border2);color:var(--text);border-radius:7px;padding:5px 12px;cursor:pointer;font-size:13px;font-weight:700;font-family:var(--font);transition:all .15s}
.rm-nav-btn:hover{border-color:var(--accent);color:var(--accent);background:rgba(0,229,255,.07)}
.rm-today-btn{font-size:11px;padding:5px 10px;color:var(--accent);border-color:rgba(0,229,255,.3)}
.rm-nav-label{font-size:12px;font-weight:700;color:var(--text);font-family:var(--mono);min-width:180px;text-align:center;background:var(--card2);border:1px solid var(--border2);border-radius:7px;padding:5px 12px}
/* Legend */
.rm-legend-item{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--dim)}
.rm-legend-item div{width:18px;height:8px;border-radius:3px;flex-shrink:0}
/* Out-of-range bar (partially visible) */
.rm-bar.clipped-left{border-top-left-radius:0;border-bottom-left-radius:0}
.rm-bar.clipped-right{border-top-right-radius:0;border-bottom-right-radius:0}
/* Empty state */
.rm-empty{text-align:center;padding:32px;color:var(--dim);font-size:13px}


/* ── BCG ─────────────────────────────────────────────────── */
.bcg-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;height:100%}
.bcg-quad{border-radius:10px;padding:14px;overflow:hidden}
.bcg-quad-title{font-size:12px;font-weight:700;margin-bottom:10px;font-family:var(--mono)}
.bcg-item{display:flex;align-items:center;justify-content:space-between;margin-bottom:5px;gap:8px}
.bcg-item-name{font-size:11px;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:130px}

/* ── CAPABILITY ──────────────────────────────────────────── */
#cap-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:14px}
.cap-card{background:var(--card);border-radius:var(--radius);padding:18px;border-left:3px solid}
.cap-score{font-size:24px;font-weight:800;letter-spacing:-1px}
.cap-tco{font-size:11px;color:var(--dim);font-family:var(--mono);margin-top:4px}

/* ── DONUT LEGEND ────────────────────────────────────────── */
.donut-legend{display:flex;flex-direction:column;gap:10px;justify-content:center}
.leg-item{display:flex;align-items:center;gap:8px;font-size:12px;color:var(--dim)}
.leg-dot{width:10px;height:10px;border-radius:3px;flex-shrink:0}

/* ── STANDARDS ───────────────────────────────────────────── */
.std-row{display:flex;align-items:center;gap:16px;margin-bottom:14px}
.std-name{width:140px;flex-shrink:0}
.std-name .n{font-size:13px;font-weight:700;color:var(--text)}
.std-name .d{font-size:11px;color:var(--dim)}
.std-bar-wrap{flex:1;background:var(--border);border-radius:8px;height:18px;overflow:hidden}
.std-bar-fill{height:100%;border-radius:8px;transition:width .6s ease}
.std-pct{width:50px;text-align:right;font-size:14px;font-weight:800;font-family:var(--mono)}
.std-count{width:70px;font-size:11px;color:var(--dim);font-family:var(--mono)}

/* ── EXEC DOMAIN ─────────────────────────────────────────── */
.domain-card{background:var(--card2);border-radius:10px;padding:16px;border-top:2px solid}
.domain-card .dc-name{font-size:13px;font-weight:700;color:var(--text);margin-bottom:8px}
.domain-card .dc-row{display:flex;justify-content:space-between;font-size:12px;color:var(--dim);margin-bottom:4px}
.domain-card .dc-row span{font-weight:600}

/* ── CHART ───────────────────────────────────────────────── */
.chart-wrap{position:relative;width:100%}

/* ── IT OPS SPECIFIC ─────────────────────────────────────── */
.ops-risk-card{
  background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:16px;
  border-left:4px solid;transition:all var(--transition);
}
.ops-matrix{display:grid;grid-template-columns:repeat(3,1fr);gap:2px;margin-top:12px}
.ops-matrix-cell{
  padding:8px;border-radius:4px;font-size:11px;text-align:center;
  font-family:var(--mono);font-weight:600;
}
.release-calendar{display:grid;grid-template-columns:repeat(12,1fr);gap:4px;margin-top:12px}
.cal-month{
  border-radius:6px;padding:8px 4px;text-align:center;font-size:10px;
  font-family:var(--mono);border:1px solid var(--border);
}
.cal-label{font-size:9px;color:var(--dim);margin-bottom:3px;font-family:var(--mono)}
.stack-pill{
  display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:20px;
  font-size:11px;font-weight:600;font-family:var(--mono);margin:2px;
}
.support-card{
  background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:14px;
}
.support-card .sc-app{font-size:13px;font-weight:700;color:var(--text);margin-bottom:6px}
.support-card .sc-row{display:flex;justify-content:space-between;font-size:11px;color:var(--dim);margin-bottom:3px}
.support-card .sc-row span{color:var(--text);font-weight:600;font-family:var(--mono)}

/* ── PPM SPECIFIC ────────────────────────────────────────── */
.wave-card{
  background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:16px;
  border-top:3px solid;
}
.wave-title{font-size:14px;font-weight:700;color:var(--text);margin-bottom:8px}
.wave-app{display:flex;align-items:center;gap:8px;padding:6px 0;border-bottom:1px solid rgba(128,128,128,.13)}
.wave-app:last-child{border-bottom:none}
.dep-chain{
  display:flex;align-items:center;gap:6px;padding:8px 12px;border-radius:8px;
  background:var(--card3);margin-bottom:6px;font-size:12px;
}
.dep-arrow{color:var(--muted);font-size:14px}
.assess-card{
  background:var(--card2);border-radius:10px;padding:14px;border:1px solid var(--border);
  position:relative;overflow:hidden;
}
.assess-status-bar{position:absolute;top:0;left:0;right:0;height:3px}
.progress-ring{
  width:50px;height:50px;flex-shrink:0;
}

/* ── MODAL ───────────────────────────────────────────────── */
.modal-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.65);z-index:500;
  display:flex;align-items:center;justify-content:center;animation:fadeIn .2s;
}
.modal{
  background:var(--card2);border:1px solid var(--border2);border-radius:16px;
  padding:30px;width:580px;max-height:85vh;overflow-y:auto;position:relative;
}
.modal-title{font-size:18px;font-weight:800;color:var(--text);margin-bottom:22px;
  display:flex;justify-content:space-between;align-items:center}
.modal-close{background:none;border:none;color:var(--dim);cursor:pointer;font-size:20px;
  padding:4px;line-height:1;transition:color .15s}
.modal-close:hover{color:var(--text)}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.form-field{display:flex;flex-direction:column;gap:5px}
.form-field.full{grid-column:span 2}
.form-label{font-size:11px;color:var(--dim);font-family:var(--mono);text-transform:uppercase;letter-spacing:.3px}
.form-input,.form-select{
  background:var(--card3);border:1px solid var(--border);border-radius:8px;
  padding:9px 12px;color:var(--text);font-size:13px;font-family:var(--font);outline:none;
  transition:border-color .15s;width:100%;
}
.form-input:focus,.form-select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,229,255,.1)}
.form-select option{background:var(--card2)}
.modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:22px}
.btn-cancel{
  padding:9px 20px;border-radius:8px;border:1px solid var(--border);background:none;
  color:var(--dim);cursor:pointer;font-size:13px;font-family:var(--font);transition:all .15s;
}
.btn-cancel:hover{color:var(--text);border-color:var(--border2)}
.btn-submit{
  padding:9px 24px;border-radius:8px;border:none;background:var(--accent);
  color:#000;cursor:pointer;font-size:13px;font-weight:800;font-family:var(--font);transition:all .15s;
}
.btn-submit:hover{opacity:.9;transform:translateY(-1px)}

/* ── APP INVENTORY ───────────────────────────────────────── */
.inv-toolbar{
  display:flex;align-items:center;gap:10px;margin-bottom:14px;flex-wrap:wrap;
}
.inv-search-wrap{
  position:relative;flex:1;min-width:220px;
}
.inv-search-icon{position:absolute;left:11px;top:50%;transform:translateY(-50%);font-size:13px;pointer-events:none}
.inv-search{
  width:100%;background:var(--card2);border:1px solid var(--border);
  border-radius:8px;padding:9px 14px 9px 34px;color:var(--text);
  font-size:13px;font-family:var(--font);outline:none;transition:border-color .15s;
}
.inv-search::placeholder{color:var(--muted)}
.inv-search:focus{border-color:var(--border2)}
.inv-show-decomm{
  display:flex;align-items:center;gap:6px;font-size:12px;color:var(--dim);
  cursor:pointer;white-space:nowrap;flex-shrink:0;
}
.inv-show-decomm input{cursor:pointer;accent-color:var(--accent)}

/* Inventory table extras */
.inv-tbl .row-decomm td{opacity:.45;text-decoration:none}
.inv-tbl .row-decomm .decomm-badge{opacity:1}
.inv-tbl .row-decomm{background:repeating-linear-gradient(
  -45deg,transparent,transparent 4px,rgba(255,71,87,.03) 4px,rgba(255,71,87,.03) 8px)}

/* Action buttons */
.act-btn{
  display:inline-flex;align-items:center;justify-content:center;
  width:30px;height:30px;border-radius:7px;border:1px solid var(--border);
  background:var(--card2);cursor:pointer;font-size:14px;transition:all .15s;
  color:var(--dim);
}
.act-btn:hover.edit-btn{border-color:var(--accent);background:rgba(0,229,255,.1);color:var(--accent)}
.act-btn:hover.decomm-btn{border-color:var(--red);background:rgba(255,71,87,.1);color:var(--red)}
.act-btn:disabled{opacity:.3;cursor:not-allowed;pointer-events:none}
.act-btn-row{display:flex;gap:5px;justify-content:center}

/* Decomm badge */
.decomm-badge-wrap{display:flex;align-items:center}
.decomm-strip{
  display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:5px;
  background:rgba(255,71,87,.12);border:1px solid rgba(255,71,87,.3);
  font-size:10px;font-weight:700;color:var(--red);font-family:var(--mono);
}

/* Decommission body */
.decomm-info-card{
  background:var(--card3);border:1px solid var(--border2);border-radius:10px;
  padding:16px;margin-bottom:16px;border-left:4px solid var(--red);
}
.decomm-info-card .di-name{font-size:16px;font-weight:800;color:var(--text);margin-bottom:4px}
.decomm-info-card .di-meta{font-size:12px;color:var(--dim);display:flex;gap:12px;flex-wrap:wrap}
.decomm-warning{
  background:rgba(255,160,0,.08);border:1px solid rgba(255,160,0,.3);
  border-radius:8px;padding:12px 14px;font-size:12px;color:var(--yellow);
  margin-bottom:14px;line-height:1.6;
}
.decomm-date-field{display:flex;flex-direction:column;gap:5px;margin-top:8px}

/* ── EA LANDSCAPE ─────────────────────────────────────────── */
/* ── MPX BLUEPRINT ─────────────────────────────────────── */
.bp-wrap{padding:8px 0;overflow-x:auto}
.bp-canvas{
  min-width:900px;display:grid;position:relative;
  font-family:var(--font);
}
.bp-side{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  writing-mode:vertical-rl;text-orientation:mixed;
  font-size:11px;font-weight:700;letter-spacing:.5px;
  border-radius:8px;padding:10px 6px;cursor:default;
  transition:filter .2s;
  min-width:38px;width:100%;box-sizing:border-box;
}
.bp-side:hover{filter:brightness(1.15)}
.bp-cat{
  display:flex;align-items:center;justify-content:space-between;
  padding:0 14px;min-height:46px;cursor:pointer;
  border-bottom:1px solid rgba(255,255,255,.08);
  transition:filter .18s, transform .12s;
  position:relative;gap:10px;
}
.bp-cat:last-child{border-bottom:none}
.bp-cat:hover{filter:brightness(1.12);transform:translateX(2px)}
.bp-cat-label{font-size:12px;font-weight:600;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1}
.bp-cat-right{display:flex;align-items:center;gap:8px;flex-shrink:0}
.bp-badge{display:flex;align-items:center;justify-content:center;min-width:26px;height:22px;border-radius:6px;font-size:11px;font-weight:800;font-family:var(--mono);padding:0 6px}
.bp-hbar{height:4px;border-radius:2px;background:var(--border);width:52px;overflow:hidden;flex-shrink:0}
.bp-hbar-fill{height:100%;border-radius:2px;transition:width .4s}
.bp-bottom{display:flex;align-items:center;justify-content:space-between;padding:0 16px;min-height:44px;cursor:pointer;border-radius:8px;font-size:12px;font-weight:700;color:var(--text);border:2px solid;margin-top:4px;transition:filter .18s}
.bp-bottom:hover{filter:brightness(1.12)}
.bp-tooltip{position:fixed;z-index:9200;background:var(--card);border:1px solid var(--border2);border-radius:12px;padding:12px 14px;box-shadow:0 12px 40px rgba(0,0,0,.5);min-width:220px;max-width:300px;pointer-events:none;opacity:0;transition:opacity .15s}
.bp-tooltip.visible{opacity:1}
.bp-tooltip-title{font-size:12px;font-weight:800;color:var(--text);margin-bottom:8px;padding-bottom:6px;border-bottom:1px solid var(--border)}
.bp-tooltip-app{display:flex;align-items:center;justify-content:space-between;padding:4px 0;border-bottom:1px solid rgba(128,128,128,.1);gap:8px}
.bp-tooltip-app:last-child{border-bottom:none}
.bp-tooltip-name{font-size:11px;color:var(--text);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.bp-tooltip-score{font-size:11px;font-weight:700;font-family:var(--mono);flex-shrink:0}
.bp-tooltip-more{font-size:10px;color:var(--dim);margin-top:6px;text-align:center;font-style:italic}
.bp-legend{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:14px;align-items:center}
.bp-legend-item{display:flex;align-items:center;gap:5px;font-size:11px;color:var(--dim)}
.bp-legend-dot{width:10px;height:10px;border-radius:3px;flex-shrink:0}
[data-theme="light"] .bp-cat{border-bottom-color:rgba(0,0,0,.07)}
[data-theme="light"] .bp-tooltip-app{border-bottom-color:rgba(0,0,0,.07)}

.ea-toolbar{display:flex;align-items:center;gap:10px;margin-bottom:16px;flex-wrap:wrap}
.ea-view-toggle{display:flex;gap:2px;background:var(--card3);border:1px solid var(--border2);border-radius:8px;padding:3px}
.ea-vbtn{padding:5px 9px;border-radius:5px;border:none;background:none;color:var(--dim);cursor:pointer;font-size:14px;transition:all .15s;line-height:1}
.ea-vbtn:hover{color:var(--text)}
.ea-vbtn.active{background:var(--accent);color:#000}
[data-theme="light"] .ea-vbtn.active{color:#fff}

/* Landscape grid */
.ea-landscape-grid{display:flex;flex-direction:column;gap:16px}

/* EA Group block */
.ea-group-block{border:1px solid var(--border);border-radius:14px;overflow:hidden}
.ea-group-header{
  padding:12px 18px;display:flex;align-items:center;gap:12px;
  border-bottom:1px solid var(--border);
}
.ea-group-num{
  width:34px;height:34px;border-radius:10px;
  display:flex;align-items:center;justify-content:center;
  font-size:14px;font-weight:800;flex-shrink:0;color:#000;
}
.ea-group-name{font-size:15px;font-weight:800;color:var(--text);letter-spacing:-.2px}
.ea-group-meta{margin-left:auto;font-size:11px;color:var(--dim);font-family:var(--mono)}

/* EA Category rows */
.ea-cats-wrap{padding:12px 14px;display:flex;flex-direction:column;gap:10px;background:var(--bg2)}

.ea-cat-row{display:flex;align-items:flex-start;gap:12px}
.ea-cat-label{
  min-width:220px;max-width:220px;padding:8px 12px;border-radius:8px;
  background:var(--card);border:1px solid var(--border);
  font-size:12px;font-weight:700;color:var(--text);flex-shrink:0;
  display:flex;flex-direction:column;gap:3px;
}
.ea-cat-num{font-size:10px;font-family:var(--mono);color:var(--accent);font-weight:600}
.ea-cat-title{line-height:1.3}
.ea-cat-count{font-size:10px;color:var(--muted);font-family:var(--mono);margin-top:2px}

.ea-apps-row{
  flex:1;display:flex;flex-wrap:wrap;gap:7px;align-content:flex-start;
  min-height:40px;padding:4px 0;
}
.ea-app-chip{
  display:inline-flex;align-items:center;gap:6px;
  padding:5px 10px;border-radius:8px;border:1px solid var(--border);
  background:var(--card);cursor:pointer;transition:all .15s;
  font-size:11px;font-weight:600;color:var(--text);
  max-width:200px;
}
.ea-app-chip:hover{border-color:var(--accent);background:var(--card2);transform:translateY(-2px);box-shadow:var(--shadow);color:var(--accent)}
.ea-app-chip .chip-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
.ea-app-chip .chip-name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.ea-app-chip .chip-health{font-family:var(--mono);font-size:10px;opacity:.7;flex-shrink:0}
.ea-empty-row{font-size:11px;color:var(--muted);font-family:var(--mono);padding:8px 4px;font-style:italic}

/* EA sub-category (future) */
.ea-subcat-tag{
  font-size:9px;background:rgba(0,229,255,.07);color:var(--accent);
  border:1px solid rgba(0,229,255,.15);border-radius:3px;padding:1px 5px;
  font-family:var(--mono);
}

/* EA list view */
.ea-list-tbl thead th{background:var(--card)}

/* ── SETTINGS: IMPORT / EXPORT ───────────────────────────── */
.ie-page{display:flex;flex-direction:column;gap:20px;max-width:820px}
.ie-section{background:var(--card);border:1px solid var(--border);border-radius:14px;overflow:hidden}
.ie-section-header{
  padding:18px 22px 14px;border-bottom:1px solid var(--border);
  display:flex;align-items:center;gap:12px;
}
.ie-section-icon{font-size:22px;width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center}
.ie-section-title{font-size:15px;font-weight:800;color:var(--text)}
.ie-section-desc{font-size:12px;color:var(--dim);margin-top:2px}
.ie-section-body{padding:20px 22px;display:flex;flex-direction:column;gap:14px}

/* Action cards */
.ie-action{
  display:flex;align-items:center;gap:16px;padding:16px 18px;
  background:var(--card2);border:1px solid var(--border2);border-radius:10px;
}
.ie-action-info{flex:1}
.ie-action-title{font-size:13px;font-weight:700;color:var(--text);margin-bottom:3px}
.ie-action-desc{font-size:12px;color:var(--dim);line-height:1.5}
.ie-btn{
  flex-shrink:0;padding:9px 20px;border-radius:8px;border:none;cursor:pointer;
  font-size:13px;font-weight:700;font-family:var(--font);transition:all .15s;
  display:flex;align-items:center;gap:7px;white-space:nowrap;
}
.ie-btn-primary{background:var(--accent);color:#000}
.ie-btn-primary:hover{filter:brightness(1.12)}
.ie-btn-danger{background:rgba(255,71,87,.15);color:var(--red);border:1px solid rgba(255,71,87,.3)}
.ie-btn-danger:hover{background:rgba(255,71,87,.25)}
.ie-btn-success{background:rgba(0,214,143,.15);color:var(--green);border:1px solid rgba(0,214,143,.3)}
.ie-btn-success:hover{background:rgba(0,214,143,.25)}
.ie-btn:disabled{opacity:.5;cursor:not-allowed;filter:none}

/* Drop zone */
.ie-dropzone{
  border:2px dashed var(--border2);border-radius:10px;padding:32px;
  text-align:center;cursor:pointer;transition:all .2s;background:var(--card2);
}
.ie-dropzone:hover,.ie-dropzone.drag-over{
  border-color:var(--accent);background:rgba(0,229,255,.05);
}
.ie-dropzone-icon{font-size:36px;margin-bottom:10px}
.ie-dropzone-title{font-size:14px;font-weight:700;color:var(--text);margin-bottom:4px}
.ie-dropzone-sub{font-size:12px;color:var(--dim)}
.ie-dropzone input[type=file]{display:none}

/* Progress / status */
.ie-status{
  padding:12px 16px;border-radius:8px;font-size:13px;font-weight:600;
  display:flex;align-items:center;gap:10px;margin-top:4px;
}
.ie-status.info{background:rgba(0,229,255,.08);color:var(--accent);border:1px solid rgba(0,229,255,.2)}
.ie-status.success{background:rgba(0,214,143,.08);color:var(--green);border:1px solid rgba(0,214,143,.2)}
.ie-status.error{background:rgba(255,71,87,.08);color:var(--red);border:1px solid rgba(255,71,87,.2)}
.ie-status.warn{background:rgba(255,159,67,.08);color:var(--yellow);border:1px solid rgba(255,159,67,.2)}

/* Preview table */
.ie-preview{margin-top:8px}
.ie-preview-title{font-size:12px;color:var(--dim);font-weight:700;margin-bottom:8px}
.ie-preview-scroll{overflow-x:auto;border-radius:8px;border:1px solid var(--border2)}
.ie-preview-tbl{width:100%;border-collapse:collapse;font-size:11px}
.ie-preview-tbl th{
  background:var(--card3);color:var(--dim);font-weight:700;text-align:left;
  padding:7px 10px;border-bottom:1px solid var(--border2);white-space:nowrap;
}
.ie-preview-tbl td{
  padding:6px 10px;border-bottom:1px solid var(--border);color:var(--text);
  white-space:nowrap;
}
.ie-preview-tbl tr:last-child td{border-bottom:none}
.ie-preview-tbl tr:hover td{background:var(--card2)}

/* ── PAPER OUT BUTTON ────────────────────────────────────── */
.paper-out-btn{
  margin-left:auto;display:flex;align-items:center;gap:8px;
  padding:9px 18px;border-radius:10px;border:none;cursor:pointer;
  background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%);
  color:#e8e8e8;font-size:13px;font-weight:700;font-family:var(--font);
  border:1px solid rgba(255,255,255,.12);
  box-shadow:0 2px 12px rgba(0,0,0,.3);
  transition:all .2s ease;white-space:nowrap;
}
.paper-out-btn:hover{
  background:linear-gradient(135deg,#0f3460 0%,#16213e 100%);
  border-color:rgba(0,229,255,.4);color:#fff;
  box-shadow:0 4px 20px rgba(0,229,255,.2);transform:translateY(-1px);
}
.paper-out-btn:active{transform:translateY(0);box-shadow:0 2px 8px rgba(0,0,0,.3)}
.paper-out-btn.loading{opacity:.7;cursor:wait;pointer-events:none}
.paper-out-icon{font-size:15px;line-height:1}
.paper-out-label{letter-spacing:.3px}

/* ── PRINT / PDF STYLES ──────────────────────────────────── */
@media print{
  *{-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important}
  #sidebar,#topbar,.paper-out-btn,.insight-selector-bar,
  #api-loading,.api-toast,#modal-edit,#modal,
  .sb-bottom,.topbar-right,#content-area > *:not(#main){
    display:none!important;
  }
  body,html{background:#fff!important;margin:0;padding:0}
  #app-shell{display:block!important}
  #content-area{margin:0!important;padding:0!important}
  #main{padding:0!important}
  .view{display:block!important;padding:0!important}
  .view:not(#view-app-insight){display:none!important}
  #view-app-insight{display:block!important}
  #insight-content{padding:0!important}
  .insight-report{gap:10px}
  .insight-card,.insight-analysis,.insight-header{
    break-inside:avoid;page-break-inside:avoid;
    border:1px solid #ddd!important;
    background:#fff!important;color:#111!important;
  }
  .insight-grid-3,.insight-grid-2{break-inside:avoid}
  .insight-finding{break-inside:avoid;border:1px solid #ddd!important}
  .insight-gauge-track{background:#eee!important}
  .insight-row{border-bottom:1px solid #eee!important}
  .insight-row-key,.insight-finding-desc{color:#555!important}
  .insight-app-name,.insight-section-title,.insight-card-title{color:#111!important}
  .insight-score-big{-webkit-print-color-adjust:exact}
}

/* ── APP INSIGHT ──────────────────────────────────────────── */
.insight-selector-bar{
  display:flex;align-items:center;gap:12px;margin-bottom:20px;flex-wrap:wrap;
}
.insight-sel-wrap{
  position:relative;flex:1;min-width:260px;max-width:520px;
  display:flex;align-items:center;
}
.insight-sel-icon{
  position:absolute;left:14px;font-size:15px;pointer-events:none;z-index:1;
}
.insight-select{
  width:100%;padding:11px 16px 11px 40px;
  background:var(--card);border:1px solid var(--border2);border-radius:10px;
  color:var(--text);font-size:13px;font-weight:600;font-family:var(--font);
  cursor:pointer;appearance:none;transition:border-color .15s,box-shadow .15s;
}
.insight-select:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,229,255,.12)}
.insight-app-badge{
  display:inline-flex;align-items:center;gap:8px;
  padding:6px 14px;border-radius:8px;font-size:12px;font-weight:700;
}

/* Empty state */
.insight-empty{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  height:50vh;gap:12px;color:var(--dim);text-align:center;
}
.insight-empty-icon{font-size:56px;opacity:.4}
.insight-empty-title{font-size:18px;font-weight:700;color:var(--text);opacity:.6}
.insight-empty-sub{font-size:13px;max-width:400px;line-height:1.6}

/* Report layout */
.insight-report{display:flex;flex-direction:column;gap:16px}

/* Header card */
.insight-header{
  background:var(--card);border:1px solid var(--border);border-radius:14px;
  padding:20px 24px;display:flex;align-items:flex-start;gap:20px;flex-wrap:wrap;
}
.insight-header-icon{
  width:56px;height:56px;border-radius:14px;flex-shrink:0;
  display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:900;
}
.insight-header-main{flex:1;min-width:200px}
.insight-app-name{font-size:22px;font-weight:900;color:var(--text);line-height:1.2;margin-bottom:4px}
.insight-app-id{font-size:12px;color:var(--dim);font-family:var(--mono);margin-bottom:10px}
.insight-badges{display:flex;flex-wrap:wrap;gap:6px;align-items:center}
.insight-header-right{display:flex;flex-direction:column;align-items:flex-end;gap:8px}
.insight-score-big{
  font-size:42px;font-weight:900;line-height:1;font-family:var(--mono);
}
.insight-score-label{font-size:11px;color:var(--dim);font-family:var(--mono);text-align:right}

/* Section grid */
.insight-grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.insight-grid-2{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
@media(max-width:900px){.insight-grid-3{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.insight-grid-3,.insight-grid-2{grid-template-columns:1fr}}

/* Info cards */
.insight-card{
  background:var(--card);border:1px solid var(--border);border-radius:12px;
  padding:18px 20px;
}
.insight-card-title{
  font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.8px;
  color:var(--dim);margin-bottom:14px;display:flex;align-items:center;gap:6px;
}
.insight-row{
  display:flex;justify-content:space-between;align-items:center;
  padding:7px 0;border-bottom:1px solid var(--border);font-size:13px;gap:8px;
}
.insight-row:last-child{border-bottom:none;padding-bottom:0}
.insight-row-key{color:var(--dim);flex-shrink:0;font-size:12px}
.insight-row-val{font-weight:600;color:var(--text);text-align:right;word-break:break-word}

/* Gauge bars */
.insight-gauge-wrap{margin-bottom:10px}
.insight-gauge-label{
  display:flex;justify-content:space-between;font-size:12px;margin-bottom:5px;
}
.insight-gauge-label span:first-child{color:var(--dim)}
.insight-gauge-label span:last-child{font-weight:700;font-family:var(--mono)}
.insight-gauge-track{
  height:8px;background:var(--card3);border-radius:4px;overflow:hidden;
}
.insight-gauge-fill{height:100%;border-radius:4px;transition:width .6s ease}

/* Analysis card */
.insight-analysis{
  background:var(--card);border:1px solid var(--border);border-radius:12px;padding:18px 20px;
}
.insight-analysis-title{
  font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.8px;
  color:var(--dim);margin-bottom:14px;display:flex;align-items:center;gap:6px;
}
.insight-finding{
  display:flex;align-items:flex-start;gap:12px;padding:12px 14px;
  border-radius:10px;margin-bottom:8px;border:1px solid transparent;font-size:13px;line-height:1.6;
}
.insight-finding:last-child{margin-bottom:0}
.insight-finding.risk{background:rgba(255,71,87,.07);border-color:rgba(255,71,87,.2)}
.insight-finding.warn{background:rgba(255,159,67,.07);border-color:rgba(255,159,67,.2)}
.insight-finding.good{background:rgba(0,214,143,.07);border-color:rgba(0,214,143,.2)}
.insight-finding.info{background:rgba(0,229,255,.07);border-color:rgba(0,229,255,.15)}
.insight-finding-icon{font-size:16px;flex-shrink:0;margin-top:1px}
.insight-finding-body{flex:1}
.insight-finding-title{font-weight:700;margin-bottom:2px}
.insight-finding.risk .insight-finding-title{color:var(--red)}
.insight-finding.warn .insight-finding-title{color:var(--yellow)}
.insight-finding.good .insight-finding-title{color:var(--green)}
.insight-finding.info .insight-finding-title{color:var(--accent)}
.insight-finding-desc{color:var(--dim);font-size:12px}

/* Radar / score ring */
.insight-score-ring{
  display:flex;flex-direction:column;align-items:center;gap:4px;margin:8px 0;
}
.insight-ring-svg{overflow:visible}

/* Stack tags */
.insight-stack-wrap{display:flex;flex-wrap:wrap;gap:6px;margin-top:4px}
.insight-stack-tag{
  padding:4px 10px;border-radius:6px;font-size:11px;font-weight:600;
  background:rgba(0,229,255,.08);color:var(--accent);border:1px solid rgba(0,229,255,.2);
  font-family:var(--mono);
}

/* Decomm banner */
.insight-decomm-banner{
  background:rgba(255,71,87,.08);border:1px solid rgba(255,71,87,.3);
  border-radius:12px;padding:14px 18px;display:flex;align-items:center;gap:12px;
  font-size:13px;color:var(--red);font-weight:600;
}

/* ── EDIT MODAL TABS ─────────────────────────────────────── */
.edit-tabs{
  display:flex;gap:2px;border-bottom:1px solid var(--border);
  margin-bottom:18px;padding-bottom:0;
}
.edit-tab{
  padding:8px 16px;border:none;background:none;
  color:var(--dim);cursor:pointer;font-size:12px;font-weight:600;
  font-family:var(--font);border-bottom:2px solid transparent;
  margin-bottom:-1px;transition:all .15s;border-radius:6px 6px 0 0;
}
.edit-tab:hover{color:var(--text);background:var(--card3)}
.edit-tab.active{color:var(--accent);border-bottom-color:var(--accent);background:rgba(0,229,255,.05)}
[data-theme="light"] .edit-tab.active{color:var(--accent);border-bottom-color:var(--accent);background:rgba(0,102,204,.05)}

.edit-tab-panel{display:none}
.edit-tab-panel.active{display:block}

/* EA edit hint */
.ea-edit-hint{
  display:flex;align-items:center;gap:10px;
  padding:10px 14px;border-radius:8px;margin-bottom:16px;
  background:rgba(123,97,255,.08);border:1px solid rgba(123,97,255,.2);
  font-size:12px;color:var(--dim);
}

/* EA preview */
.ea-preview-wrap{
  display:flex;align-items:center;gap:10px;flex-wrap:wrap;
  padding:12px 14px;background:var(--card3);border-radius:10px;
  border:1px solid var(--border2);
}
.ea-preview-group{
  padding:5px 12px;border-radius:6px;font-size:12px;font-weight:700;
  background:rgba(123,97,255,.15);color:var(--accent2);border:1px solid rgba(123,97,255,.3);
}
.ea-preview-cat{
  padding:5px 12px;border-radius:6px;font-size:12px;font-weight:600;
  background:rgba(0,229,255,.1);color:var(--accent);border:1px solid rgba(0,229,255,.2);
}
.ea-preview-sub{
  padding:5px 12px;border-radius:6px;font-size:12px;color:var(--dim);
  background:var(--card2);border:1px solid var(--border);font-family:var(--mono);
}

@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(255,71,87,.3)}50%{box-shadow:0 0 0 5px rgba(255,71,87,.0)}}
.risk-critical{animation:pulse 2s infinite}

/* ── API TOAST & LOADING ──────────────────────────────────── */
.api-toast{position:fixed;bottom:24px;right:24px;z-index:9999;padding:12px 20px;border-radius:10px;font-size:13px;font-weight:600;background:var(--card);border:1px solid var(--border2);box-shadow:0 8px 32px rgba(0,0,0,.4);color:var(--text);transform:translateY(80px);opacity:0;transition:all .3s cubic-bezier(.34,1.56,.64,1);max-width:360px;}
.api-toast.show{transform:translateY(0);opacity:1}
.api-toast.api-toast-success{border-color:var(--green);color:var(--green)}
.api-toast.api-toast-error{border-color:var(--red);color:var(--red)}
#api-loading{position:fixed;inset:0;z-index:9998;background:rgba(0,0,0,.5);backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;flex-direction:column;gap:14px;color:var(--text);font-size:13px;}
.api-spin{width:36px;height:36px;border-radius:50%;border:3px solid var(--border2);border-top-color:var(--accent);animation:spin .7s linear infinite;}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
<script id="appport-config" type="application/json">{"version":"V001","app_name":"MPX Studio","subtitle":"EA PORTFOLIO","organization":"MPX","description":"Enterprise Application Portfolio Management","mpx2":{"badges":[{"grp":"2. Services","cat":"Customer","l":0.0,"t":0.0,"w":3.0,"h":29.1},{"grp":"2. Services","cat":"Partner","l":0.0,"t":29.1,"w":3.0,"h":25.3},{"grp":"2. Services","cat":"Service","l":0.0,"t":54.4,"w":3.0,"h":23.7},{"grp":"2. Services","cat":"Employee","l":0.0,"t":78.1,"w":3.0,"h":17.6},{"grp":"2. Services","cat":"Channel","l":3.2,"t":0.0,"w":3.8,"h":52.8},{"grp":"2. Services","cat":"Portal & Gateway","l":3.2,"t":52.8,"w":3.8,"h":42.9},{"grp":"1. Direction","cat":"BOD","l":27.2,"t":0.6,"w":40.3,"h":5.5},{"grp":"1. Direction","cat":"Vision, Mission, Strategies","l":27.2,"t":6.4,"w":40.3,"h":5.5},{"grp":"1. Direction","cat":"Goals, Objectives","l":27.2,"t":12.3,"w":40.3,"h":6.1},{"grp":"1. Direction","cat":"Governance Body","l":27.2,"t":18.7,"w":40.3,"h":5.5},{"grp":"1. Direction","cat":"Standard & Policies","l":27.2,"t":24.5,"w":40.3,"h":5.5},{"grp":"1. Direction","cat":"Business Process & Services","l":27.2,"t":30.3,"w":40.3,"h":6.1},{"grp":"3. Core Products","cat":"Organization","l":17.3,"t":37.7,"w":50.4,"h":6.4},{"grp":"3. Core Products","cat":"Corporate & Core System","l":17.3,"t":44.4,"w":50.4,"h":8.0},{"grp":"3. Core Products","cat":"Back Office & Support System","l":17.3,"t":52.7,"w":50.4,"h":7.0},{"grp":"4. Support","cat":"Training & Communication","l":17.3,"t":60.0,"w":50.4,"h":7.0},{"grp":"4. Support","cat":"Corporate Information","l":17.3,"t":67.4,"w":50.4,"h":7.0},{"grp":"4. Support","cat":"Corporate Application & Information Technology","l":7.3,"t":76.0,"w":63.4,"h":6.4},{"grp":"","cat":"Enterprise Information Technology","l":0.0,"t":88.8,"w":100.0,"h":7.4},{"grp":"5. Governance","cat":"Corporate Security & Policy","l":76.5,"t":0.0,"w":3.8,"h":88.8},{"grp":"5. Governance","cat":"Risk & Internal Control","l":80.6,"t":0.0,"w":5.0,"h":88.8},{"grp":"5. Governance","cat":"Law & Compliance","l":85.8,"t":0.0,"w":4.0,"h":88.8}]}}</script>
</head>
<body>

<!-- TOP BAR -->
<header id="topbar">
  <button id="sidebar-toggle" title="Toggle sidebar">☰</button>
  <div class="logo">
    <div>
      <div class="logo-title">MPX Studio</div>
      <div class="logo-sub" id="app-version-sub"></div>
    </div>
  </div>
  <div id="topbar-breadcrumb">
    <span>Portfolio</span><span class="bc-sep">/</span><span class="bc-current" id="bc-current">Dashboard</span>
  </div>
  <div class="topbar-right">
    <div class="theme-toggle">
      <button class="theme-btn active" id="theme-auto" title="Auto (System)">🌓</button>
      <button class="theme-btn" id="theme-dark" title="Dark Mode">🌙</button>
      <button class="theme-btn" id="theme-light" title="Light Mode">☀️</button>
    </div>
    <button class="btn-add" id="btn-add-app">+ Add App</button>
  </div>
</header>

<div id="app-shell">

<!-- SIDEBAR -->
<nav id="sidebar">

  <!-- OVERVIEW group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Overview</span><div class="sl-line"></div></div>
    <button class="sb-item active" data-view="dashboard" data-group="Overview" data-label="Dashboard" data-tooltip="Dashboard" data-desc="หน้าหลัก แสดงสรุปภาพรวม KPI และสถานะของแอปพลิเคชันทั้งหมด">
      <span class="si-icon">⬡</span><span class="si-label">Dashboard</span>
    </button>
    <button class="sb-item" data-view="portfolio" data-group="Overview" data-label="Application Portfolio" data-tooltip="Application Portfolio" data-desc="แสดง Portfolio ของแอปพลิเคชันในรูปแบบ Card พร้อมสถานะและข้อมูลสำคัญ">
      <span class="si-icon">▣</span><span class="si-label">Application Portfolio</span>
    </button>
    <button class="sb-item" data-view="inventory" data-group="Overview" data-label="App Inventory" data-tooltip="App Inventory" data-desc="ตารางรายการแอปพลิเคชันทุกตัวพร้อมรายละเอียดครบถ้วน ค้นหาและกรองข้อมูลได้">
      <span class="si-icon">📋</span><span class="si-label">App Inventory</span>
    </button>
    <button class="sb-item" data-view="app-insight" data-group="Overview" data-label="App Insight" data-tooltip="App Insight" data-desc="วิเคราะห์เชิงลึกของแอปพลิเคชันแต่ละตัว ดูข้อมูล Health Score และ Metrics">
      <span class="si-icon">🔬</span><span class="si-label">App Insight</span>
    </button>
  </div>

  <div class="sb-divider"></div>

  <!-- ARCHITECTURE group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Architecture</span><div class="sl-line"></div></div>
    <button class="sb-item" data-view="techdebt" data-group="Architecture" data-label="Tech Debt" data-tooltip="Tech Debt" data-desc="แสดงหนี้ทางเทคนิค ระบุระบบเก่า/ล้าสมัยที่ต้องได้รับการปรับปรุงหรือทดแทน">
      <span class="si-icon">⚠</span><span class="si-label">Tech Debt</span>
    </button>
    <button class="sb-item" data-view="capability" data-group="Architecture" data-label="Capability Map" data-tooltip="Capability Map" data-desc="แผนที่ความสามารถทางธุรกิจขององค์กร เชื่อมโยงระบบกับ Business Capability">
      <span class="si-icon">⊞</span><span class="si-label">Capability Map</span>
    </button>
    <button class="sb-item" data-view="standards" data-group="Architecture" data-label="Standards" data-tooltip="Standards" data-desc="มาตรฐานด้านเทคโนโลยีที่องค์กรกำหนด ตรวจสอบความสอดคล้องของแต่ละระบบ">
      <span class="si-icon">✓</span><span class="si-label">Standards</span>
    </button>
    <button class="sb-item" data-view="mpx2" data-group="Architecture" data-label="MPX EA Blueprint" data-tooltip="MPX EA Blueprint" data-desc="แผนผัง Enterprise Architecture ของ MPX แสดง Layer ทั้งหมดตั้งแต่ BOD ถึง IT">
      <span class="si-icon">🗺</span><span class="si-label">MPX EA Blueprint</span>
    </button>
    <button class="sb-item" data-view="ea-landscape" data-group="Architecture" data-label="EA Landscape" data-tooltip="EA Landscape" data-desc="ภาพรวม Landscape ของ Enterprise Architecture แสดงความสัมพันธ์ระหว่างระบบ">
      <span class="si-icon">🏛</span><span class="si-label">EA Landscape</span>
    </button>
  </div>

  <div class="sb-divider"></div>

  <!-- PLANNING group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Planning</span><div class="sl-line"></div></div>
    <button class="sb-item" data-view="roadmap" data-group="Planning" data-label="Roadmap" data-tooltip="Roadmap" data-desc="แผนการพัฒนาและปรับปรุงระบบในอนาคต แสดง Timeline และ Milestone สำคัญ">
      <span class="si-icon">→</span><span class="si-label">Roadmap</span>
    </button>
    <button class="sb-item" data-view="lifecycle" data-group="Planning" data-label="Lifecycle" data-tooltip="Lifecycle" data-desc="วงจรชีวิตของแอปพลิเคชัน ตั้งแต่เริ่มใช้งานจนถึงเลิกใช้ (EOL)">
      <span class="si-icon">◷</span><span class="si-label">Lifecycle</span>
    </button>
  </div>

  <div class="sb-divider"></div>

  <!-- PROJECT PORTFOLIO group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Project Portfolio</span><div class="sl-line"></div></div>
    <button class="sb-item" data-view="ppm-wave" data-group="Project Portfolio" data-label="Wave Planning" data-tooltip="Wave Planning" data-desc="วางแผนโครงการเป็น Wave ตามลำดับความสำคัญและความพร้อมขององค์กร">
      <span class="si-icon">🌊</span><span class="si-label">Wave Planning</span>
    </button>
    <button class="sb-item" data-view="ppm-dependency" data-group="Project Portfolio" data-label="Dependency Map" data-tooltip="Dependency Map" data-desc="แผนผังแสดงความสัมพันธ์และการพึ่งพากันระหว่างโครงการต่างๆ">
      <span class="si-icon">🔗</span><span class="si-label">Dependency Map</span>
    </button>
    <button class="sb-item" data-view="ppm-resource" data-group="Project Portfolio" data-label="Resource & Complexity" data-tooltip="Resource & Complexity" data-desc="วิเคราะห์ทรัพยากรที่ต้องใช้และระดับความซับซ้อนของแต่ละโครงการ">
      <span class="si-icon">👥</span><span class="si-label">Resource &amp; Complexity</span>
    </button>
    <button class="sb-item" data-view="ppm-assessment" data-group="Project Portfolio" data-label="Assessment Tracking" data-tooltip="Assessment Tracking" data-desc="ติดตามผลการประเมินและความคืบหน้าของโครงการในพอร์ตโฟลิโอ">
      <span class="si-icon">📝</span><span class="si-label">Assessment Tracking</span>
    </button>
  </div>

  <div class="sb-divider"></div>

  <!-- BUSINESS group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Business Analytics</span><div class="sl-line"></div></div>
    <button class="sb-item" data-view="financial" data-group="Business Analytics" data-label="Financial Analytics" data-tooltip="Financial Analytics" data-desc="วิเคราะห์ค่าใช้จ่าย งบประมาณ และ ROI ของระบบ IT ในองค์กร">
      <span class="si-icon">฿</span><span class="si-label">Financial Analytics</span>
    </button>
    <button class="sb-item" data-view="executive" data-group="Business Analytics" data-label="Executive View" data-tooltip="Executive View" data-desc="มุมมองสรุปสำหรับผู้บริหาร แสดงข้อมูลสำคัญในระดับ C-Level ที่เข้าใจง่าย">
      <span class="si-icon">★</span><span class="si-label">Executive View</span>
    </button>
  </div>

  <div class="sb-divider"></div>

  <!-- IT OPERATIONS group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Technical Analytics</span><div class="sl-line"></div></div>
    <button class="sb-item" data-view="ops-risk" data-group="Technical Analytics" data-label="Operational Risk" data-tooltip="Operational Risk" data-desc="ประเมินและติดตามความเสี่ยงด้านการดำเนินงานของระบบ IT ในองค์กร">
      <span class="si-icon">🛡</span><span class="si-label">Operational Risk</span>
    </button>
    <button class="sb-item" data-view="ops-release" data-group="Technical Analytics" data-label="Release Planning" data-tooltip="Release Planning" data-desc="วางแผนการปล่อย Release และ Version ใหม่ของระบบต่างๆ">
      <span class="si-icon">📅</span><span class="si-label">Release Planning</span>
    </button>
    <button class="sb-item" data-view="ops-platform" data-group="Technical Analytics" data-label="Platform Health" data-tooltip="Platform Health" data-desc="ตรวจสอบสุขภาพและความเสถียรของ Platform และ Infrastructure">
      <span class="si-icon">🖥</span><span class="si-label">Platform Health</span>
    </button>
    <button class="sb-item" data-view="ops-support" data-group="Technical Analytics" data-label="Support Model" data-tooltip="Support Model" data-desc="โมเดลการให้บริการและ Support ระบบ แสดงช่องทางและระดับการสนับสนุน">
      <span class="si-icon">🎧</span><span class="si-label">Support Model</span>
    </button>
  </div>

  <div class="sb-divider"></div>

  <!-- ASSET MANAGEMENT group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Asset Management</span><div class="sl-line"></div></div>
    <button class="sb-item" data-view="asset-inventory" data-group="Asset Management" data-label="Asset Inventory" data-tooltip="Asset Inventory" data-desc="ตารางรวม Asset ทุกประเภท กรองตาม Hardware, Security, Network, Endpoint">
      <span class="si-icon">🖥</span><span class="si-label">Asset Inventory</span>
    </button>
    <button class="sb-item" data-view="asset-hardware" data-group="Asset Management" data-label="Hardware" data-tooltip="Hardware" data-desc="Server, Storage, UPS — พร้อมติดตาม Warranty และค่าใช้จ่าย">
      <span class="si-icon">⚙</span><span class="si-label">Hardware</span>
    </button>
    <button class="sb-item" data-view="asset-security" data-group="Asset Management" data-label="Security Equipment" data-tooltip="Security Equipment" data-desc="Firewall, IPS, WAF, SIEM — ติดตาม License และ Firmware">
      <span class="si-icon">🛡</span><span class="si-label">Security Equipment</span>
    </button>
    <button class="sb-item" data-view="asset-network" data-group="Asset Management" data-label="Network Equipment" data-tooltip="Network Equipment" data-desc="Switch, Router, AP — ติดตาม Firmware Patch Status">
      <span class="si-icon">🌐</span><span class="si-label">Network Equipment</span>
    </button>
    <button class="sb-item" data-view="asset-endpoint" data-group="Asset Management" data-label="Endpoint Security" data-tooltip="Endpoint Security" data-desc="AV, EDR, MDM — ติดตาม License Coverage และการ Deploy">
      <span class="si-icon">💻</span><span class="si-label">Endpoint Security</span>
    </button>
  </div>

  <div class="sb-divider"></div>

  <!-- ASSET ANALYTICS group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Asset Analytics</span><div class="sl-line"></div></div>
    <button class="sb-item" data-view="asset-analytics" data-group="Asset Analytics" data-label="Asset Analytics" data-tooltip="Asset Analytics" data-desc="วิเคราะห์ Warranty Expiry, Vendor Concentration, Security Compliance ของ Assets">
      <span class="si-icon">📊</span><span class="si-label">Asset Analytics</span>
    </button>
  </div>

  <div class="sb-divider"></div>

  <!-- SETTINGS group -->
  <div class="sb-section">
    <div class="sb-section-label"><span>Settings</span><div class="sl-line"></div></div>
    <button class="sb-item" data-view="settings-import-export" data-group="Settings" data-label="Import / Export" data-tooltip="Import / Export" data-desc="นำเข้าหรือส่งออกข้อมูลแอปพลิเคชันในรูปแบบ JSON หรือ Excel">
      <span class="si-icon">⇅</span><span class="si-label">Import / Export</span>
    </button>
  </div>

  <!-- Bottom stats -->
  <div class="sb-bottom">
    <div class="sb-app-count" id="sb-app-count">100 Applications · 10 Domains</div>
  </div>
</nav>

<!-- Sidebar Tooltip Popup -->
<div class="sb-tooltip-popup" id="sb-tooltip-popup">
  <div class="sb-tooltip-title" id="sb-tooltip-title"></div>
  <div class="sb-tooltip-desc" id="sb-tooltip-desc"></div>
</div>

<!-- CONTENT -->
<div id="content-area">
<div id="main">
  <!-- DASHBOARD -->
  <div class="view active" id="view-dashboard">
    <div style="display:flex;align-items:center;justify-content:flex-end;margin-bottom:4px">
      <button class="paper-out-btn" id="btn-dash-paper-out" onclick="dashboardPaperOut()" title="Export Dashboard เป็น PDF">
        <span class="paper-out-icon">🖨</span>
        <span class="paper-out-label">Paper Out</span>
      </button>
    </div>
    <div class="row" id="dash-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card">
        <div class="card-title">BCG Portfolio Matrix</div>
        <div class="bcg-grid" id="bcg-grid"></div>
      </div>
      <div style="display:flex;flex-direction:column;gap:16px">
        <div class="card" style="flex:1">
          <div class="card-title">Health Distribution</div>
          <div class="chart-wrap" style="height:150px"><canvas id="chart-health-dist"></canvas></div>
        </div>
        <div class="card" style="flex:1">
          <div class="card-title">TCO by Domain (Top 6)</div>
          <div class="chart-wrap" style="height:140px"><canvas id="chart-tco-domain"></canvas></div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-title">Risk Heatmap — Mission Critical Applications</div>
      <div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-risk"></table></div>
    </div>

    <!-- ── ASSET SUMMARY SECTION ─────────────────────────────────── -->
    <div style="display:flex;align-items:center;gap:10px;margin:28px 0 14px">
      <div style="font-size:9px;font-family:var(--mono);text-transform:uppercase;letter-spacing:2px;color:var(--dim);white-space:nowrap;display:flex;align-items:center;gap:8px">
        <span style="font-size:13px">⚙</span> IT Asset Summary
        <span style="font-size:8px;font-family:var(--mono);font-weight:700;letter-spacing:1px;padding:2px 7px;border-radius:3px;background:rgba(40,217,138,.1);color:var(--green);border:1px solid rgba(40,217,138,.3)">ASSET MGMT</span>
      </div>
      <div style="flex:1;height:1px;background:var(--border2)"></div>
    </div>

    <!-- Asset KPIs -->
    <div class="row" id="dash-asset-kpis" style="margin-bottom:12px"></div>

    <!-- Row 2: Health tiles + Expiry list -->
    <div class="grid-2 mb16" id="dash-asset-row2">
      <div class="card">
        <div class="card-title" style="font-family:var(--mono)">📊 Asset Health by Type <span style="font-size:10px;color:var(--dim);margin-left:auto;font-weight:400">avg score · คลิกเพื่อดู</span></div>
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px" id="dash-asset-health-tiles"></div>
      </div>
      <div class="card">
        <div class="card-title" style="font-family:var(--mono)">⏱ Warranty &amp; License — Expiry Alert <span style="font-size:10px;color:var(--dim);margin-left:auto;font-weight:400">≤ 12 months</span></div>
        <div id="dash-asset-expiry"></div>
      </div>
    </div>

    <!-- Row 3: Security compliance + Endpoint ring + Vendor -->
    <div class="grid-3 mb16" id="dash-asset-row3">
      <div class="card">
        <div class="card-title" style="font-family:var(--mono)">🛡 Security Compliance</div>
        <div id="dash-sec-compliance"></div>
      </div>
      <div class="card">
        <div class="card-title" style="font-family:var(--mono)">💻 Endpoint Coverage</div>
        <div id="dash-endpoint-ring" style="display:flex;justify-content:center;margin:2px 0 10px"></div>
        <div id="dash-endpoint-bars"></div>
      </div>
      <div class="card">
        <div class="card-title" style="font-family:var(--mono)">🏢 Vendor Concentration</div>
        <div id="dash-vendor-conc"></div>
      </div>
    </div>

    <!-- Row 4: Action Required -->
    <div id="dash-asset-actions"></div>

  </div>

  <!-- PORTFOLIO -->
  <div class="view" id="view-portfolio">
    <div class="filter-bar">
      <input class="search-input" id="port-search" placeholder="🔍  Search application or vendor…">
      <select class="filter-sel" id="port-domain"><option value="">All Domains</option></select>
      <select class="filter-sel" id="port-status">
        <option value="">All Status</option>
        <option>Active</option><option>Phase-out</option><option>To-retire</option><option>Planned</option>
      </select>
      <select class="filter-sel" id="port-bcg">
        <option value="">All BCG</option>
        <option>Invest</option><option>Grow</option><option>Tolerate</option><option>Retire</option>
      </select>
      <span id="port-count" style="color:var(--dim);font-size:12px;font-family:var(--mono)"></span>
    </div>
    <div id="port-grid"></div>
  </div>

  <!-- ROADMAP -->
  <div class="view" id="view-roadmap">
    <div class="card">
      <!-- Header row: title + navigator -->
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:14px;flex-wrap:wrap">
        <div class="card-title" style="margin:0;flex:1">Application Roadmap</div>
        <!-- Time range navigator -->
        <div class="rm-nav">
          <button class="rm-nav-btn" id="rm-prev" title="ย้อนหลัง 1 ไตรมาส">‹</button>
          <div class="rm-nav-label" id="rm-range-label"></div>
          <button class="rm-nav-btn" id="rm-next" title="เดินหน้า 1 ไตรมาส">›</button>
          <button class="rm-nav-btn rm-today-btn" id="rm-today" title="กลับสู่ปัจจุบัน">Today</button>
          <button class="paper-out-btn" id="btn-roadmap-paper-out" onclick="roadmapPaperOut()" title="Export Roadmap เป็น PDF">
            <span class="paper-out-icon">🖨</span>
            <span class="paper-out-label">Paper Out</span>
          </button>
        </div>
      </div>
      <!-- Legend -->
      <div style="display:flex;gap:14px;margin-bottom:14px;flex-wrap:wrap">
        <div class="rm-legend-item"><div style="background:#00d68f"></div><span>Upgrade</span></div>
        <div class="rm-legend-item"><div style="background:#4a9eff"></div><span>Migrate</span></div>
        <div class="rm-legend-item"><div style="background:#7b61ff"></div><span>New</span></div>
        <div class="rm-legend-item"><div style="background:#ff4757"></div><span>Retire</span></div>
        <div class="rm-legend-item"><div style="background:#ffa000"></div><span>Modernize</span></div>
        <div class="rm-legend-item"><div style="background:rgba(255,255,255,.25);border:1px dashed rgba(255,255,255,.3)"></div><span>Today</span></div>
      </div>
      <!-- Quarter headers -->
      <div class="rm-headers" id="rm-headers"></div>
      <!-- Rows -->
      <div id="roadmap-rows" style="overflow-y:auto;max-height:calc(100vh - 280px)"></div>
    </div>
  </div>

  <!-- LIFECYCLE -->
  <div class="view" id="view-lifecycle">
    <div class="card">
      <div class="card-title">Application Lifecycle Analysis (sorted by Health)</div>
      <div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-lifecycle"></table></div>
    </div>
  </div>

  <!-- TECH DEBT -->
  <div class="view" id="view-techdebt">
    <div class="grid-2 mb16">
      <div class="card">
        <div class="card-title">Tech Debt by Category</div>
        <div style="display:flex;align-items:center;gap:20px">
          <div class="chart-wrap" style="height:200px;flex:1"><canvas id="chart-debt-donut"></canvas></div>
          <div class="donut-legend" id="debt-legend"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-title">Top 10 Debt Contributors</div>
        <div class="chart-wrap" style="height:220px"><canvas id="chart-debt-top10"></canvas></div>
      </div>
    </div>
    <div class="card">
      <div class="card-title">Tech Debt Ranking — All Applications</div>
      <div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-debt"></table></div>
    </div>
  </div>

  <!-- CAPABILITY -->
  <div class="view" id="view-capability">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
      <div style="font-size:15px;font-weight:700;color:var(--text)">Business Capability Map</div>
      <span id="cap-stats" style="font-size:12px;color:var(--dim);font-family:var(--mono)"></span>
    </div>
    <div id="cap-grid"></div>
  </div>

  <!-- STANDARDS -->
  <div class="view" id="view-standards">
    <div class="card mb16"><div class="card-title">Technology Standards Compliance</div><div id="std-bars"></div></div>
    <div class="grid-2">
      <div class="card"><div class="card-title">Vendor Concentration Risk</div><div class="chart-wrap" style="height:250px"><canvas id="chart-vendor"></canvas></div></div>
      <div class="card"><div class="card-title">Contract Expiry Pipeline</div><div style="overflow-y:auto;max-height:260px" id="contract-list"></div></div>
    </div>
  </div>

  <!-- FINANCIAL -->
  <div class="view" id="view-financial">
    <div class="row" id="fin-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card"><div class="card-title">TCO vs Health Score (bubble=users)</div><div class="chart-wrap" style="height:280px"><canvas id="chart-tco-scatter"></canvas></div></div>
      <div class="card"><div class="card-title">Retirement Savings Forecast</div><div class="chart-wrap" style="height:280px"><canvas id="chart-retire-save"></canvas></div></div>
    </div>
    <div class="card"><div class="card-title">Cost of Legacy — Applications >10 Years</div><div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-legacy"></table></div></div>
  </div>

  <!-- EXECUTIVE -->
  <div class="view" id="view-executive">
    <div class="row" id="exec-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card"><div class="card-title">Investment vs Strategic Alignment by Domain</div><div class="chart-wrap" style="height:280px"><canvas id="chart-exec-inv"></canvas></div></div>
      <div class="card"><div class="card-title">Strategic Alignment Scatter (Health × Strategy)</div><div class="chart-wrap" style="height:280px"><canvas id="chart-exec-scatter"></canvas></div></div>
    </div>
    <div class="card mb16"><div class="card-title">Simplification Narrative — Domain Rationalization</div><div class="grid-4" id="exec-domain-grid"></div></div>
    <div class="card"><div class="card-title">Risk & Resilience Heatmap</div><div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-resilience"></table></div></div>
  </div>

  <!-- ─── IT OPS VIEWS ──────────────────────────────────── -->

  <!-- OPS RISK -->
  <div class="view" id="view-ops-risk">
    <div class="row" id="ops-risk-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card">
        <div class="card-title">Operational Risk Matrix — Criticality × People Coverage</div>
        <div id="ops-risk-matrix" style="overflow-x:auto"></div>
      </div>
      <div class="card">
        <div class="card-title">Key Person Risk — High Dependency Apps</div>
        <div class="chart-wrap" style="height:260px"><canvas id="chart-keyperson"></canvas></div>
      </div>
    </div>
    <div class="card">
      <div class="card-title">Operational Risk Register — All Applications</div>
      <div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-ops-risk"></table></div>
    </div>
  </div>

  <!-- OPS RELEASE -->
  <div class="view" id="view-ops-release">
    <div class="card mb16">
      <div class="card-title">Release Calendar 2025 — Maintenance Windows & Sensitive Periods</div>
      <div id="release-calendar"></div>
      <div style="margin-top:12px;display:flex;gap:16px;flex-wrap:wrap">
        <div style="display:flex;align-items:center;gap:6px"><div style="width:12px;height:12px;border-radius:3px;background:rgba(255,71,87,.27);border:1px solid var(--red)"></div><span style="font-size:11px;color:var(--dim)">Blackout (month-end / campaign)</span></div>
        <div style="display:flex;align-items:center;gap:6px"><div style="width:12px;height:12px;border-radius:3px;background:rgba(255,160,0,.27);border:1px solid var(--yellow)"></div><span style="font-size:11px;color:var(--dim)">Caution Window</span></div>
        <div style="display:flex;align-items:center;gap:6px"><div style="width:12px;height:12px;border-radius:3px;background:rgba(0,214,143,.27);border:1px solid var(--green)"></div><span style="font-size:11px;color:var(--dim)">Safe Deploy Window</span></div>
      </div>
    </div>
    <div class="grid-2">
      <div class="card">
        <div class="card-title">Applications by Service Hour</div>
        <div class="chart-wrap" style="height:240px"><canvas id="chart-service-hour"></canvas></div>
      </div>
      <div class="card">
        <div class="card-title">Maintenance Window Slots</div>
        <div id="maint-windows" style="overflow-y:auto;max-height:260px"></div>
      </div>
    </div>
  </div>

  <!-- OPS PLATFORM -->
  <div class="view" id="view-ops-platform">
    <div class="row" id="platform-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card">
        <div class="card-title">Technology Landscape — Stack Distribution</div>
        <div class="chart-wrap" style="height:260px"><canvas id="chart-stack-dist"></canvas></div>
      </div>
      <div class="card">
        <div class="card-title">OS & Database Platform Coverage</div>
        <div class="chart-wrap" style="height:260px"><canvas id="chart-platform-coverage"></canvas></div>
      </div>
    </div>
    <div class="card mb16">
      <div class="card-title">Technology Stack Inventory — Platform Groupings</div>
      <div id="stack-inventory" style="display:flex;flex-wrap:wrap;gap:8px;padding:4px 0"></div>
    </div>
    <div class="card">
      <div class="card-title">Platform Roadmap — Stack Modernization Priority</div>
      <div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-platform"></table></div>
    </div>
  </div>

  <!-- OPS SUPPORT -->
  <div class="view" id="view-ops-support">
    <div class="row" id="support-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card">
        <div class="card-title">Support Model Distribution</div>
        <div style="display:flex;align-items:center;gap:20px">
          <div class="chart-wrap" style="height:220px;flex:1"><canvas id="chart-support-model"></canvas></div>
          <div class="donut-legend" id="support-legend"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-title">RACI Overview — Incident / Problem Management</div>
        <div class="tbl-scroll" style="max-height:250px"><table class="tbl sticky-header" id="tbl-raci"></table></div>
      </div>
    </div>
    <div class="card">
      <div class="card-title">Application Support Directory</div>
      <div id="support-directory" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-top:4px"></div>
    </div>
  </div>

  <!-- ─── PPM VIEWS ─────────────────────────────────────── -->

  <!-- PPM WAVE -->
  <div class="view" id="view-ppm-wave">
    <div class="row" id="wave-kpis"></div>
    <div id="wave-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px;margin-bottom:16px"></div>
    <div class="card">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:14px;flex-wrap:wrap">
        <div class="card-title" style="margin:0;flex:1">Wave Programme Timeline</div>
        <div class="rm-nav">
          <button class="rm-nav-btn" id="wv-prev" title="ย้อนหลัง 1 ไตรมาส">‹</button>
          <div class="rm-nav-label" id="wv-range-label"></div>
          <button class="rm-nav-btn" id="wv-next" title="เดินหน้า 1 ไตรมาส">›</button>
          <button class="rm-nav-btn rm-today-btn" id="wv-today" title="กลับสู่ปัจจุบัน">Today</button>
          <button class="paper-out-btn" id="btn-wave-paper-out" onclick="wavePaperOut()" title="Export Wave Timeline เป็น PDF">
            <span class="paper-out-icon">🖨</span>
            <span class="paper-out-label">Paper Out</span>
          </button>
        </div>
      </div>
      <!-- Legend -->
      <div style="display:flex;gap:14px;margin-bottom:14px;flex-wrap:wrap">
        <div class="rm-legend-item"><div style="background:#00d68f"></div><span>Wave 1</span></div>
        <div class="rm-legend-item"><div style="background:#4a9eff"></div><span>Wave 2</span></div>
        <div class="rm-legend-item"><div style="background:#8a8fa8"></div><span>Wave 3</span></div>
        <div class="rm-legend-item"><div style="background:rgba(255,255,255,.25);border:1px dashed rgba(255,255,255,.3)"></div><span>Today</span></div>
      </div>
      <div id="wv-headers"></div>
      <div id="wave-timeline" style="overflow-y:auto;max-height:400px;position:relative"></div>
    </div>
  </div>

  <!-- PPM DEPENDENCY -->
  <div class="view" id="view-ppm-dependency">
    <div class="row" id="dep-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card">
        <div class="card-title">Integration Dependency Complexity</div>
        <div class="chart-wrap" style="height:280px"><canvas id="chart-dep-complexity"></canvas></div>
      </div>
      <div class="card">
        <div class="card-title">Retire-Blocked Dependencies</div>
        <div id="dep-blocked" style="overflow-y:auto;max-height:290px"></div>
      </div>
    </div>
    <div class="card">
      <div class="card-title">Dependency Chain Map — Critical Path Applications</div>
      <div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-dependency"></table></div>
    </div>
  </div>

  <!-- PPM RESOURCE -->
  <div class="view" id="view-ppm-resource">
    <div class="row" id="res-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card">
        <div class="card-title">Modernization Effort Estimate by Approach</div>
        <div class="chart-wrap" style="height:260px"><canvas id="chart-effort"></canvas></div>
      </div>
      <div class="card">
        <div class="card-title">Skill Demand by Project Stream</div>
        <div class="chart-wrap" style="height:260px"><canvas id="chart-skills"></canvas></div>
      </div>
    </div>
    <div class="card">
      <div class="card-title">Project Complexity Assessment</div>
      <div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-complexity"></table></div>
    </div>
  </div>

  <!-- PPM ASSESSMENT -->
  <div class="view" id="view-ppm-assessment">
    <div class="row" id="assess-kpis"></div>
    <div class="grid-2 mb16">
      <div class="card">
        <div class="card-title">Assessment Status Overview</div>
        <div style="display:flex;align-items:center;gap:20px">
          <div class="chart-wrap" style="height:220px;flex:1"><canvas id="chart-assess-status"></canvas></div>
          <div class="donut-legend" id="assess-legend"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-title">Assessment Due / Overdue Timeline</div>
        <div class="chart-wrap" style="height:220px"><canvas id="chart-assess-timeline"></canvas></div>
      </div>
    </div>
    <div class="card">
      <div class="card-title">Assessment Register — All Applications</div>
      <div class="tbl-scroll"><table class="tbl sticky-header" id="tbl-assessment"></table></div>
    </div>
  </div>
  <!-- APP INVENTORY -->
  <div class="view" id="view-inventory">
    <!-- toolbar -->
    <div class="inv-toolbar">
      <div class="inv-search-wrap">
        <span class="inv-search-icon">🔍</span>
        <input class="inv-search" id="inv-search" placeholder="ค้นหาชื่อแอป, vendor, domain…">
      </div>
      <select class="filter-sel" id="inv-filter-domain"><option value="">ทุก Domain</option></select>
      <select class="filter-sel" id="inv-filter-status">
        <option value="">ทุก Status</option>
        <option>Active</option><option>Phase-out</option><option>To-retire</option><option>Planned</option><option>Decommissioned</option>
      </select>
      <select class="filter-sel" id="inv-filter-type">
        <option value="">ทุก Type</option><option>Package</option><option>Inhouse</option>
      </select>
      <label class="inv-show-decomm">
        <input type="checkbox" id="inv-show-decomm"> <span>แสดง Decommissioned</span>
      </label>
      <span id="inv-count" style="color:var(--dim);font-size:12px;font-family:var(--mono);margin-left:auto"></span>
    </div>

    <!-- table -->
    <div class="card" style="padding:0;overflow:hidden">
      <div class="tbl-scroll" style="max-height:calc(100vh - 200px)">
        <table class="tbl sticky-header inv-tbl" id="tbl-inventory">
          <thead>
            <tr>
              <th style="width:36px"></th>
              <th>App ID</th>
              <th>ชื่อแอปพลิเคชัน</th>
              <th>Domain</th>
              <th>Vendor</th>
              <th>Type</th>
              <th>Status</th>
              <th>Criticality</th>
              <th>Health</th>
              <th>TCO/ปี</th>
              <th>Owner</th>
              <th>Biz Owner</th>
              <th>อัปเดตล่าสุด</th>
              <th style="width:100px;text-align:center">Actions</th>
            </tr>
          </thead>
          <tbody id="inv-tbody"></tbody>
        </table>
      </div>
    </div>
  </div>
  <!-- MPX BLUEPRINT -->
  <div class="view" id="view-mpx-blueprint">
    <div class="card">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:4px;flex-wrap:wrap;gap:10px">
        <div>
          <div class="card-title" style="margin-bottom:2px">🏗 MPX Enterprise Architecture Blueprint</div>
          <div style="font-size:11px;color:var(--dim)">แผนผัง EA ขององค์กร — คลิกที่แต่ละ Category เพื่อดูรายชื่อแอป</div>
        </div>
        <div class="bp-legend">
          <div class="bp-legend-item"><div class="bp-legend-dot" style="background:#00d68f"></div>สุขภาพดี (≥70)</div>
          <div class="bp-legend-item"><div class="bp-legend-dot" style="background:#ffa000"></div>ควรระวัง (50–69)</div>
          <div class="bp-legend-item"><div class="bp-legend-dot" style="background:#ff4757"></div>ความเสี่ยงสูง (&lt;50)</div>
          <div class="bp-legend-item"><div class="bp-legend-dot" style="background:var(--border)"></div>ยังไม่มีแอป</div>
        </div>
      </div>
      <div class="bp-wrap">
        <div id="bp-canvas"></div>
      </div>
    </div>
    <!-- Tooltip element (shared) -->
    <div class="bp-tooltip" id="bp-tooltip"></div>
  </div>


  <!-- MPX 2 -->
  <div class="view" id="view-mpx2">
    <div class="card" style="padding:16px">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap;gap:8px">
        <div>
          <div class="card-title" style="margin-bottom:2px">🗺 MPX EA Blueprint</div>
          <div style="font-size:11px;color:var(--dim)">Hover บน badge เพื่อดูรายชื่อแอป · คลิกเพื่อ filter ใน EA Landscape</div>
        </div>
        <div class="bp-legend">
          <div class="bp-legend-item"><div class="bp-legend-dot" style="background:#00d68f"></div>สุขภาพดี (≥70)</div>
          <div class="bp-legend-item"><div class="bp-legend-dot" style="background:#ffa000"></div>ควรระวัง (50–69)</div>
          <div class="bp-legend-item"><div class="bp-legend-dot" style="background:#ff4757"></div>ความเสี่ยงสูง (&lt;50)</div>
        </div>
      </div>
      <div style="position:relative;width:100%;max-width:993px;margin:0 auto;user-select:none" id="mpx2-wrap">
        <img src="data:image/jpeg;base64,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ajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYHajSODkKwABJ6m1gdqNI4OQam1gdqNI4OQrAAEnqbWB2o0jg5BqbWB2o0jg5CsAASeptYHajSODkGptYH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"
             style="width:100%;height:auto;display:block;border-radius:8px"
             id="mpx2-img" alt="MPX EA Landscape">
        <div id="mpx2-overlay" style="position:absolute;inset:0;pointer-events:none"></div>
      </div>
    </div>
    <div class="bp-tooltip" id="mpx2-tooltip"></div>
  </div>

  <!-- EA LANDSCAPE -->
  <div class="view" id="view-ea-landscape">
    <div class="ea-toolbar">
      <div class="inv-search-wrap" style="max-width:280px">
        <span class="inv-search-icon">🔍</span>
        <input class="inv-search" id="ea-search" placeholder="ค้นหาแอปใน Landscape…">
      </div>
      <select class="filter-sel" id="ea-filter-group"><option value="">ทุก EA Group</option></select>
      <select class="filter-sel" id="ea-filter-status">
        <option value="">ทุก Status</option>
        <option>Active</option><option>Phase-out</option><option>To-retire</option><option>Planned</option>
      </select>
      <div style="margin-left:auto;display:flex;align-items:center;gap:8px">
        <span id="ea-count" style="font-size:12px;color:var(--dim);font-family:var(--mono)"></span>
        <div class="ea-view-toggle">
          <button class="ea-vbtn active" id="ea-view-landscape" title="Landscape View">⊞</button>
          <button class="ea-vbtn" id="ea-view-list" title="List View">☰</button>
        </div>
      </div>
    </div>
    <div id="ea-landscape-content"></div>
  </div>
  <!-- APP INSIGHT -->
  <div class="view" id="view-app-insight">
    <div class="insight-selector-bar">
      <div class="insight-sel-wrap">
        <span class="insight-sel-icon">🔬</span>
        <select id="insight-app-select" class="insight-select">
          <option value="">— เลือกแอปพลิเคชันที่ต้องการวิเคราะห์ —</option>
        </select>
      </div>
      <div id="insight-app-badge" style="display:none"></div>
      <button class="paper-out-btn" id="btn-paper-out" onclick="insightPaperOut()" style="display:none" title="Export รายงานเป็น PDF">
        <span class="paper-out-icon">🖨</span>
        <span class="paper-out-label">Paper Out</span>
      </button>
    </div>
    <div id="insight-content">
      <div class="insight-empty">
        <div class="insight-empty-icon">🔬</div>
        <div class="insight-empty-title">App Insight Report</div>
        <div class="insight-empty-sub">เลือกแอปพลิเคชันจาก dropdown ด้านบนเพื่อดูรายละเอียดและการวิเคราะห์เชิงลึก</div>
      </div>
    </div>
  </div>

  <!-- SETTINGS: IMPORT / EXPORT -->
  <div class="view" id="view-settings-import-export">
    <div id="ie-content"></div>
  </div>


<!-- ═══════════════════════════════════════════════════════ -->
<!-- ASSET MANAGEMENT VIEWS                                  -->
<!-- ═══════════════════════════════════════════════════════ -->

<!-- ASSET INVENTORY (All) -->
<div class="view" id="view-asset-inventory">
  <div class="view-header" style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
    <div>
      <div class="view-title" style="font-size:18px;font-weight:700;color:var(--text)">🖥 Asset Inventory</div>
      <div style="font-size:12px;color:var(--dim)">รายการ IT Assets ทั้งหมดขององค์กร</div>
    </div>
    <button class="paper-out-btn" onclick="openAddAsset()" style="background:var(--accent);color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:12px;font-weight:600">＋ Add Asset</button>
  </div>
  <div id="asset-stats" style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px"></div>
  <div class="asset-filter-row">
    <button class="asset-ft active" onclick="sfAsset('all',this)">ทั้งหมด</button>
    <button class="asset-ft" onclick="sfAsset('hardware',this)">🖥 Hardware</button>
    <button class="asset-ft" onclick="sfAsset('security',this)">🛡 Security</button>
    <button class="asset-ft" onclick="sfAsset('network',this)">🌐 Network</button>
    <button class="asset-ft" onclick="sfAsset('endpoint',this)">💻 Endpoint</button>
    <input class="asset-search" placeholder="🔍 ค้นหา..." oninput="setAssetSearch(this.value)">
  </div>
  <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;overflow:hidden">
    <div style="overflow-x:auto">
      <table style="width:100%;border-collapse:collapse;font-size:12px" id="asset-main-table">
        <thead><tr style="background:var(--card2);border-bottom:1px solid var(--border2)">
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600;white-space:nowrap">ID</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Asset Name</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Type</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Category</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Brand/Model</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Location</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Health</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Warranty</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">License Exp.</th>
          <th style="padding:10px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Action</th>
        </tr></thead>
        <tbody id="asset-tbody"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- HARDWARE -->
<div class="view" id="view-asset-hardware">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
    <div><div style="font-size:18px;font-weight:700;color:var(--text)">⚙ Hardware Management</div><div style="font-size:12px;color:var(--dim)">Servers, Storage, UPS และอุปกรณ์ Hardware</div></div>
    <button onclick="openAddAssetType('hardware')" style="background:var(--accent);color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:12px;font-weight:600">＋ Add Hardware</button>
  </div>
  <div id="hw-stats" style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px"></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:10px">Hardware by Category</div>
      <canvas id="hwCat" height="200"></canvas>
    </div>
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:4px">Warranty Expiry Timeline</div>
      <div style="font-size:11px;color:var(--dim);margin-bottom:10px">Upcoming expirations</div>
      <div id="hwWarranty"></div>
    </div>
  </div>
  <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;overflow:hidden">
    <div style="padding:12px 14px;border-bottom:1px solid var(--border2)"><span style="font-size:13px;font-weight:700;color:var(--text)">Hardware Inventory</span><span style="font-size:11px;color:var(--dim);margin-left:8px">Servers, Storage, UPS, etc.</span></div>
    <div style="overflow-x:auto"><table style="width:100%;border-collapse:collapse;font-size:12px"><thead><tr style="background:var(--card2);border-bottom:1px solid var(--border2)"><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">ID</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Name</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Category</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Brand/Model</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">S/N</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Location</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Age</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Health</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Warranty</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Cost(M฿)</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Action</th></tr></thead><tbody id="hw-tbody"></tbody></table></div>
  </div>
</div>

<!-- SECURITY EQUIPMENT -->
<div class="view" id="view-asset-security">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
    <div><div style="font-size:18px;font-weight:700;color:var(--text)">🛡 Security Equipment</div><div style="font-size:12px;color:var(--dim)">Firewall, IPS/IDS, WAF, SIEM, PAM และ Security Devices</div></div>
    <button onclick="openAddAssetType('security')" style="background:var(--accent);color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:12px;font-weight:600">＋ Add Security</button>
  </div>
  <div id="sec-stats2" style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px"></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:10px">Security by Category</div>
      <canvas id="secCat" height="200"></canvas>
    </div>
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:4px">License Expiry Timeline</div>
      <div style="font-size:11px;color:var(--dim);margin-bottom:10px">ใบอนุญาตที่กำลังหมดอายุ</div>
      <div id="secLicense"></div>
    </div>
  </div>
  <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;overflow:hidden">
    <div style="padding:12px 14px;border-bottom:1px solid var(--border2)"><span style="font-size:13px;font-weight:700;color:var(--text)">Security Equipment Inventory</span><span style="font-size:11px;color:var(--dim);margin-left:8px">Firewall, IPS, WAF, SIEM, etc.</span></div>
    <div style="overflow-x:auto"><table style="width:100%;border-collapse:collapse;font-size:12px"><thead><tr style="background:var(--card2);border-bottom:1px solid var(--border2)"><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">ID</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Name</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Category</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Brand/Model</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Location</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Firmware</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Health</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">License Exp.</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Throughput</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Action</th></tr></thead><tbody id="sec-tbody"></tbody></table></div>
  </div>
</div>

<!-- NETWORK EQUIPMENT -->
<div class="view" id="view-asset-network">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
    <div><div style="font-size:18px;font-weight:700;color:var(--text)">🌐 Network Equipment</div><div style="font-size:12px;color:var(--dim)">Switch, Router, AP, Load Balancer, SD-WAN</div></div>
    <button onclick="openAddAssetType('network')" style="background:var(--accent);color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:12px;font-weight:600">＋ Add Network</button>
  </div>
  <div id="net-stats" style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px"></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:10px">Network by Category</div>
      <canvas id="netCat" height="200"></canvas>
    </div>
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:10px">Firmware Patch Status</div>
      <div id="netFw"></div>
    </div>
  </div>
  <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;overflow:hidden">
    <div style="padding:12px 14px;border-bottom:1px solid var(--border2)"><span style="font-size:13px;font-weight:700;color:var(--text)">Network Equipment Inventory</span></div>
    <div style="overflow-x:auto"><table style="width:100%;border-collapse:collapse;font-size:12px"><thead><tr style="background:var(--card2);border-bottom:1px solid var(--border2)"><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">ID</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Name</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Category</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Brand/Model</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Location</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">IP</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Firmware</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Health</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Warranty</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Action</th></tr></thead><tbody id="net-tbody"></tbody></table></div>
  </div>
</div>

<!-- ENDPOINT SECURITY -->
<div class="view" id="view-asset-endpoint">
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px">
    <div><div style="font-size:18px;font-weight:700;color:var(--text)">💻 Endpoint Security</div><div style="font-size:12px;color:var(--dim)">Antivirus, EDR, MDM, Patch Management</div></div>
    <button onclick="openAddAssetType('endpoint')" style="background:var(--accent);color:#fff;border:none;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:12px;font-weight:600">＋ Add Endpoint</button>
  </div>
  <div id="ep-stats" style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px"></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:4px">Endpoint Coverage</div>
      <div style="font-size:11px;color:var(--dim);margin-bottom:10px">% endpoints protected</div>
      <div id="epCoverage"></div>
    </div>
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:10px">License Expiry</div>
      <div id="epLicense"></div>
    </div>
  </div>
  <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;overflow:hidden">
    <div style="padding:12px 14px;border-bottom:1px solid var(--border2)"><span style="font-size:13px;font-weight:700;color:var(--text)">Endpoint Security Inventory</span></div>
    <div style="overflow-x:auto"><table style="width:100%;border-collapse:collapse;font-size:12px"><thead><tr style="background:var(--card2);border-bottom:1px solid var(--border2)"><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">ID</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Name</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Category</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Brand</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Version</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Deployed</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Coverage%</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">License Exp.</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Health</th><th style="padding:9px 12px;text-align:left;font-size:10px;color:var(--dim);font-weight:600">Action</th></tr></thead><tbody id="ep-tbody"></tbody></table></div>
  </div>
</div>

<!-- ASSET ANALYTICS -->
<div class="view" id="view-asset-analytics">
  <div style="margin-bottom:16px">
    <div style="font-size:18px;font-weight:700;color:var(--text)">📊 Asset Analytics</div>
    <div style="font-size:12px;color:var(--dim)">วิเคราะห์ Warranty, License, Vendor Concentration และ Security Compliance</div>
  </div>
  <div id="anas" style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px"></div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:4px">Security Compliance Status</div>
      <div style="font-size:11px;color:var(--dim);margin-bottom:10px">License & Patch Coverage</div>
      <div id="secComp"></div>
    </div>
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:10px">Vendor Concentration</div>
      <div class="vg" id="vendorGrid"></div>
    </div>
  </div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:10px">Asset by Location (Site)</div>
      <canvas id="locChart" height="200"></canvas>
    </div>
    <div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px">
      <div style="font-size:12px;font-weight:700;color:var(--text);margin-bottom:10px">Warranty / License Expiry Risk</div>
      <div id="expRisk"></div>
    </div>
  </div>
</div>

</div><!-- #main -->
</div><!-- #content-area -->
</div><!-- #app-shell -->

<!-- ADD/EDIT ASSET MODAL -->
<div class="asset-mo" id="asset-modal">
<div class="asset-mdl">
  <div class="asset-mdt"><span id="asset-modal-title">Add Asset</span><button class="asset-mcl" onclick="closeAssetModal()">✕</button></div>
  <div class="asset-fss">ประเภท Asset</div>
  <div class="asset-fr2">
    <div class="asset-fg"><label class="asset-fl">Asset Type *</label>
      <select class="asset-fsl" id="as-type" onchange="onAssetTypeChange()">
        <option value="hardware">🖥 Hardware</option>
        <option value="security">🛡 Security Equipment</option>
        <option value="network">🌐 Network Equipment</option>
        <option value="endpoint">💻 Endpoint Security</option>
      </select>
    </div>
    <div class="asset-fg"><label class="asset-fl">Category *</label><select class="asset-fsl" id="as-cat"></select></div>
  </div>
  <div class="asset-fss">ข้อมูลพื้นฐาน</div>
  <div class="asset-fr2"><div class="asset-fg"><label class="asset-fl">Asset Name *</label><input class="asset-fi" id="as-name" type="text" placeholder="e.g. Firewall-HQ-01"></div><div class="asset-fg"><label class="asset-fl">ID</label><input class="asset-fi" id="as-id" readonly style="opacity:.5"></div></div>
  <div class="asset-fg"><label class="asset-fl">คำอธิบาย</label><textarea class="asset-fta" id="as-desc" placeholder="หน้าที่และการใช้งาน..."></textarea></div>
  <div class="asset-fr2">
    <div class="asset-fg"><label class="asset-fl">Brand</label><input class="asset-fi" id="as-brand" type="text" placeholder="e.g. Cisco, Fortinet, Dell"></div>
    <div class="asset-fg"><label class="asset-fl">Model</label><input class="asset-fi" id="as-model" type="text" placeholder="e.g. FortiGate 600E"></div>
  </div>
  <div class="asset-fg" id="sn-group"><label class="asset-fl">Serial Number</label><input class="asset-fi" id="as-sn" type="text"></div>
  <div class="asset-fss">ที่ตั้ง</div>
  <div class="asset-fr3">
    <div class="asset-fg"><label class="asset-fl">Site / อาคาร</label><input class="asset-fi" id="as-site" type="text" placeholder="e.g. HQ, DR Site"></div>
    <div class="asset-fg"><label class="asset-fl">Room / Data Center</label><input class="asset-fi" id="as-room" type="text" placeholder="e.g. DC-1"></div>
    <div class="asset-fg"><label class="asset-fl">Rack / Cabinet</label><input class="asset-fi" id="as-rack" type="text" placeholder="e.g. Rack-A3"></div>
  </div>
  <div class="asset-fg" id="ip-group"><label class="asset-fl">IP Address</label><input class="asset-fi" id="as-ip" type="text" placeholder="e.g. 10.0.1.1"></div>
  <div class="asset-fss">Criticality & Health</div>
  <div class="asset-fr2">
    <div class="asset-fg"><label class="asset-fl">Criticality</label><select class="asset-fsl" id="as-crit"><option>Mission Critical</option><option>Business Critical</option><option>Important</option><option>Supporting</option></select></div>
    <div class="asset-fg"><label class="asset-fl">Health Score (0–100)</label><input class="asset-fi" id="as-health" type="number" min="0" max="100"></div>
  </div>
  <div class="asset-fss">Financial</div>
  <div class="asset-fr3">
    <div class="asset-fg"><label class="asset-fl">Purchase Cost (M฿)</label><input class="asset-fi" id="as-cost" type="number" step="0.01"></div>
    <div class="asset-fg"><label class="asset-fl">Annual Maint. (M฿)</label><input class="asset-fi" id="as-tco" type="number" step="0.01"></div>
    <div class="asset-fg"><label class="asset-fl">Purchase Year</label><input class="asset-fi" id="as-purchased" type="text" placeholder="e.g. 2021"></div>
  </div>
  <div class="asset-fss">Warranty & Support</div>
  <div class="asset-fr2">
    <div class="asset-fg"><label class="asset-fl">Warranty Expiry</label><input class="asset-fi" id="as-warranty" type="text" placeholder="e.g. 2026"></div>
    <div class="asset-fg"><label class="asset-fl">Support Contract</label><select class="asset-fsl" id="as-support"><option value="vendor">Vendor Support</option><option value="3rd">3rd Party</option><option value="none">ไม่มี</option></select></div>
  </div>
  <div class="asset-fss">Version & Patch</div>
  <div class="asset-fr2">
    <div class="asset-fg"><label class="asset-fl">Firmware / Version</label><input class="asset-fi" id="as-fw" type="text" placeholder="e.g. v7.4.1"></div>
    <div class="asset-fg"><label class="asset-fl">Last Patch / Update</label><input class="asset-fi" id="as-patch" type="text" placeholder="e.g. 2025-01-15"></div>
  </div>
  <div class="asset-fss" id="lic-sec">License</div>
  <div class="asset-fr2" id="lic-group">
    <div class="asset-fg"><label class="asset-fl">License Count</label><input class="asset-fi" id="as-liccount" type="number" placeholder="จำนวน license"></div>
    <div class="asset-fg"><label class="asset-fl">License Expiry</label><input class="asset-fi" id="as-licexp" type="text" placeholder="e.g. 2026"></div>
  </div>
  <div class="asset-fg" id="dep-group" style="display:none"><label class="asset-fl">Deployed / Coverage</label><input class="asset-fi" id="as-deployed" type="number" placeholder="จำนวน endpoint ที่ติดตั้ง"></div>
  <div class="asset-fss" id="spec-sec">Specifications</div>
  <div class="asset-fr2" id="spec-group">
    <div class="asset-fg"><label class="asset-fl">Throughput / Capacity</label><input class="asset-fi" id="as-throughput" type="text" placeholder="e.g. 40 Gbps"></div>
    <div class="asset-fg"><label class="asset-fl">Ports / Interfaces</label><input class="asset-fi" id="as-ports" type="text" placeholder="e.g. 24x GE, 4x SFP+"></div>
  </div>
  <div class="asset-fss">Ownership</div>
  <div class="asset-fr2">
    <div class="asset-fg"><label class="asset-fl">Owner / Responsible</label><input class="asset-fi" id="as-owner" type="text"></div>
    <div class="asset-fg"><label class="asset-fl">Managed By</label><select class="asset-fsl" id="as-managed"><option value="inhouse">In-house</option><option value="vendor">Vendor Managed</option><option value="outsource">Outsource</option></select></div>
  </div>
  <div class="asset-mff"><button onclick="closeAssetModal()" style="padding:8px 16px;background:var(--card2);border:1px solid var(--border2);border-radius:7px;color:var(--text);cursor:pointer;font-size:12px">ยกเลิก</button><button onclick="saveAsset()" id="asset-save-btn" style="padding:8px 16px;background:var(--accent);border:none;border-radius:7px;color:#fff;cursor:pointer;font-size:12px;font-weight:600">💾 บันทึก</button></div>
</div>
</div>

<!-- ASSET DELETE CONFIRM -->
<div class="asset-conf" id="asset-conf">
<div class="asset-cb2">
  <div style="font-size:14px;font-weight:700;color:#e05a5a;margin-bottom:7px">⚠ ยืนยัน</div>
  <div style="font-size:12px;color:var(--dim);margin-bottom:14px;line-height:1.5" id="asset-ctxt"></div>
  <div style="display:flex;justify-content:flex-end;gap:7px">
    <button onclick="closeAssetConf()" style="padding:7px 14px;background:var(--card2);border:1px solid var(--border2);border-radius:7px;color:var(--text);cursor:pointer;font-size:12px">ยกเลิก</button>
    <button id="asset-cok" style="padding:7px 14px;background:#e05a5a;border:none;border-radius:7px;color:#fff;cursor:pointer;font-size:12px;font-weight:600">ยืนยัน</button>
  </div>
</div>
</div>



<!-- EDIT APP MODAL -->
<div class="modal-overlay" id="modal-edit" style="display:none">
  <div class="modal" style="width:700px;max-height:92vh">
    <div class="modal-title">
      <span>✏️ แก้ไขแอปพลิเคชัน</span>
      <div style="display:flex;align-items:center;gap:8px">
        <span id="edit-app-id" style="font-size:12px;color:var(--dim);font-family:var(--mono)"></span>
        <button class="modal-close" id="modal-edit-close">✕</button>
      </div>
    </div>

    <!-- Tabs -->
    <div class="edit-tabs">
      <button class="edit-tab active" data-tab="app-info">📋 ข้อมูลแอป</button>
      <button class="edit-tab" data-tab="ea-info">🏛 EA Landscape</button>
      <button class="edit-tab" data-tab="ops-info">🔧 IT Operations</button>
    </div>

    <!-- Tab: App Info -->
    <div class="edit-tab-panel active" id="tab-app-info">
      <div class="form-grid">
        <div class="form-field"><label class="form-label">App Name</label><input class="form-input" id="e-name"></div>
        <div class="form-field"><label class="form-label">Vendor</label><input class="form-input" id="e-vendor"></div>
        <div class="form-field"><label class="form-label">Domain</label>
          <select class="form-select" id="e-domain">
            <option>Finance</option><option>HR</option><option>Operations</option><option>Customer</option>
            <option>Supply Chain</option><option>Digital</option><option>Infrastructure</option>
            <option>Security</option><option>Analytics</option><option>CRM</option>
          </select></div>
        <div class="form-field"><label class="form-label">Type</label>
          <select class="form-select" id="e-type"><option>Package</option><option>Inhouse</option></select></div>
        <div class="form-field"><label class="form-label">Status</label>
          <select class="form-select" id="e-status"><option>Active</option><option>Phase-out</option><option>To-retire</option><option>Planned</option></select></div>
        <div class="form-field"><label class="form-label">BCG Quadrant</label>
          <select class="form-select" id="e-bcg"><option>Invest</option><option>Grow</option><option>Tolerate</option><option>Retire</option></select></div>
        <div class="form-field"><label class="form-label">Criticality</label>
          <select class="form-select" id="e-criticality"><option>Mission Critical</option><option>High</option><option>Medium</option><option>Low</option></select></div>
        <div class="form-field"><label class="form-label">Health Score (0–100)</label><input class="form-input" id="e-health" type="number" min="0" max="100"></div>
        <div class="form-field"><label class="form-label">Annual TCO (K THB)</label><input class="form-input" id="e-tco" type="number"></div>
        <div class="form-field"><label class="form-label">Active Users</label><input class="form-input" id="e-users" type="number"></div>
        <div class="form-field"><label class="form-label">System Age (years)</label><input class="form-input" id="e-age" type="number"></div>
        <div class="form-field"><label class="form-label">DR Required</label>
          <select class="form-select" id="e-dr"><option value="true">Yes</option><option value="false">No</option></select></div>
        <div class="form-field full"><label class="form-label">Tech Stack (comma separated)</label><input class="form-input" id="e-stack"></div>
        <div class="form-field full"><label class="form-label">Business Capability</label><input class="form-input" id="e-capability"></div>
        <div class="form-field"><label class="form-label">Business App Owner</label><input class="form-input" id="e-bizowner" placeholder="ชื่อ Business Owner (เช่น Surachai M.)"></div>
        <div class="form-field full">
          <label class="form-label">Technology Standards Compliance</label>
          <div class="comp-chips" id="e-compliance"><!-- built by buildComplianceChips() --></div>
        </div>
      </div>
    </div>

    <!-- Tab: EA Landscape -->
    <div class="edit-tab-panel" id="tab-ea-info">
      <div class="ea-edit-hint">
        <span>🏛</span>
        <span>กำหนดตำแหน่งของแอปนี้ใน Enterprise Architecture Landscape</span>
      </div>
      <div class="form-grid">
        <div class="form-field full">
          <label class="form-label">EA Group</label>
          <select class="form-select" id="e-ea-group">
            <option value="">— เลือก EA Group —</option>
            <option>1. Direction</option>
            <option>2. Services</option>
            <option>3. Core Products</option>
            <option>4. Support</option>
            <option>5. Governance</option>
          </select>
        </div>
        <div class="form-field full">
          <label class="form-label">EA Category</label>
          <select class="form-select" id="e-ea-category">
            <option value="">— เลือก EA Group ก่อน —</option>
          </select>
        </div>
        <div class="form-field full">
          <label class="form-label">EA Sub-Category</label>
          <input class="form-input" id="e-ea-subcategory" placeholder="ระบุ Sub-Category (ถ้ามี) หรือเว้นว่างไว้เป็น —">
        </div>
      </div>

      <!-- Preview card -->
      <div id="ea-preview-card" style="margin-top:16px;display:none">
        <div class="form-label" style="margin-bottom:8px">ตำแหน่งใน EA Landscape</div>
        <div class="ea-preview-wrap">
          <div class="ea-preview-group" id="ea-prev-group"></div>
          <span style="color:var(--muted);font-size:16px">›</span>
          <div class="ea-preview-cat" id="ea-prev-cat"></div>
          <span style="color:var(--muted);font-size:16px">›</span>
          <div class="ea-preview-sub" id="ea-prev-sub"></div>
        </div>
      </div>
    </div>

    <!-- Tab: IT Ops -->
    <div class="edit-tab-panel" id="tab-ops-info">
      <div class="form-grid">
        <div class="form-field"><label class="form-label">IT App Owner</label><input class="form-input" id="e-owner"></div>
        <div class="form-field"><label class="form-label">Service Hour</label>
          <select class="form-select" id="e-service">
            <option>24x7</option><option>Business Hours</option><option>Off-Hours</option>
          </select></div>
        <div class="form-field full"><label class="form-label">Maintenance Window</label><input class="form-input" id="e-maintwindow" placeholder="Sun 02:00-06:00"></div>
        <div class="form-field"><label class="form-label">Support Type</label>
          <select class="form-select" id="e-support">
            <option>Vendor</option><option>Inhouse</option><option>Vendor+Inhouse</option>
          </select></div>
        <div class="form-field"><label class="form-label">Source Code Available</label>
          <select class="form-select" id="e-srcavail">
            <option value="true">Yes</option><option value="false">No</option>
          </select></div>
        <div class="form-field"><label class="form-label">No. of Persons Managing</label><input class="form-input" id="e-persons" type="number" min="0"></div>
        <div class="form-field"><label class="form-label">EoL Date (YYYY-MM)</label><input class="form-input" id="e-eol" placeholder="2030-06"></div>
      </div>
    </div>

    <div class="modal-actions">
      <button class="btn-cancel" id="modal-edit-cancel">ยกเลิก</button>
      <button class="btn-submit" id="modal-edit-submit">💾 บันทึกการแก้ไข</button>
    </div>
  </div>
</div>

<!-- DECOMMISSION CONFIRM MODAL -->
<div class="modal-overlay" id="modal-decomm" style="display:none">
  <div class="modal" style="width:480px">
    <div class="modal-title">
      <span>⚠️ ยืนยันการปลดระวาง</span>
      <button class="modal-close" id="modal-decomm-close">✕</button>
    </div>
    <div id="decomm-body" style="padding:8px 0">
      <!-- filled by JS -->
    </div>
    <div class="modal-actions">
      <button class="btn-cancel" id="modal-decomm-cancel">ยกเลิก</button>
      <button class="btn-submit" id="modal-decomm-confirm" style="background:var(--red);color:#fff">🔴 ยืนยัน Decommission</button>
    </div>
  </div>
</div>
<!-- ── ADD APP MODAL (5-tab) ──────────────────────────────────────────────────── -->
<style>
/* ── Add App Modal — same theme as Edit App ──────── */
#modal .add-modal{
  width:680px;max-width:96vw;max-height:88vh;
  background:var(--card2);border:1px solid var(--border2);border-radius:16px;
  padding:30px;display:flex;flex-direction:column;overflow:hidden;position:relative;
  animation:fadeIn .2s;
}
.amh{ flex-shrink:0; margin-bottom:0 }
.amh-top{ display:flex;align-items:center;justify-content:space-between;margin-bottom:18px }
.amh-left{ display:flex;align-items:center;gap:10px }
.amh-icon{ width:34px;height:34px;border-radius:9px;background:rgba(0,229,255,.1);border:1px solid rgba(0,229,255,.2);display:flex;align-items:center;justify-content:center;font-size:15px }
.amh-title{ font-size:18px;font-weight:800;color:var(--text) }
.amh-sub{ font-size:11px;color:var(--dim);margin-top:2px;font-family:var(--mono) }
.amh-x{ background:none;border:none;color:var(--dim);cursor:pointer;font-size:20px;padding:4px;line-height:1;transition:color .15s }
.amh-x:hover{ color:var(--text) }
/* progress tabs — same style as .edit-tab */
.am-tabs{ display:flex;gap:2px;border-bottom:1px solid var(--border);margin-bottom:20px;padding-bottom:0 }
.am-tab{ display:flex;align-items:center;gap:6px;padding:8px 14px;border:none;background:none;color:var(--dim);cursor:pointer;font-size:12px;font-weight:600;font-family:var(--font);border-bottom:2px solid transparent;margin-bottom:-1px;transition:all .15s;border-radius:6px 6px 0 0;flex-shrink:0 }
.am-tab:hover{ color:var(--text);background:var(--card3) }
.am-tab.am-active{ color:var(--accent);border-bottom-color:var(--accent);background:rgba(0,229,255,.05) }
[data-theme="light"] .am-tab.am-active{ color:var(--accent);border-bottom-color:var(--accent);background:rgba(0,102,204,.05) }
.am-tab.am-done{ color:var(--green);border-bottom-color:var(--green);opacity:.8 }
.am-tab.am-done:hover{ opacity:1;background:var(--card3) }
.am-tn{ width:18px;height:18px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;font-family:var(--mono);background:var(--card3);color:var(--dim);transition:all .15s;flex-shrink:0 }
.am-tab.am-active .am-tn{ background:var(--accent);color:#000 }
.am-tab.am-done .am-tn{ background:var(--green);color:#000;font-size:11px }
.am-tl{ white-space:nowrap }
.am-tsep{ display:none }
/* body */
.am-body{ flex:1;overflow-y:auto;scrollbar-width:thin;scrollbar-color:var(--border2) transparent }
.am-body::-webkit-scrollbar{ width:4px }
.am-body::-webkit-scrollbar-thumb{ background:var(--border2);border-radius:2px }
.am-sec{ display:none }.am-sec.am-on{ display:block }
/* section headings */
.am-sh{ font-size:10px;font-weight:700;letter-spacing:.8px;text-transform:uppercase;color:var(--dim);margin:18px 0 10px;padding-bottom:7px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:6px;font-family:var(--mono) }
.am-sh:first-child{ margin-top:0 }
/* form grid — reuse existing .form-grid classes */
.am-fg{ display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:4px }
.am-fg3{ grid-template-columns:1fr 1fr 1fr }
.am-full{ grid-column:1/-1 }
/* labels/inputs reuse .form-label / .form-input / .form-select */
.am-fl{ font-size:11px;color:var(--dim);font-family:var(--mono);text-transform:uppercase;letter-spacing:.3px;display:block;margin-bottom:5px }
.am-req{ color:var(--red);margin-left:2px }
.am-fi,.am-fs,.am-fta{
  background:var(--card3);border:1px solid var(--border);border-radius:8px;
  padding:9px 12px;color:var(--text);font-size:13px;font-family:var(--font);
  outline:none;transition:border-color .15s;width:100%;
}
.am-fi:focus,.am-fs:focus,.am-fta:focus{ border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,229,255,.1) }
.am-fi::placeholder{ color:var(--muted) }
.am-fs option{ background:var(--card2) }
.am-fta{ resize:vertical;min-height:72px;line-height:1.55 }
.am-iu{ position:relative }
.am-iu-unit{ position:absolute;right:10px;top:50%;transform:translateY(-50%);font-size:11px;color:var(--muted);font-family:var(--mono);pointer-events:none }
.am-iu .am-fi{ padding-right:46px }
/* toggle group */
.am-tg{ display:flex;gap:3px;background:var(--card3);border:1px solid var(--border);border-radius:8px;padding:3px }
.am-tgb{ flex:1;padding:6px 8px;border:none;border-radius:6px;background:none;color:var(--dim);font-size:12px;font-weight:600;cursor:pointer;transition:all .15s;white-space:nowrap;font-family:var(--font);line-height:1.2 }
.am-tgb.am-on{ background:var(--accent);color:#000 }
.am-tgb:not(.am-on):hover{ background:var(--border2);color:var(--text) }
/* slider */
.am-srow{ display:flex;align-items:center;gap:10px }
.am-sld{ flex:1;-webkit-appearance:none;appearance:none;height:4px;border-radius:2px;outline:none;cursor:pointer }
.am-sld::-webkit-slider-thumb{ -webkit-appearance:none;width:14px;height:14px;border-radius:50%;background:var(--accent);box-shadow:0 0 6px rgba(0,229,255,.4);cursor:pointer }
.am-sv{ width:32px;text-align:center;font-size:13px;font-weight:700;color:var(--accent);font-family:var(--mono);flex-shrink:0 }
/* chip input */
.am-cw{ background:var(--card3);border:1px solid var(--border);border-radius:8px;padding:6px 8px;display:flex;flex-wrap:wrap;gap:5px;align-items:center;min-height:40px;cursor:text;transition:border-color .15s }
.am-cw:focus-within{ border-color:var(--accent);box-shadow:0 0 0 3px rgba(0,229,255,.1) }
.am-chip{ background:rgba(0,229,255,.1);border:1px solid rgba(0,229,255,.25);color:var(--accent);font-size:11px;padding:2px 7px;border-radius:4px;display:flex;align-items:center;gap:4px;font-family:var(--mono) }
.am-chip-x{ background:none;border:none;color:var(--accent);cursor:pointer;padding:0;font-size:13px;line-height:1;opacity:.6 }
.am-chip-x:hover{ opacity:1 }
.am-chi{ background:none;border:none;outline:none;color:var(--text);font-size:13px;font-family:var(--font);flex:1;min-width:80px }
.am-ch{ font-size:10px;color:var(--muted);margin-top:3px;font-family:var(--mono) }
/* ── Compliance multi-select chips ── */
.comp-chips{display:flex;flex-wrap:wrap;gap:6px;margin-top:4px}
.comp-chip{cursor:pointer;user-select:none}
.comp-chip input[type=checkbox]{display:none}
.comp-chip span{display:inline-block;padding:4px 10px;border-radius:20px;font-size:11px;font-weight:600;border:1px solid var(--border2);color:var(--dim);background:transparent;transition:background .15s,color .15s,border-color .15s}
.comp-chip input:checked + span{background:var(--accent);color:#fff;border-color:var(--accent)}
[data-theme="light"] .comp-chip span{border-color:#d0d7de;color:#57606a}
[data-theme="light"] .comp-chip input:checked + span{color:#fff}
/* id preview */
.am-id-prev{ display:inline-flex;align-items:center;gap:6px;background:var(--card3);border:1px solid var(--border);border-radius:6px;padding:3px 10px;font-family:var(--mono);font-size:11px;color:var(--dim);margin-top:5px }
.am-id-val{ color:var(--accent);font-weight:700 }
/* wave buttons */
.am-wb-row{ display:flex;gap:6px }
.am-wb{ flex:1;padding:9px 4px;border-radius:8px;background:var(--card3);border:1px solid var(--border);color:var(--dim);font-size:11px;font-weight:700;cursor:pointer;text-align:center;transition:all .15s;font-family:var(--mono);line-height:1 }
.am-wb:hover{ border-color:var(--border2);color:var(--text) }
.am-wb.am-on{ background:rgba(0,229,255,.1);border-color:var(--accent);color:var(--accent) }
.am-wb sub{ display:block;font-size:9px;font-weight:400;margin-top:3px;opacity:.7 }
.am-wb.am-on sub{ opacity:1 }
/* EA group visual */
.am-ea-hint{ display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;margin-bottom:16px;background:rgba(123,97,255,.08);border:1px solid rgba(123,97,255,.2);font-size:12px;color:var(--dim) }
.am-ea-hint-i{ font-size:16px;flex-shrink:0 }
.am-ea-hint-t{ font-size:12px;color:var(--dim);line-height:1.5 }
.am-ea-hint-t strong{ color:var(--text) }
.am-eag-grid{ display:grid;grid-template-columns:repeat(5,1fr);gap:6px;margin-bottom:16px }
.am-eag{ border:1px solid var(--border);border-radius:9px;background:var(--card3);cursor:pointer;padding:9px 6px;text-align:center;transition:all .18s;position:relative;overflow:hidden }
.am-eag::after{ content:'';position:absolute;inset:0;background:var(--eac);opacity:0;transition:opacity .18s }
.am-eag:hover{ border-color:var(--border2) }
.am-eag:hover::after{ opacity:.06 }
.am-eag.am-on{ border-color:var(--eac)!important;box-shadow:0 0 0 1px var(--eac) }
.am-eag.am-on::after{ opacity:.1 }
.am-eag-icon{ font-size:18px;margin-bottom:2px }
.am-eag-code{ font-size:9px;font-family:var(--mono);color:var(--muted);margin-bottom:2px }
.am-eag-name{ font-size:10px;font-weight:700;color:var(--dim);line-height:1.3;transition:color .18s }
.am-eag.am-on .am-eag-name{ color:var(--text) }
.am-eag-n{ font-size:9px;color:var(--muted);margin-top:2px;font-family:var(--mono) }
.am-eac-wrap{ display:none;margin-bottom:16px }
.am-eac-wrap.am-on{ display:block }
.am-eac-list{ display:flex;flex-direction:column;gap:5px }
.am-eac{ display:flex;align-items:center;gap:10px;padding:9px 12px;border-radius:8px;background:var(--card3);border:1px solid var(--border);cursor:pointer;transition:all .15s;text-align:left;width:100% }
.am-eac:hover{ border-color:var(--border2);background:var(--card2) }
.am-eac.am-on{ border-color:var(--eac);background:color-mix(in srgb,var(--eac) 7%,var(--card3)) }
.am-eac-code{ font-size:10px;font-weight:700;font-family:var(--mono);color:var(--eac);background:color-mix(in srgb,var(--eac) 12%,transparent);border:1px solid color-mix(in srgb,var(--eac) 22%,transparent);padding:2px 7px;border-radius:5px;white-space:nowrap;flex-shrink:0 }
.am-eac-name{ font-size:13px;color:var(--dim);font-weight:500;flex:1 }
.am-eac.am-on .am-eac-name{ color:var(--text) }
.am-eac-chk{ width:16px;height:16px;border-radius:50%;border:1.5px solid var(--border2);display:flex;align-items:center;justify-content:center;font-size:9px;color:transparent;transition:all .15s;flex-shrink:0 }
.am-eac.am-on .am-eac-chk{ background:var(--eac);border-color:var(--eac);color:#000 }
.am-easub-wrap{ display:none;margin-bottom:16px }
.am-easub-wrap.am-on{ display:block }
/* EA breadcrumb preview — matches .ea-preview-wrap */
.am-ea-bc{ display:none;margin-bottom:16px }
.am-ea-bc.am-on{ display:block }
.am-ea-bc-lbl{ font-size:10px;font-weight:700;letter-spacing:.6px;text-transform:uppercase;color:var(--dim);font-family:var(--mono);margin-bottom:8px }
.am-ea-bc-row{ display:flex;align-items:center;gap:8px;flex-wrap:wrap;padding:12px 14px;background:var(--card3);border-radius:10px;border:1px solid var(--border2) }
.am-bc-seg{ display:flex;align-items:center;gap:5px }
.am-bc-dot{ width:7px;height:7px;border-radius:50%;flex-shrink:0 }
.am-bc-t{ font-size:13px;color:var(--text);font-weight:600 }
.am-bc-dim{ font-size:13px;color:var(--dim) }
.am-bc-arr{ color:var(--muted);font-size:14px;flex-shrink:0 }
.am-bc-opt{ font-size:12px;color:var(--muted);font-style:italic }
.am-hr{ border:none;border-top:1px solid var(--border);margin:6px 0 18px }
/* footer — same as .modal-actions */
.am-footer{ display:flex;align-items:center;justify-content:space-between;margin-top:22px;padding-top:18px;border-top:1px solid var(--border);flex-shrink:0 }
.am-step-info{ font-size:11px;color:var(--muted);font-family:var(--mono) }
.am-fr{ display:flex;gap:10px }
.am-btn{ padding:9px 20px;border-radius:8px;font-size:13px;font-weight:700;font-family:var(--font);border:none;cursor:pointer;transition:all .15s }
.am-btn-g{ background:none;border:1px solid var(--border);color:var(--dim) }
.am-btn-g:hover{ color:var(--text);border-color:var(--border2) }
.am-btn-s{ background:var(--card3);border:1px solid var(--border2);color:var(--text) }
.am-btn-s:hover{ border-color:var(--border2);background:var(--border) }
.am-btn-p{ background:var(--accent);color:#000;font-weight:800 }
.am-btn-p:hover{ opacity:.9;transform:translateY(-1px) }
</style>

<div class="modal-overlay" id="modal" style="display:none">
  <div class="add-modal">

    <!-- HEADER -->
    <div class="amh">
      <div class="amh-top">
        <div class="amh-left">
          <div class="amh-icon">＋</div>
          <div>
            <div class="amh-title">Add New Application</div>
            <div class="amh-sub">กรอกข้อมูลครบถ้วนเพื่อเพิ่ม Application เข้า EA Portfolio</div>
          </div>
        </div>
        <button class="amh-x" id="modal-close">✕</button>
      </div>
      <!-- TABS -->
      <div class="am-tabs">
        <div class="am-tab am-active" id="am-tab1" onclick="amGoTab(1)"><div class="am-tn">1</div><div class="am-tl">🆔 Identity</div></div>
        <div class="am-tsep"></div>
        <div class="am-tab" id="am-tab2" onclick="amGoTab(2)"><div class="am-tn">2</div><div class="am-tl">⚙️ Technical</div></div>
        <div class="am-tsep"></div>
        <div class="am-tab" id="am-tab3" onclick="amGoTab(3)"><div class="am-tn">3</div><div class="am-tl">📊 Business</div></div>
        <div class="am-tsep"></div>
        <div class="am-tab" id="am-tab4" onclick="amGoTab(4)"><div class="am-tn">4</div><div class="am-tl">🏛 EA & Planning</div></div>
        <div class="am-tsep"></div>
        <div class="am-tab" id="am-tab5" onclick="amGoTab(5)"><div class="am-tn">5</div><div class="am-tl">👤 Ownership</div></div>
      </div>
    </div>

    <!-- BODY -->
    <div class="am-body" id="am-body">

      <!-- ── TAB 1: IDENTITY ── -->
      <div class="am-sec am-on" id="am-sec1">
        <div class="am-sh">🆔 Application Identity</div>
        <div class="am-fg">
          <div class="am-full">
            <label class="am-fl">App Name <span class="am-req">*</span></label>
            <input class="am-fi" id="f-name" placeholder="เช่น SAP S/4HANA, Oracle EBS" oninput="amUpId()">
            <div class="am-id-prev">Auto ID: <span class="am-id-val" id="am-id-out">APP-???</span></div>
          </div>
          <div>
            <label class="am-fl">Vendor / ผู้พัฒนา <span class="am-req">*</span></label>
            <input class="am-fi" id="f-vendor" placeholder="เช่น SAP, Microsoft, Inhouse">
          </div>
          <div>
            <label class="am-fl">Domain</label>
            <select class="am-fs" id="f-domain">
              <option value="">— เลือก Domain —</option>
              <option>Finance</option><option>HR</option><option>Operations</option>
              <option>Customer</option><option>Supply Chain</option><option>Digital</option>
              <option>Infrastructure</option><option>Security</option><option>Analytics</option><option>CRM</option>
            </select>
          </div>
          <div>
            <label class="am-fl">App Type</label>
            <div class="am-tg" id="am-tg-type">
              <button class="am-tgb am-on" onclick="amTog('am-tg-type',this)">📦 Package</button>
              <button class="am-tgb" onclick="amTog('am-tg-type',this)">🏗 Inhouse</button>
            </div>
          </div>
          <div class="am-full">
            <label class="am-fl">Status</label>
            <div class="am-tg" id="am-tg-status">
              <button class="am-tgb am-on" onclick="amTog('am-tg-status',this)">🟢 Active</button>
              <button class="am-tgb" onclick="amTog('am-tg-status',this)">🟡 Phase-out</button>
              <button class="am-tgb" onclick="amTog('am-tg-status',this)">🔴 To-retire</button>
              <button class="am-tgb" onclick="amTog('am-tg-status',this)">🔵 Planned</button>
            </div>
          </div>
          <div>
            <label class="am-fl">Criticality</label>
            <select class="am-fs" id="f-criticality">
              <option>Mission Critical</option><option>High</option><option>Medium</option><option>Low</option>
            </select>
          </div>
          <div>
            <label class="am-fl">BCG Quadrant</label>
            <div class="am-tg" id="am-tg-bcg0">
              <button class="am-tgb am-on" onclick="amTog('am-tg-bcg0',this)">🚀 Invest</button>
              <button class="am-tgb" onclick="amTog('am-tg-bcg0',this)">🌱 Grow</button>
              <button class="am-tgb" onclick="amTog('am-tg-bcg0',this)">⚠️ Tolerate</button>
              <button class="am-tgb" onclick="amTog('am-tg-bcg0',this)">🗑 Retire</button>
            </div>
          </div>
          <div>
            <label class="am-fl">System Age (ปี)</label>
            <div class="am-iu"><input class="am-fi" id="f-age" type="number" min="0" max="50" value="2"><span class="am-iu-unit">yrs</span></div>
          </div>
          <div>
            <label class="am-fl">End of Life (EOL)</label>
            <input class="am-fi" id="f-eol" type="month" value="2030-12">
          </div>
          <div>
            <label class="am-fl">Contract End Date</label>
            <input class="am-fi" id="f-contractend" type="month" value="2027-06">
          </div>
          <div class="am-full">
            <label class="am-fl">Business Capability</label>
            <input class="am-fi" id="f-capability" placeholder="เช่น ERP Core, Customer Engagement, Analytics Platform">
          </div>
        </div>
      </div>

      <!-- ── TAB 2: TECHNICAL ── -->
      <div class="am-sec" id="am-sec2">
        <div class="am-sh">💚 Health & Stack</div>
        <div class="am-fg">
          <div class="am-full">
            <label class="am-fl">Health Score (0–100)</label>
            <div class="am-srow">
              <input type="range" class="am-sld" id="f-health" min="0" max="100" value="75"
                style="background:linear-gradient(to right,var(--accent) 75%,var(--border) 75%)"
                oninput="document.getElementById('am-sv-h').textContent=this.value;this.style.background='linear-gradient(to right,var(--accent) '+this.value+'%,var(--border) '+this.value+'%)'">
              <span class="am-sv" id="am-sv-h">75</span>
            </div>
          </div>
          <div class="am-full">
            <label class="am-fl">Tech Stack <span style="color:#374151;font-weight:400">(กด Enter หรือ comma เพื่อเพิ่ม)</span></label>
            <div class="am-cw" id="am-cw-stack" onclick="document.getElementById('am-chi-stack').focus()">
              <input class="am-chi" id="am-chi-stack" placeholder="เช่น React, Node.js, Python…" onkeydown="amChipKey(event,this,'am-cw-stack')">
            </div>
            <div class="am-ch">เช่น ABAP, SAP UI5, .NET, Kubernetes, PostgreSQL</div>
          </div>
        </div>
        <div class="am-sh">🖥 Platform & Runtime</div>
        <div class="am-fg">
          <div>
            <label class="am-fl">Programming Language</label>
            <input class="am-fi" id="f-lang" placeholder="เช่น ABAP, Java, Python, C#">
          </div>
          <div>
            <label class="am-fl">Operating System</label>
            <input class="am-fi" id="f-os" placeholder="เช่น SUSE Linux, Windows Server, SaaS">
          </div>
          <div>
            <label class="am-fl">Database</label>
            <input class="am-fi" id="f-db" placeholder="เช่น SAP HANA, Oracle, PostgreSQL">
          </div>
          <div>
            <label class="am-fl">Integration Points</label>
            <div class="am-iu"><input class="am-fi" id="f-integration" type="number" value="5" min="0"><span class="am-iu-unit">จุด</span></div>
          </div>
        </div>
        <div class="am-sh">🔒 Compliance & Operations</div>
        <div class="am-fg">
          <div>
            <label class="am-fl">DR Required</label>
            <div class="am-tg" id="am-tg-dr">
              <button class="am-tgb am-on" onclick="amTog('am-tg-dr',this)">✅ Yes</button>
              <button class="am-tgb" onclick="amTog('am-tg-dr',this)">❌ No</button>
            </div>
          </div>
          <div>
            <label class="am-fl">PI / SPI Required</label>
            <div class="am-tg" id="am-tg-pi">
              <button class="am-tgb am-on" onclick="amTog('am-tg-pi',this)">✅ Yes</button>
              <button class="am-tgb" onclick="amTog('am-tg-pi',this)">❌ No</button>
            </div>
          </div>
          <div>
            <label class="am-fl">Source Code Available</label>
            <div class="am-tg" id="am-tg-src">
              <button class="am-tgb am-on" onclick="amTog('am-tg-src',this)">✅ Yes</button>
              <button class="am-tgb" onclick="amTog('am-tg-src',this)">❌ No</button>
            </div>
          </div>
          <div>
            <label class="am-fl">Support Model</label>
            <select class="am-fs" id="f-support">
              <option>Vendor+Inhouse</option><option>Vendor</option><option>Inhouse</option><option>Outsource</option>
            </select>
          </div>
          <div>
            <label class="am-fl">Service Hour</label>
            <select class="am-fs" id="f-servicehour">
              <option>24x7</option><option>24x5</option><option>08x5</option><option>On-demand</option>
            </select>
          </div>
          <div>
            <label class="am-fl">Maintenance Window</label>
            <input class="am-fi" id="f-maintwindow" placeholder="เช่น Sun 02:00-06:00">
          </div>
        </div>
      </div>

      <!-- ── TAB 3: BUSINESS ── -->
      <div class="am-sec" id="am-sec3">
        <div class="am-sh">💰 Business Metrics</div>
        <div class="am-fg am-fg3">
          <div>
            <label class="am-fl">Annual TCO</label>
            <div class="am-iu"><input class="am-fi" id="f-tco" type="number" value="1000" placeholder="0"><span class="am-iu-unit">K฿</span></div>
          </div>
          <div>
            <label class="am-fl">Active Users</label>
            <div class="am-iu"><input class="am-fi" id="f-users" type="number" value="100"><span class="am-iu-unit">คน</span></div>
          </div>
          <div>
            <label class="am-fl">IT Persons Managing</label>
            <div class="am-iu"><input class="am-fi" id="f-persons" type="number" value="2"><span class="am-iu-unit">คน</span></div>
          </div>
        </div>
        <div class="am-sh">🎯 Strategic Position</div>
        <div class="am-fg">
          <div class="am-full">
            <label class="am-fl">Strategic Score (0–100)</label>
            <div class="am-srow">
              <input type="range" class="am-sld" id="f-strategic" min="0" max="100" value="70"
                style="background:linear-gradient(to right,var(--accent) 70%,var(--border) 70%)"
                oninput="document.getElementById('am-sv-s').textContent=this.value;this.style.background='linear-gradient(to right,var(--accent) '+this.value+'%,var(--border) '+this.value+'%)'">
              <span class="am-sv" id="am-sv-s">70</span>
            </div>
          </div>
          <div>
            <label class="am-fl">Assessment Status</label>
            <select class="am-fs" id="f-assessstatus">
              <option>Not Started</option><option>In Progress</option><option>Completed</option>
            </select>
          </div>
          <div>
            <label class="am-fl">Assessment Date</label>
            <input class="am-fi" id="f-assessdate" type="month">
          </div>
        </div>
      </div>

      <!-- ── TAB 4: EA & PLANNING ── -->
      <div class="am-sec" id="am-sec4">
        <div class="am-ea-hint">
          <span class="am-ea-hint-i">🏛</span>
          <div class="am-ea-hint-t">
            <strong>กำหนดตำแหน่งของแอปใน Enterprise Architecture Landscape</strong><br>
            เลือก <strong>EA Group → EA Category → Sub-Category (ถ้ามี)</strong>
            ข้อมูลนี้สอดคล้องกับหน้า Edit App tab "EA Landscape" และปรากฏใน EA Map ทันที
          </div>
        </div>
        <!-- ① EA GROUP -->
        <div class="am-sh"><span>①</span> EA Group</div>
        <div class="am-eag-grid" id="am-eag-grid"><!-- filled by JS --></div>
        <!-- ② EA CATEGORY -->
        <div class="am-eac-wrap" id="am-eac-wrap">
          <div class="am-sh"><span>②</span> EA Category</div>
          <div class="am-eac-list" id="am-eac-list"><!-- filled by JS --></div>
        </div>
        <!-- ③ EA SUB-CATEGORY -->
        <div class="am-easub-wrap" id="am-easub-wrap">
          <div class="am-sh"><span>③</span> EA Sub-Category <span style="font-size:10px;font-weight:400;color:#374151;text-transform:none;letter-spacing:0">(optional)</span></div>
          <input class="am-fi" id="f-easub" placeholder="เช่น Financial Reporting, Core Banking Module… (เว้นว่างได้)" oninput="amUpEAPreview()">
          <div class="am-ch" style="margin-top:5px">ใช้เมื่อต้องการระบุ module หรือส่วนย่อยเพิ่มเติมภายใน Category</div>
        </div>
        <!-- EA PREVIEW -->
        <div class="am-ea-bc" id="am-ea-bc">
          <div class="am-ea-bc-lbl">🗺 ตำแหน่งใน EA Landscape</div>
          <div class="am-ea-bc-row" id="am-ea-bc-row"></div>
        </div>
        <hr class="am-hr">
        <!-- 🌊 WAVE PLANNING -->
        <div class="am-sh">🌊 Wave Planning</div>
        <div class="am-fg">
          <div class="am-full">
            <label class="am-fl">Transformation Wave</label>
            <div class="am-wb-row">
              <button class="am-wb am-on" onclick="amSelWave(this)">Wave 1<sub>Q1–Q2 2025</sub></button>
              <button class="am-wb" onclick="amSelWave(this)">Wave 2<sub>Q3–Q4 2025</sub></button>
              <button class="am-wb" onclick="amSelWave(this)">Wave 3<sub>Q1–Q2 2026</sub></button>
              <button class="am-wb" onclick="amSelWave(this)">Wave 4<sub>Q3–Q4 2026</sub></button>
              <button class="am-wb" onclick="amSelWave(this)">Wave 5<sub>2027+</sub></button>
            </div>
          </div>
          <div>
            <label class="am-fl">Migration Approach</label>
            <select class="am-fs" id="f-approach">
              <option value="">— เลือก —</option>
              <option>Upgrade</option><option>Replace</option><option>Migrate</option>
              <option>Rewrite</option><option>Retire</option><option>Retain</option><option>Consolidate</option>
            </select>
          </div>
          <div>
            <label class="am-fl">Migration Stream</label>
            <input class="am-fi" id="f-stream" placeholder="เช่น Core Finance, Customer Experience">
          </div>
        </div>
      </div>

      <!-- ── TAB 5: OWNERSHIP ── -->
      <div class="am-sec" id="am-sec5">
        <div class="am-sh">💻 IT Ownership</div>
        <div class="am-fg">
          <div>
            <label class="am-fl">IT Application Owner</label>
            <input class="am-fi" id="f-owner" placeholder="ชื่อ IT Owner เช่น Somchai K.">
          </div>
          <div>
            <label class="am-fl">Email (IT Owner)</label>
            <input class="am-fi" id="f-owner-email" type="email" placeholder="owner@company.com">
          </div>
        </div>
        <div class="am-sh">🏢 Business Ownership</div>
        <div class="am-fg">
          <div>
            <label class="am-fl">Business App Owner</label>
            <input class="am-fi" id="f-bizowner" placeholder="เช่น Surachai M. (CFO Office)">
          </div>
          <div>
            <label class="am-fl">Department / Business Unit</label>
            <input class="am-fi" id="f-dept" placeholder="เช่น Finance, Operations, HR">
          </div>
        </div>
        <div class="am-sh">✅ Technology Standards Compliance</div>
        <div class="am-fg">
          <div class="am-full">
            <label class="am-fl">เลือก Standard ที่ App นี้ต้องปฏิบัติตาม (เลือกได้หลายรายการ)</label>
            <div class="comp-chips" id="f-compliance"><!-- built by buildComplianceChips() --></div>
          </div>
        </div>
        <div class="am-sh">📝 Description & Notes</div>
        <div class="am-fg">
          <div class="am-full">
            <label class="am-fl">Application Description</label>
            <textarea class="am-fta" id="f-desc" placeholder="อธิบายหน้าที่หลัก ขอบเขตการใช้งาน และความสำคัญต่อธุรกิจ…"></textarea>
          </div>
          <div class="am-full">
            <label class="am-fl">Additional Notes</label>
            <textarea class="am-fta" id="f-notes" placeholder="ข้อมูลเพิ่มเติม ข้อพึงระวัง หรือแผนระยะสั้น…"></textarea>
          </div>
        </div>
      </div>

    </div><!-- end .am-body -->

    <!-- FOOTER -->
    <div class="am-footer">
      <div class="am-step-info" id="am-step-info">Step 1 of 5 · Identity</div>
      <div class="am-fr">
        <button class="am-btn am-btn-s" id="am-btn-prev" onclick="amNav(-1)" style="display:none">← Back</button>
        <button class="am-btn am-btn-g" id="modal-cancel">Cancel</button>
        <button class="am-btn am-btn-s" id="am-btn-next" onclick="amNav(1)">Next →</button>
        <button class="am-btn am-btn-p" id="modal-submit" style="display:none">💾 Save Application</button>
      </div>
    </div>

  </div><!-- end .add-modal -->
</div>

<!-- ── APP QUICK VIEW MODAL ──────────────────────────────────────────────── -->
<div class="aqv-overlay" id="aqv-overlay" style="display:none">
  <div class="aqv-box" id="aqv-box">
    <div class="aqv-header" id="aqv-header">
      <div class="aqv-header-accent" id="aqv-accent"></div>
      <div class="aqv-header-main">
        <div class="aqv-app-name" id="aqv-name"></div>
        <div class="aqv-app-sub" id="aqv-sub"></div>
      </div>
      <div class="aqv-header-actions">
        <button class="aqv-insight-btn" id="aqv-insight-btn">🔬 App Insight →</button>
        <button class="aqv-close-btn" onclick="closeAppQuickView()">✕</button>
      </div>
    </div>
    <div class="aqv-body" id="aqv-body"></div>
  </div>
</div>

<script>
// ─── CONFIG (embedded — แก้ที่นี่สำหรับ Single HTML) ─────────────────────────
const APP_CONFIG = {
  version:      'V001',
  app_name:     'MPX Studio',
  subtitle:     'EA PORTFOLIO',
  organization: 'MPX',
  description:  'Enterprise Application Portfolio Management',
};
const APP_VERSION = APP_CONFIG.version;

// Apply config to UI
document.title = `${APP_CONFIG.app_name} EA Portfolio ${APP_CONFIG.version}`;
document.getElementById('app-version-sub').textContent = `${APP_CONFIG.subtitle} ${APP_CONFIG.version}`;
// Update logo title from config
(function(){
  const lt = document.querySelector('.logo-title');
  if(lt) lt.textContent = APP_CONFIG.app_name;
})();

// ─── DATA ─────────────────────────────────────────────────────────────────────
// ─── FULL STACK MODE — API CONFIG ─────────────────────────────────────────────
const API_BASE    = '';          // empty = same origin, or set e.g. 'http://localhost:8000'
const API_MODE    = true;        // true = call FastAPI backend

// In-memory cache (populated from API on load)
let apps = [];

// ── BUG-07: XSS prevention — escape HTML before injecting via innerHTML ───────
// ── Compliance Standards — แก้ที่นี่จุดเดียว ──────────────────────────────────
const COMPLIANCE_STANDARDS = {
  'ISO 27001':    'Information Security',
  'PDPA':         'Personal Data Protection',
  'DR Policy':    'Disaster Recovery',
  'API Standards':'REST/GraphQL Governance',
  'Cloud-First':  'Cloud Adoption Policy',
  'Zero-Trust':   'Identity & Access Security',
};

// ── Compliance chip helpers ────────────────────────────────────────────────────
function buildComplianceChips(containerId){
  const el = document.getElementById(containerId);
  if(!el) return;
  el.innerHTML = Object.keys(COMPLIANCE_STANDARDS).map(key=>
    `<label class="comp-chip"><input type="checkbox" value="${key}"><span>${key}</span></label>`
  ).join('');
}
function getCheckedCompliance(containerId){
  return [...document.querySelectorAll('#'+containerId+' input[type=checkbox]:checked')].map(cb=>cb.value);
}
function setCheckedCompliance(containerId, values){
  const arr = Array.isArray(values) ? values : [];
  document.querySelectorAll('#'+containerId+' input[type=checkbox]').forEach(cb=>{
    cb.checked = arr.includes(cb.value);
  });
}

function escapeHTML(str) {
  if (str == null) return '';
  return String(str)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
}

// ── Toast notification ────────────────────────────────────────────────────────
function showToast(msg, type='success'){
  const t = document.createElement('div');
  t.className = `api-toast api-toast-${type}`;
  t.textContent = msg;
  document.body.appendChild(t);
  requestAnimationFrame(()=>t.classList.add('show'));
  setTimeout(()=>{ t.classList.remove('show'); setTimeout(()=>t.remove(), 300); }, 3000);
}

// ── Loading overlay ───────────────────────────────────────────────────────────
function setLoading(on){
  let el = document.getElementById('api-loading');
  if(!el){
    el = document.createElement('div');
    el.id = 'api-loading';
    el.innerHTML = '<div class="api-spin"></div><span>กำลังโหลดข้อมูล…</span>';
    document.body.appendChild(el);
  }
  el.style.display = on ? 'flex' : 'none';
}

// ── API helpers ───────────────────────────────────────────────────────────────
async function apiGet(path){
  const r = await fetch(API_BASE + path);
  if(!r.ok) throw new Error(`GET ${path} → ${r.status}`);
  return r.json();
}

async function apiPost(path, body){
  const r = await fetch(API_BASE + path, {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify(body)
  });
  if(!r.ok){ const e=await r.json(); throw new Error(e.detail||`POST ${path} → ${r.status}`); }
  return r.json();
}

async function apiPut(path, body){
  const r = await fetch(API_BASE + path, {
    method:'PUT', headers:{'Content-Type':'application/json'},
    body: JSON.stringify(body)
  });
  if(!r.ok){ const e=await r.json(); throw new Error(e.detail||`PUT ${path} → ${r.status}`); }
  return r.json();
}

// ── Map API field names → frontend field names ─────────────────────────────
function mapApiApp(a){
  return {
    id:           a.id,
    name:         a.name,
    domain:       a.domain,
    vendor:       a.vendor,
    type:         a.type,
    status:       a.status,
    bcg:          a.bcg,
    health:       a.health,
    techDebt:     a.tech_debt,
    age:          a.age,
    tco:          a.tco,
    users:        a.users,
    criticality:  a.criticality,
    dr:           a.dr,
    eol:          a.eol,
    piSpi:        a.pi_spi,
    contractEnd:  a.contract_end,
    integration:  a.integration,
    stack:        Array.isArray(a.stack) ? a.stack : [],
    capability:   a.capability,
    strategic:    a.strategic,
    persons:      a.persons,
    srcAvail:     a.src_avail,
    serviceHour:  a.service_hour,
    maintWindow:  a.maint_window,
    lang:         a.lang,
    os:           a.os,
    db:           a.db_platform,
    support:      a.support,
    owner:        a.owner,
    bizOwner:     a.biz_owner,
    compliance:   Array.isArray(a.compliance) ? a.compliance : [],
    stream:       a.stream,
    approach:     a.approach,
    assessStatus: a.assess_status,
    assessDate:   a.assess_date,
    wave:         a.wave,
    eaGroup:      a.ea_group,
    eaCategory:   a.ea_category,
    eaSubCategory:a.ea_sub_category,
    decommissioned: a.decommissioned,
    decommDate:   a.decomm_date,
    decommReason: a.decomm_reason,
    lastUpdated:  a.last_updated,
  };
}

function mapFrontendToApi(a){
  return {
    name:           a.name,
    domain:         a.domain,
    vendor:         a.vendor,
    type:           a.type,
    status:         a.status,
    bcg:            a.bcg,
    health:         a.health,
    tech_debt:      a.techDebt,
    age:            a.age,
    tco:            a.tco,
    users:          a.users,
    criticality:    a.criticality,
    dr:             a.dr,
    eol:            a.eol,
    pi_spi:         a.piSpi,
    contract_end:   a.contractEnd,
    integration:    a.integration,
    stack:          a.stack,
    capability:     a.capability,
    strategic:      a.strategic,
    persons:        a.persons,
    src_avail:      a.srcAvail,
    service_hour:   a.serviceHour,
    maint_window:   a.maintWindow,
    lang:           a.lang,
    os:             a.os,
    db_platform:    a.db,
    support:        a.support,
    owner:          a.owner,
    compliance:     a.compliance || [],
    stream:         a.stream,
    approach:       a.approach,
    assess_status:  a.assessStatus,
    assess_date:    a.assessDate,
    wave:           a.wave,
    ea_group:       a.eaGroup,
    ea_category:    a.eaCategory,
    ea_sub_category:a.eaSubCategory,
  };
}

// ── Load all apps from API ─────────────────────────────────────────────────────
async function loadAppsFromAPI(showDecomm=false){
  setLoading(true);
  try {
    const raw = await apiGet(`/api/apps?show_decomm=${showDecomm}`);
    apps = raw.map(mapApiApp);
    // Patch EA sub cat default
    apps.forEach(a=>{ if(!a.eaSubCategory) a.eaSubCategory='-'; });
    // Update version + branding from API config
    try {
      const cfg = await apiGet('/api/version');
      document.title = cfg.page_title || cfg.title || 'MPX AppPort';
      const sub = document.getElementById('app-version-sub');
      if(sub) sub.textContent = cfg.logo_sub || `EA PORTFOLIO ${cfg.version}`;
      const lt = document.querySelector('.logo-title');
      if(lt && cfg.app_name) lt.textContent = cfg.app_name;
    } catch(e){}
    return apps;
  } catch(e){
    showToast('❌ ไม่สามารถเชื่อมต่อ API ได้: '+e.message, 'error');
    throw e;
  } finally {
    setLoading(false);
  }
}

// ── Override: refresh helper used after mutations ─────────────────────────────
async function refreshAndRender(){
  await loadAppsFromAPI(document.getElementById('inv-show-decomm')?.checked||false);
  const activeView = document.querySelector('.view.active')?.id?.replace('view-','');
  if(activeView) renderView(activeView);
  const sbCount = document.getElementById('sb-app-count');
  if(sbCount) sbCount.textContent = `${apps.filter(a=>!a.decommissioned).length} Apps · ${[...new Set(apps.map(a=>a.domain))].length} Domains`;
}



// ─── EA STRUCTURE ─────────────────────────────────────────────────────────────
const EA_STRUCTURE = [
  { group:'1. Direction', color:'#7b61ff', bgColor:'rgba(123,97,255,.12)',
    categories:[
      {code:'1.1', name:'BOD'},
      {code:'1.2', name:'Vision, Mission, Strategies'},
      {code:'1.3', name:'Goals, Objectives'},
      {code:'1.4', name:'Governance Body'},
      {code:'1.5', name:'Standard & Policies'},
      {code:'1.6', name:'Business Process & Services'},
    ]},
  { group:'2. Services', color:'#00e5ff', bgColor:'rgba(0,229,255,.1)',
    categories:[
      {code:'2.1', name:'Customer'},
      {code:'2.2', name:'Partner'},
      {code:'2.3', name:'Service'},
      {code:'2.4', name:'Employee'},
      {code:'2.6', name:'Channel'},
      {code:'2.7', name:'Portal & Gateway'},
    ]},
  { group:'3. Core Products', color:'#00d68f', bgColor:'rgba(0,214,143,.1)',
    categories:[
      {code:'3.1', name:'Organization'},
      {code:'3.2', name:'Corporate & Core System'},
      {code:'3.3', name:'Back Office & Support System'},
    ]},
  { group:'4. Support', color:'#ff9f43', bgColor:'rgba(255,159,67,.1)',
    categories:[
      {code:'4.1', name:'Training & Communication'},
      {code:'4.2', name:'Corporate Information'},
      {code:'4.3', name:'Corporate Application & Information Technology'},
    ]},
  { group:'5. Governance', color:'#ff4757', bgColor:'rgba(255,71,87,.1)',
    categories:[
      {code:'5.1', name:'Corporate Security & Policy'},
      {code:'5.2', name:'Risk & Internal Control'},
      {code:'5.3', name:'Law & Compliance'},
    ]},
];

// EA mapping: appId -> {eaGroup, eaCategory}
const EA_MAP = {
  'APP-001':['3. Core Products','3.2 Corporate & Core System'],
  'APP-002':['2. Services','2.1 Customer'],
  'APP-003':['3. Core Products','3.2 Corporate & Core System'],
  'APP-004':['3. Core Products','3.3 Back Office & Support System'],
  'APP-005':['4. Support','4.2 Corporate Information'],
  'APP-006':['3. Core Products','3.2 Corporate & Core System'],
  'APP-007':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-008':['4. Support','4.2 Corporate Information'],
  'APP-009':['3. Core Products','3.2 Corporate & Core System'],
  'APP-010':['2. Services','2.7 Portal & Gateway'],
  'APP-011':['2. Services','2.1 Customer'],
  'APP-012':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-013':['4. Support','4.2 Corporate Information'],
  'APP-014':['3. Core Products','3.2 Corporate & Core System'],
  'APP-015':['3. Core Products','3.2 Corporate & Core System'],
  'APP-016':['2. Services','2.1 Customer'],
  'APP-017':['3. Core Products','3.3 Back Office & Support System'],
  'APP-018':['3. Core Products','3.3 Back Office & Support System'],
  'APP-019':['2. Services','2.6 Channel'],
  'APP-020':['3. Core Products','3.2 Corporate & Core System'],
  'APP-021':['2. Services','2.3 Service'],
  'APP-022':['1. Direction','1.5 Standard & Policies'],
  'APP-023':['3. Core Products','3.3 Back Office & Support System'],
  'APP-024':['2. Services','2.4 Employee'],
  'APP-025':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-026':['3. Core Products','3.2 Corporate & Core System'],
  'APP-027':['2. Services','2.2 Partner'],
  'APP-028':['3. Core Products','3.3 Back Office & Support System'],
  'APP-029':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-030':['2. Services','2.7 Portal & Gateway'],
  'APP-031':['3. Core Products','3.2 Corporate & Core System'],
  'APP-032':['4. Support','4.2 Corporate Information'],
  'APP-033':['1. Direction','1.6 Business Process & Services'],
  'APP-034':['3. Core Products','3.3 Back Office & Support System'],
  'APP-035':['2. Services','2.3 Service'],
  'APP-036':['4. Support','4.1 Training & Communication'],
  'APP-037':['3. Core Products','3.2 Corporate & Core System'],
  'APP-038':['5. Governance','5.2 Risk & Internal Control'],
  'APP-039':['2. Services','2.4 Employee'],
  'APP-040':['3. Core Products','3.3 Back Office & Support System'],
  'APP-041':['2. Services','2.1 Customer'],
  'APP-042':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-043':['3. Core Products','3.2 Corporate & Core System'],
  'APP-044':['5. Governance','5.1 Corporate Security & Policy'],
  'APP-045':['2. Services','2.6 Channel'],
  'APP-046':['4. Support','4.2 Corporate Information'],
  'APP-047':['3. Core Products','3.3 Back Office & Support System'],
  'APP-048':['1. Direction','1.4 Governance Body'],
  'APP-049':['2. Services','2.7 Portal & Gateway'],
  'APP-050':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-051':['3. Core Products','3.3 Back Office & Support System'],
  'APP-052':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-053':['3. Core Products','3.3 Back Office & Support System'],
  'APP-054':['4. Support','4.2 Corporate Information'],
  'APP-055':['1. Direction','1.6 Business Process & Services'],
  'APP-056':['3. Core Products','3.2 Corporate & Core System'],
  'APP-057':['5. Governance','5.1 Corporate Security & Policy'],
  'APP-058':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-059':['3. Core Products','3.2 Corporate & Core System'],
  'APP-060':['2. Services','2.7 Portal & Gateway'],
  'APP-061':['3. Core Products','3.3 Back Office & Support System'],
  'APP-062':['3. Core Products','3.3 Back Office & Support System'],
  'APP-063':['3. Core Products','3.2 Corporate & Core System'],
  'APP-064':['5. Governance','5.2 Risk & Internal Control'],
  'APP-065':['5. Governance','5.1 Corporate Security & Policy'],
  'APP-066':['4. Support','4.2 Corporate Information'],
  'APP-067':['3. Core Products','3.3 Back Office & Support System'],
  'APP-068':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-069':['4. Support','4.1 Training & Communication'],
  'APP-070':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-071':['5. Governance','5.3 Law & Compliance'],
  'APP-072':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-073':['3. Core Products','3.2 Corporate & Core System'],
  'APP-074':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-075':['3. Core Products','3.2 Corporate & Core System'],
  'APP-076':['3. Core Products','3.3 Back Office & Support System'],
  'APP-077':['2. Services','2.1 Customer'],
  'APP-078':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-079':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-080':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-081':['5. Governance','5.3 Law & Compliance'],
  'APP-082':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-083':['3. Core Products','3.2 Corporate & Core System'],
  'APP-084':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-085':['2. Services','2.1 Customer'],
  'APP-086':['3. Core Products','3.3 Back Office & Support System'],
  'APP-087':['2. Services','2.1 Customer'],
  'APP-088':['5. Governance','5.2 Risk & Internal Control'],
  'APP-089':['3. Core Products','3.2 Corporate & Core System'],
  'APP-090':['5. Governance','5.1 Corporate Security & Policy'],
  'APP-091':['1. Direction','1.6 Business Process & Services'],
  'APP-092':['4. Support','4.2 Corporate Information'],
  'APP-093':['3. Core Products','3.2 Corporate & Core System'],
  'APP-094':['2. Services','2.2 Partner'],
  'APP-095':['3. Core Products','3.3 Back Office & Support System'],
  'APP-096':['4. Support','4.2 Corporate Information'],
  'APP-097':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-098':['4. Support','4.3 Corporate Application & Information Technology'],
  'APP-099':['5. Governance','5.2 Risk & Internal Control'],
  'APP-100':['4. Support','4.2 Corporate Information'],
};

// Inject EA fields into all apps
apps.forEach(a => {
  const m = EA_MAP[a.id];
  a.eaGroup       = m ? m[0] : '3. Core Products';
  a.eaCategory    = m ? m[1] : '3.2 Corporate & Core System';
  a.eaSubCategory = '-';
});

// ─── HELPERS ──────────────────────────────────────────────────────────────────
const hc = s => s>=80?'var(--green)':s>=60?'var(--yellow)':'var(--red)';
const bcgColor = {Invest:'var(--invest)',Grow:'var(--blue)',Tolerate:'var(--tolerate)',Retire:'var(--retire)'};
const statusColor = {Active:'var(--green)',"Phase-out":'var(--yellow)',"To-retire":'var(--red)',Planned:'var(--accent)'};
const getDomains = () => [...new Set(apps.map(a=>a.domain))].sort();

const badge = (l,c) => `<span class="badge" style="background:${c}22;color:${c};border:1px solid ${c}44">${l}</span>`;
const hbar = (v,w=80) => `<div class="hbar-wrap" style="width:${typeof w==='number'?w+'px':w};height:6px"><div class="hbar-fill" style="width:${v}%;background:${hc(v)}"></div></div>`;
const fmt = n => n>=1000000?`฿${(n/1000000).toFixed(1)}M`:n>=1000?`฿${(n/1000).toFixed(1)}K`:`฿${n}`;

const getTheme = () => document.documentElement.getAttribute('data-theme');
const isDark = () => getTheme()==='dark';

const chartOpts = () => ({
  color: isDark()?'#6b84a0':'#5872a0',
  plugins:{
    legend:{labels:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:11}}},
    tooltip:{
      backgroundColor:isDark()?'#0f1c2e':'#ffffff',
      borderColor:isDark()?'#1a2d47':'#d4dff0',borderWidth:1,
      titleColor:isDark()?'#dde6f0':'#1a2540',bodyColor:isDark()?'#6b84a0':'#5872a0',
      titleFont:{family:'Syne',weight:'700'},bodyFont:{family:'JetBrains Mono',size:11},padding:10
    }
  },
  scales:{
    x:{ticks:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:10}},grid:{color:isDark()?'rgba(26,45,71,.5)':'rgba(180,200,230,.4)'}},
    y:{ticks:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:10}},grid:{color:isDark()?'rgba(26,45,71,.5)':'rgba(180,200,230,.4)'}}
  }
});

let charts = {};
const destroyChart = id => { if(charts[id]){charts[id].destroy();delete charts[id];} };

// ─── THEME ─────────────────────────────────────────────────────────────────────
let systemDarkMQ = window.matchMedia('(prefers-color-scheme: dark)');
let themeMode = 'auto';

function applyTheme(){
  const t = themeMode==='auto' ? (systemDarkMQ.matches?'dark':'light') : themeMode;
  document.documentElement.setAttribute('data-theme', t);
  const activeView = document.querySelector('.view.active')?.id?.replace('view-','');
  if(activeView) renderView(activeView);
}

document.getElementById('theme-dark').onclick=()=>{themeMode='dark';updateThemeBtns();applyTheme()};
document.getElementById('theme-light').onclick=()=>{themeMode='light';updateThemeBtns();applyTheme()};
document.getElementById('theme-auto').onclick=()=>{themeMode='auto';updateThemeBtns();applyTheme()};
systemDarkMQ.addEventListener('change',()=>{ if(themeMode==='auto') applyTheme(); });

function updateThemeBtns(){
  ['dark','light','auto'].forEach(t=>{
    document.getElementById('theme-'+t).classList.toggle('active', themeMode===t);
  });
}

// ─── SIDEBAR ──────────────────────────────────────────────────────────────────
const sidebar = document.getElementById('sidebar');
const appShell = document.getElementById('app-shell');
let sidebarCollapsed = false;

document.getElementById('sidebar-toggle').onclick = () => {
  sidebarCollapsed = !sidebarCollapsed;
  sidebar.classList.toggle('collapsed', sidebarCollapsed);
  appShell.classList.toggle('sidebar-collapsed', sidebarCollapsed);
  // Mobile: toggle mobile-open instead
  if(window.innerWidth <= 900){
    sidebarCollapsed = false;
    sidebar.classList.remove('collapsed');
    appShell.classList.remove('sidebar-collapsed');
    sidebar.classList.toggle('mobile-open');
  }
};

// Close sidebar on mobile when clicking content
document.getElementById('content-area').addEventListener('click', () => {
  if(window.innerWidth <= 900) sidebar.classList.remove('mobile-open');
});

// ─── NAVIGATION ───────────────────────────────────────────────────────────────
const VIEW_META = {
  'dashboard':     {label:'Dashboard',        group:'Overview',          icon:'⬡'},
  'portfolio':     {label:'Application Portfolio',         group:'Overview',          icon:'▣'},
  'roadmap':       {label:'Roadmap',           group:'Planning',          icon:'→'},
  'lifecycle':     {label:'Lifecycle',         group:'Planning',          icon:'◷'},
  'techdebt':      {label:'Tech Debt',         group:'Architecture',      icon:'⚠'},
  'capability':    {label:'Capability Map',    group:'Architecture',      icon:'⊞'},
  'standards':     {label:'Standards',         group:'Architecture',      icon:'✓'},
  'financial':     {label:'Financial Analytics',group:'Business Analytics',         icon:'฿'},
  'executive':     {label:'Executive View',    group:'Business Analytics',          icon:'★'},
  'ops-risk':      {label:'Operational Risk',  group:'Technical Analytics',     icon:'🛡'},
  'ops-release':   {label:'Release Planning',  group:'Technical Analytics',     icon:'📅'},
  'ops-platform':  {label:'Platform Health',   group:'Technical Analytics',     icon:'🖥'},
  'ops-support':   {label:'Support Model',     group:'Technical Analytics',     icon:'🎧'},
  'ppm-wave':      {label:'Wave Planning',     group:'Project Portfolio', icon:'🌊'},
  'ppm-dependency':{label:'Dependency Map',    group:'Project Portfolio', icon:'🔗'},
  'ppm-resource':  {label:'Resource & Complexity',group:'Project Portfolio',icon:'👥'},
  'ppm-assessment':{label:'Assessment Tracking',group:'Project Portfolio',icon:'📝'},
  'inventory':     {label:'App Inventory',       group:'Overview',          icon:'📋'},
  'ea-landscape':  {label:'EA Landscape',         group:'Architecture',      icon:'🏛'},
  'mpx2':          {label:'MPX EA Blueprint',       group:'Architecture',      icon:'🗺'},
  'app-insight':   {label:'App Insight',           group:'Overview',          icon:'🔬'},
  'settings-import-export': {label:'Import / Export', group:'Settings',       icon:'⇅'},
  'asset-inventory': {label:'Asset Inventory',    group:'Asset Management',  icon:'🖥'},
  'asset-hardware':  {label:'Hardware',            group:'Asset Management',  icon:'⚙'},
  'asset-security':  {label:'Security Equipment',  group:'Asset Management',  icon:'🛡'},
  'asset-network':   {label:'Network Equipment',   group:'Asset Management',  icon:'🌐'},
  'asset-endpoint':  {label:'Endpoint Security',   group:'Asset Management',  icon:'💻'},
  'asset-analytics': {label:'Asset Analytics',     group:'Asset Analytics',   icon:'📊'},
};

function navigate(v){
  // Update views
  document.querySelectorAll('.view').forEach(el=>el.classList.remove('active'));
  const el = document.getElementById('view-'+v);
  if(el) el.classList.add('active');

  // Update sidebar items
  document.querySelectorAll('.sb-item').forEach(b=>b.classList.remove('active'));
  const btn = document.querySelector(`.sb-item[data-view="${v}"]`);
  if(btn) btn.classList.add('active');

  // Update breadcrumb
  const meta = VIEW_META[v]||{};
  const bc = document.getElementById('topbar-breadcrumb');
  if(bc) bc.innerHTML = `<span>${meta.group||'Portfolio'}</span><span class="bc-sep">/</span><span class="bc-current">${meta.label||v}</span>`;

  // Update page header if present
  const ph = document.getElementById('page-header-'+v);

  renderView(v);

  // Scroll to top on navigate
  if(v.startsWith('asset-') || v==='app-insight'){
    const main = document.getElementById('main');
    if(main) main.scrollTo({top:0,behavior:'smooth'});
  }

  // Close mobile sidebar
  if(window.innerWidth<=900) sidebar.classList.remove('mobile-open');
}

document.querySelectorAll('.sb-item[data-view]').forEach(btn => {
  btn.addEventListener('click', () => navigate(btn.dataset.view));
});

// ─── SIDEBAR TOOLTIP ────────────────────────────────────────────────────────
(function(){
  const popup = document.getElementById('sb-tooltip-popup');
  const titleEl = document.getElementById('sb-tooltip-title');
  const descEl = document.getElementById('sb-tooltip-desc');
  let hideTimer = null;

  document.querySelectorAll('.sb-item[data-view]').forEach(btn => {
    btn.addEventListener('mouseenter', e => {
      clearTimeout(hideTimer);
      const label = btn.dataset.label || btn.dataset.tooltip || '';
      const desc  = btn.dataset.desc || '';
      if (!label && !desc) return;

      titleEl.textContent = label;
      descEl.textContent  = desc;

      const rect = btn.getBoundingClientRect();
      const sidebar = document.getElementById('sidebar');
      const sbRect  = sidebar.getBoundingClientRect();

      popup.style.left = (sbRect.right + 10) + 'px';
      popup.style.top  = Math.max(8, rect.top + rect.height/2 - 30) + 'px';
      popup.classList.add('visible');
    });

    btn.addEventListener('mouseleave', () => {
      hideTimer = setTimeout(() => popup.classList.remove('visible'), 80);
    });
  });

  popup.addEventListener('mouseenter', () => clearTimeout(hideTimer));
  popup.addEventListener('mouseleave', () => popup.classList.remove('visible'));
})();

// ─── VIEWS ─────────────────────────────────────────────────────────────────────

function renderView(v){
  const map = {
    dashboard:renderDashboard, portfolio:renderPortfolio, roadmap:renderRoadmap,
    lifecycle:renderLifecycle, techdebt:renderTechDebt, capability:renderCapability,
    standards:renderStandards, financial:renderFinancial, executive:renderExecutive,
    'ops-risk':renderOpsRisk, 'ops-release':renderOpsRelease, 'ops-platform':renderOpsPlatform,
    'ops-support':renderOpsSupport, 'ppm-wave':renderPPMWave, 'ppm-dependency':renderPPMDependency,
    'ppm-resource':renderPPMResource, 'ppm-assessment':renderPPMAssessment,
    'inventory':renderInventory,
    'ea-landscape':renderEALandscape,
    'mpx2':renderMPX2,
    'app-insight':renderAppInsight,
    'settings-import-export':renderSettingsImportExport,
    'asset-inventory':renderAssetInventory,
    'asset-hardware':renderAssetHardware,
    'asset-security':renderAssetSecurity,
    'asset-network':renderAssetNetwork,
    'asset-endpoint':renderAssetEndpoint,
    'asset-analytics':renderAssetAnalytics
  };
  map[v]?.();
  // Re-wire expand buttons after render (charts may have been re-created)
  setTimeout(_wireExpandButtons, 80);
}

// ─── DASHBOARD ────────────────────────────────────────────────────────────────
function renderDashboard(){
  const total=apps.length,active=apps.filter(a=>a.status==='Active').length;
  const retire=apps.filter(a=>['To-retire','Phase-out'].includes(a.status)).length;
  const avgH=Math.round(apps.reduce((s,a)=>s+a.health,0)/apps.length);
  const totalTco=apps.reduce((s,a)=>s+a.tco,0);
  const mc=apps.filter(a=>a.criticality==='Mission Critical').length;
  const noDr=apps.filter(a=>a.criticality==='Mission Critical'&&!a.dr).length;
  const retireSave=apps.filter(a=>['To-retire','Phase-out'].includes(a.status)).reduce((s,a)=>s+a.tco,0);
  document.getElementById('dash-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--accent)"><div class="kpi-label">Total Applications</div><div class="kpi-value">${total}</div><div class="kpi-sub">${active} Active · ${retire} Retiring</div></div>
    <div class="kpi" style="--kpi-color:${hc(avgH)}"><div class="kpi-label">Avg Health Score</div><div class="kpi-value">${avgH}</div><div class="kpi-sub">Portfolio health index</div></div>
    <div class="kpi" style="--kpi-color:var(--accent3)"><div class="kpi-label">Total TCO / Year</div><div class="kpi-value">${fmt(totalTco*1000)}</div><div class="kpi-sub">All ${total} applications</div></div>
    <div class="kpi" style="--kpi-color:var(--green)"><div class="kpi-label">Retirement Savings</div><div class="kpi-value">${fmt(retireSave*1000)}</div><div class="kpi-sub">If retire phase-out apps</div></div>
    <div class="kpi" style="--kpi-color:var(--accent2)"><div class="kpi-label">Mission Critical</div><div class="kpi-value">${mc}</div><div class="kpi-sub" style="color:${noDr>0?'var(--red)':'var(--dim)'}">${noDr} without DR!</div></div>
  `;
  const bcgG={Invest:[],Grow:[],Tolerate:[],Retire:[]};
  apps.forEach(a=>bcgG[a.bcg]&&bcgG[a.bcg].push(a));
  document.getElementById('bcg-grid').innerHTML=Object.entries(bcgG).map(([q,list])=>`
    <div class="bcg-quad" style="background:${bcgColor[q]}11;border:1px solid ${bcgColor[q]}33">
      <div class="bcg-quad-title" style="color:${bcgColor[q]}">▲ ${q} (${list.length})</div>
      <div style="overflow-y:auto;max-height:200px">${list.map(a=>`
        <div class="bcg-item"><span class="bcg-item-name">${a.name}</span>${hbar(a.health,50)}</div>`).join('')}
      </div></div>`).join('');
  const bins=[0,0,0,0,0];
  apps.forEach(a=>{ if(a.health<=20)bins[0]++;else if(a.health<=40)bins[1]++;else if(a.health<=60)bins[2]++;else if(a.health<=80)bins[3]++;else bins[4]++; });
  destroyChart('hd');
  charts.hd=new Chart(document.getElementById('chart-health-dist'),{
    type:'bar',
    data:{labels:['0–20','21–40','41–60','61–80','81–100'],datasets:[{data:bins,backgroundColor:['#ff475788','#f9731688','#ffa00088','#4a9eff88','#00d68f88'],borderRadius:4}]},
    options:{...chartOpts(),responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip},scales:{x:chartOpts().scales.x,y:{...chartOpts().scales.y,beginAtZero:true}}}
  });
  const td={};apps.forEach(a=>td[a.domain]=(td[a.domain]||0)+a.tco);
  const tds=Object.entries(td).sort((a,b)=>b[1]-a[1]).slice(0,6);
  destroyChart('tcoD');
  charts.tcoD=new Chart(document.getElementById('chart-tco-domain'),{
    type:'bar',
    data:{labels:tds.map(e=>e[0]),datasets:[{data:tds.map(e=>e[1]),backgroundColor:isDark()?'#00e5ff55':'#0066cc44',borderColor:'var(--accent)',borderWidth:1,borderRadius:4}]},
    options:{...chartOpts(),indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{...chartOpts().plugins.tooltip,callbacks:{label:c=>`฿${c.raw.toLocaleString()}K`}}}}
  });
  const mCrit=apps.filter(a=>a.criticality==='Mission Critical').sort((a,b)=>a.health-b.health);
  document.getElementById('tbl-risk').innerHTML=`<thead><tr><th>Application</th><th>Health</th><th>DR</th><th>Age</th><th>Status</th><th>Risk</th></tr></thead>
    <tbody>${mCrit.map(a=>{const risk=a.health<50?'CRITICAL':(!a.dr&&a.health<75)?'HIGH':a.health<70?'MEDIUM':'LOW';const rc={CRITICAL:'var(--red)',HIGH:'#f97316',MEDIUM:'var(--yellow)',LOW:'var(--green)'}[risk];
    return`<tr style="${risk==='CRITICAL'?'background:rgba(255,71,87,.05)':''}"><td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td>
    <td><div style="display:flex;align-items:center;gap:8px">${hbar(a.health,70)}<span style="color:${hc(a.health)};font-weight:700;font-family:var(--mono)">${a.health}</span></div></td>
    <td style="font-size:16px;text-align:center;color:${a.dr?'var(--green)':'var(--red)'}">${a.dr?'✓':'✗'}</td>
    <td style="color:${a.age>10?'var(--red)':'var(--dim)'};font-family:var(--mono)">${a.age}y</td>
    <td>${badge(a.status,statusColor[a.status]||'var(--muted)')}</td>
    <td>${badge(risk,rc)}</td></tr>`;}).join('')}</tbody>`;
  // Asset summary section
  renderDashboardAsset();
}

// ── DASHBOARD: Asset Summary Section ──────────────────────────────────────────
function renderDashboardAsset(){
  if(typeof assetData==='undefined'||!assetData.length) return;

  // ── helpers ──
  const now=new Date();
  const in12mo=new Date(now);in12mo.setMonth(in12mo.getMonth()+12);
  function normDate(d){
    if(!d||d==='—')return null;
    // year-only '2025' -> treat as Dec 31 of that year
    if(/^\d{4}$/.test(String(d))) return new Date(String(d)+'-12-31');
    return new Date(d);
  }
  function expColor(d){
    if(!d||d==='—')return'var(--dim)';
    const dt=normDate(d);if(!dt)return'var(--dim)';
    if(dt<now)return'var(--red)';
    if(dt<in12mo)return'#f07840';
    const m=(dt-now)/2592000000;
    if(m<18)return'var(--yellow)';
    return'var(--green)';
  }
  function expLabel(d){
    if(!d||d==='—')return'—';
    const dt=normDate(d);if(!dt)return String(d);
    if(dt<now)return'EXPIRED ⚠';
    const m=Math.round((dt-now)/2592000000);
    if(m<2)return`${m}mo left`;
    if(m<13)return`${m}mo left`;
    return String(d).slice(0,7);
  }
  function yrsLeft(d){
    if(!d)return null;
    const dt=new Date(d);
    return Math.round((dt-now)/31536000000*10)/10;
  }

  const hw=assetData.filter(a=>a.assetType==='hardware');
  const sec=assetData.filter(a=>a.assetType==='security');
  const net=assetData.filter(a=>a.assetType==='network');
  const ep=assetData.filter(a=>a.assetType==='endpoint');
  const avg=arr=>arr.length?Math.round(arr.reduce((s,a)=>s+a.health,0)/arr.length):0;

  // Expiring assets (warranty or license within 12mo or expired)
  const expiring=assetData.filter(a=>{
    const wd=normDate(a.warrantyExpiry);
    const ld=normDate(a.licenseExpiry);
    return(wd&&wd<in12mo)||(ld&&ld<in12mo);
  }).sort((a,b)=>{
    const da=normDate(a.warrantyExpiry||a.licenseExpiry);
    const db=normDate(b.warrantyExpiry||b.licenseExpiry);
    return(da||new Date('9999'))-( db||new Date('9999'));
  });

  // Endpoint coverage
  const epDep=ep.reduce((s,a)=>s+(a.deployedCount||0),0);
  const epTotal=ep.reduce((s,a)=>s+(a.licenseCount||0),0);
  const epPct=epTotal?Math.round(epDep/epTotal*100):0;

  // ── 1. Asset KPIs ──
  const totalAssets=assetData.length;
  const avgHealth=avg(assetData);
  const expiringCount=expiring.length;
  const hwWithIssue=assetData.filter(a=>a.health<60).length;
  document.getElementById('dash-asset-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:#f07840;cursor:pointer" onclick="navigate('asset-inventory')">
      <div style="position:absolute;top:11px;right:11px;font-size:9px;font-family:var(--mono);font-weight:600;padding:2px 7px;border-radius:3px;background:#f0784018;color:#f07840">${hwWithIssue>0?`⚠ ${hwWithIssue} ต่ำกว่า 60`:'✓ ปกติ'}</div>
      <div class="kpi-label">Total IT Assets</div>
      <div class="kpi-value">${totalAssets}</div>
      <div class="kpi-sub">HW · SEC · NET · EP</div>
    </div>
    <div class="kpi" style="--kpi-color:${expiringCount>0?'var(--red)':'var(--green)'};cursor:pointer" onclick="navigate('asset-analytics')">
      <div style="position:absolute;top:11px;right:11px;font-size:9px;font-family:var(--mono);font-weight:600;padding:2px 7px;border-radius:3px;background:${expiringCount>0?'rgba(224,80,96,.1)':'rgba(40,217,138,.1)'};color:${expiringCount>0?'var(--red)':'var(--green)'}">${expiringCount>0?'ต้องดำเนินการ':'ปกติ'}</div>
      <div class="kpi-label">Expiring ≤ 12 months</div>
      <div class="kpi-value">${expiringCount}</div>
      <div class="kpi-sub">Warranty · License</div>
    </div>
    <div class="kpi" style="--kpi-color:${hc(avgHealth)};cursor:pointer" onclick="navigate('asset-analytics')">
      <div style="position:absolute;top:11px;right:11px;font-size:9px;font-family:var(--mono);font-weight:600;padding:2px 7px;border-radius:3px;background:${avgHealth>=80?'rgba(40,217,138,.1)':avgHealth>=60?'rgba(240,192,64,.1)':'rgba(224,80,96,.1)'};color:${hc(avgHealth)}">${avgHealth>=80?'ปกติ':avgHealth>=60?'ควรติดตาม':'ต่ำ'}</div>
      <div class="kpi-label">Avg Asset Health</div>
      <div class="kpi-value">${avgHealth}</div>
      <div class="kpi-sub">Across all asset types</div>
    </div>
    <div class="kpi" style="--kpi-color:${epPct>=90?'var(--green)':epPct>=75?'var(--yellow)':'var(--red)'};cursor:pointer" onclick="navigate('asset-endpoint')">
      <div style="position:absolute;top:11px;right:11px;font-size:9px;font-family:var(--mono);font-weight:600;padding:2px 7px;border-radius:3px;background:${epPct>=90?'rgba(40,217,138,.1)':'rgba(240,192,64,.1)'};color:${epPct>=90?'var(--green)':'var(--yellow)'}">${epPct}%</div>
      <div class="kpi-label">Endpoint Coverage</div>
      <div class="kpi-value">${epDep.toLocaleString()}</div>
      <div class="kpi-sub">/ ${epTotal.toLocaleString()} endpoints</div>
    </div>`;

  // ── 2a. Health tiles ──
  const types=[
    {key:'hardware',label:'Hardware',data:hw,color:'#f07840',nav:'asset-hardware'},
    {key:'security',label:'Security',data:sec,color:'#28ccd9',nav:'asset-security'},
    {key:'network',label:'Network', data:net,color:'#28d98a',nav:'asset-network'},
    {key:'endpoint',label:'Endpoint',data:ep, color:'#9b6ef0',nav:'asset-endpoint'},
  ];
  document.getElementById('dash-asset-health-tiles').innerHTML=types.map(t=>{
    const sc=avg(t.data);
    const warn=t.data.filter(a=>a.health<60);
    const warnTxt=warn.length?`<div class="dash-ht-warn" style="color:var(--red)">⚠ ${warn.length} ต่ำกว่า 60</div>`
      :`<div class="dash-ht-warn" style="color:var(--dim)">✓ ปกติ</div>`;
    return`<div class="dash-ht" onclick="navigate('${t.nav}')">
      <div class="dash-ht-type">${t.label}</div>
      <div class="dash-ht-score" style="color:${t.color}">${sc}</div>
      <div class="dash-ht-bar"><div class="dash-ht-fill" style="width:${sc}%;background:${t.color}"></div></div>
      <div class="dash-ht-count">${t.data.length} assets</div>
      ${warnTxt}
    </div>`;
  }).join('');

  // ── 2b. Expiry list ──
  const topExp=expiring.slice(0,5);
  document.getElementById('dash-asset-expiry').innerHTML=topExp.length
    ?topExp.map(a=>{
      const d=a.warrantyExpiry||a.licenseExpiry;
      const dt=normDate(d);
      const isExp=dt&&dt<now;
      const isWarn=dt&&dt<in12mo&&!isExp;
      const col=isExp?'var(--red)':isWarn?'#f07840':'var(--yellow)';
      const lbl=expLabel(d);
      const typeLbl={hardware:'HW',security:'SEC',network:'NET',endpoint:'EP'}[a.assetType]||(a.assetType||'').toUpperCase();
      const navTarget={hardware:'asset-hardware',security:'asset-security',network:'asset-network',endpoint:'asset-endpoint'}[a.assetType]||'asset-inventory';
      return`<div class="dash-exp-row" onclick="navigate('${navTarget}')">
        <div class="dash-exp-dot" style="background:${col}"></div>
        <div class="dash-exp-info">
          <div class="dash-exp-name">${a.name}</div>
          <div class="dash-exp-meta">${typeLbl} · ${a.brand||''} · ${a.warrantyExpiry?'Warranty':'License'} ${d||''}</div>
        </div>
        <div class="dash-exp-tag" style="background:${col}18;color:${col}">${lbl}</div>
      </div>`;
    }).join('')
    :`<div style="text-align:center;padding:24px;color:var(--dim);font-size:12px">✓ ไม่มี asset ที่ใกล้หมดอายุ</div>`;

  // ── 3a. Security compliance ──
  const secAssets=sec.slice(0,5);
  document.getElementById('dash-sec-compliance').innerHTML=secAssets.map(a=>{
    const pct=Math.min(100,a.health);
    const col=pct>=80?'var(--green)':pct>=60?'var(--yellow)':'var(--red)';
    return`<div class="dash-comp-row">
      <div class="dash-comp-hd">
        <div class="dash-comp-name">${a.name.replace(/\(.*\)/,'').trim()}</div>
        <div class="dash-comp-pct" style="color:${col}">${pct}</div>
      </div>
      <div class="dash-comp-track"><div class="dash-comp-fill" style="width:${pct}%;background:${col}"></div></div>
    </div>`;
  }).join('');

  // ── 3b. Endpoint ring ──
  const r=42,cx=54,cy=54,circ=2*Math.PI*r;
  const filled=circ*(epPct/100);
  const ringCol=epPct>=90?'#28d98a':epPct>=75?'#f0c040':'#e05060';
  document.getElementById('dash-endpoint-ring').innerHTML=`
    <svg width="108" height="108" viewBox="0 0 108 108">
      <circle cx="${cx}" cy="${cy}" r="${r}" fill="none" stroke="var(--card2)" stroke-width="10"/>
      <circle cx="${cx}" cy="${cy}" r="${r}" fill="none" stroke="${ringCol}" stroke-width="10"
        stroke-dasharray="${filled.toFixed(1)} ${(circ-filled).toFixed(1)}"
        stroke-dashoffset="${(circ*0.25).toFixed(1)}" stroke-linecap="round"
        transform="rotate(-90 ${cx} ${cy})" opacity=".9"/>
      <text x="${cx}" y="${cy-5}" text-anchor="middle" fill="${ringCol}" font-size="17"
        font-weight="700" font-family="IBM Plex Mono,monospace">${epPct}%</text>
      <text x="${cx}" y="${cy+10}" text-anchor="middle" fill="var(--dim)" font-size="9"
        font-family="IBM Plex Mono,monospace">covered</text>
    </svg>`;
  const topEp=ep.slice(0,3);
  document.getElementById('dash-endpoint-bars').innerHTML=topEp.map(a=>{
    const pct=a.licenseCount?Math.round((a.deployedCount||0)/a.licenseCount*100):0;
    const col=pct>=90?'var(--green)':pct>=75?'var(--yellow)':'var(--red)';
    return`<div class="dash-comp-row">
      <div class="dash-comp-hd">
        <div class="dash-comp-name" style="font-size:10px">${a.name.split('(')[0].trim()}</div>
        <div class="dash-comp-pct" style="color:${col}">${pct}%</div>
      </div>
      <div class="dash-comp-track"><div class="dash-comp-fill" style="width:${pct}%;background:${col}"></div></div>
    </div>`;
  }).join('');

  // ── 3c. Vendor concentration ──
  const vendorMap={};
  assetData.forEach(a=>{const v=a.brand||'Other';vendorMap[v]=(vendorMap[v]||0)+1;});
  const vendors=Object.entries(vendorMap).sort((a,b)=>b[1]-a[1]).slice(0,6);
  const maxV=vendors[0]?vendors[0][1]:1;
  document.getElementById('dash-vendor-conc').innerHTML=vendors.map(([v,n])=>{
    const col=n>=4?'var(--red)':n>=3?'var(--yellow)':'var(--green)';
    const lbl=n>=4?'HIGH':n>=3?'MED':'LOW';
    return`<div class="dash-vrow">
      <span style="font-size:11px;font-weight:600">${v}</span>
      <div style="display:flex;align-items:center;gap:8px">
        <span style="font-size:13px;font-family:var(--mono);font-weight:700;color:${col}">${n}</span>
        <span style="font-size:9px;font-family:var(--mono);font-weight:700;padding:1px 6px;border-radius:3px;background:${col}18;color:${col}">${lbl}</span>
      </div>
    </div>`;
  }).join('');

  // ── 4. Action Required ──
  const alerts=[];
  assetData.forEach(a=>{
    const wd=normDate(a.warrantyExpiry);
    const ld=normDate(a.licenseExpiry);
    const navTarget={hardware:'asset-hardware',security:'asset-security',network:'asset-network',endpoint:'asset-endpoint'}[a.assetType]||'asset-inventory';
    const typeLbl={hardware:'Hardware',security:'Security',network:'Network',endpoint:'Endpoint'}[a.assetType]||a.assetType;
    if(a.health<60){
      const sev=a.health<40?'crit':'med';
      alerts.push({sev,title:`${a.name} — Health ต่ำ (${a.health})`,desc:`${typeLbl} · ${a.category||''} · ${a.brand||''} · ${(a.location&&a.location.site)||''} — ควรดำเนินการ`,nav:navTarget,label:typeLbl+' →',icon:a.health<40?'🔴':'🟡'});
    }
    if(wd&&wd<now)alerts.push({sev:'crit',title:`${a.name} — Warranty EXPIRED`,desc:`${typeLbl} · ${a.brand||''} · ${(a.location&&a.location.site)||''} · ไม่มี Support Contract`,nav:navTarget,label:typeLbl+' →',icon:'🔴'});
    else if(wd&&wd<in12mo)alerts.push({sev:'high',title:`${a.name} — Warranty ใกล้หมดอายุ`,desc:`${typeLbl} · Warranty exp. ${a.warrantyExpiry} · Health ${a.health}`,nav:navTarget,label:typeLbl+' →',icon:'🟠'});
    if(ld&&ld<now)alerts.push({sev:'crit',title:`${a.name} — License EXPIRED`,desc:`${typeLbl} · License exp. ${a.licenseExpiry} · ต้องต่อหรือหา replacement`,nav:navTarget,label:typeLbl+' →',icon:'🔴'});
    else if(ld&&ld<in12mo)alerts.push({sev:'high',title:`${a.name} — License ใกล้หมดอายุ`,desc:`${typeLbl} · License exp. ${a.licenseExpiry} · Health ${a.health}`,nav:navTarget,label:typeLbl+' →',icon:'🟠'});
  });
  // Deduplicate by asset name+type
  const seen=new Set();
  const uniqAlerts=alerts.filter(x=>{const k=x.title;if(seen.has(k))return false;seen.add(k);return true;});
  const sevOrder={crit:0,high:1,med:2,prog:3};
  uniqAlerts.sort((a,b)=>sevOrder[a.sev]-sevOrder[b.sev]);
  const top=uniqAlerts.slice(0,5);
  if(!top.length){
    document.getElementById('dash-asset-actions').innerHTML='';
    return;
  }
  const borderCol={crit:'rgba(224,80,96,.2)',high:'rgba(240,120,64,.15)',med:'rgba(240,192,64,.12)',prog:'rgba(79,114,255,.15)'};
  const goCol={crit:'var(--red)',high:'#f07840',med:'var(--yellow)',prog:'var(--accent)'};
  document.getElementById('dash-asset-actions').innerHTML=`
    <div style="background:linear-gradient(135deg,rgba(224,80,96,.06) 0%,var(--card) 60%);border:1px solid rgba(224,80,96,.18);border-radius:10px;padding:14px 16px">
      <div style="font-size:11px;font-weight:700;color:var(--red);margin-bottom:10px;display:flex;align-items:center;gap:7px;font-family:var(--mono)">
        ⚡ Action Required — Asset Risks
        <span style="font-size:10px;color:var(--muted);font-weight:400;margin-left:auto">คลิกเพื่อไปยัง view</span>
      </div>
      ${top.map(a=>`
      <div class="dash-arow dash-arow-${a.sev}" onclick="navigate('${a.nav}')">
        <div style="font-size:14px;flex-shrink:0;margin-top:1px">${a.icon}</div>
        <div style="flex:1;min-width:0">
          <div style="font-size:11px;font-weight:700;margin-bottom:2px;color:var(--text)">${a.title}</div>
          <div style="font-size:10px;color:var(--dim)">${a.desc}</div>
        </div>
        <div class="dash-ago" style="border-color:${borderCol[a.sev]};color:${goCol[a.sev]}">${a.label}</div>
      </div>`).join('')}
    </div>`;
}

// ── PAPER OUT — Dashboard PDF ──────────────────────────────────────────────────
function dashboardPaperOut(){
  const btn = document.getElementById('btn-dash-paper-out');
  btn.classList.add('loading');
  btn.querySelector('.paper-out-label').textContent = 'กำลังสร้าง PDF…';

  function loadScript(src){ return new Promise((res,rej)=>{ if(document.querySelector(`script[src="${src}"]`)){ res(); return; } const s=document.createElement('script'); s.src=src; s.onload=res; s.onerror=()=>rej(new Error('โหลด library ไม่ได้: '+src)); document.head.appendChild(s); }); }

  Promise.all([
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js'),
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js')
  ])
  .then(() => _doDashboardPaperOut(btn))
  .catch(err => {
    alert('❌ โหลด library ไม่ได้\n' + err.message);
    btn.classList.remove('loading');
    btn.querySelector('.paper-out-label').textContent = 'Paper Out';
  });
}

async function _doDashboardPaperOut(btn){
  const { jsPDF } = window.jspdf;
  const viewEl    = document.getElementById('view-dashboard');
  const html      = document.documentElement;
  const prevTheme = html.getAttribute('data-theme');

  // Switch to light theme for clean render
  html.setAttribute('data-theme', 'light');
  // Hide button from capture
  btn.style.visibility = 'hidden';
  // Expand any scroll-capped elements inside dashboard
  const scrollEls = viewEl.querySelectorAll('[style*="max-height"]');
  const prevMaxH  = [];
  scrollEls.forEach(el => { prevMaxH.push(el.style.maxHeight); el.style.maxHeight = 'none'; });

  // Wait for charts to repaint in light theme
  await new Promise(r => setTimeout(r, 200));

  try {
    const canvas = await html2canvas(viewEl, {
      scale: 2,
      useCORS: true,
      logging: false,
      backgroundColor: '#f5f7fb',
      width:  viewEl.scrollWidth,
      height: viewEl.scrollHeight,
      windowWidth: viewEl.scrollWidth,
      scrollX: 0, scrollY: 0,
      onclone: doc => {
        // Hide Paper Out button in cloned doc
        const b = doc.getElementById('btn-dash-paper-out');
        if(b) b.style.display = 'none';
        // Expand BCG scroll containers so all apps appear
        doc.querySelectorAll('#bcg-grid [style*="max-height"]').forEach(el => el.style.maxHeight = 'none');
      }
    });

    // A4 Portrait — dashboard is tall
    const pdf     = new jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });
    const pdfW    = pdf.internal.pageSize.getWidth();   // 210mm
    const pdfH    = pdf.internal.pageSize.getHeight();  // 297mm
    const margin  = 10;
    const headerH = 20;
    const footerH = 8;
    const usableW = pdfW - margin * 2;
    const usableH = pdfH - margin * 2 - headerH - footerH;

    const imgW      = canvas.width;
    const imgH      = canvas.height;
    const ratio     = usableW / (imgW / 2);
    const pxPerPage = (usableH / ratio) * 2;
    const totalPages = Math.ceil(imgH / pxPerPage);

    // Summary stats for header
    const total   = apps.length;
    const active  = apps.filter(a => a.status === 'Active').length;
    const avgH    = Math.round(apps.reduce((s,a) => s+a.health, 0) / apps.length);
    const tco     = apps.reduce((s,a) => s+a.tco, 0);
    const now     = new Date();
    const dateStr = `${now.getDate()}/${now.getMonth()+1}/${now.getFullYear()}`;
    const timeStr = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;

    for(let page = 0; page < totalPages; page++){
      if(page > 0) pdf.addPage();

      // ── Header ──────────────────────────────────────────────
      pdf.setFillColor(15, 52, 96);
      pdf.rect(0, 0, pdfW, headerH, 'F');

      // Logo area
      pdf.setTextColor(255,255,255);
      pdf.setFontSize(11); pdf.setFont('helvetica','bold');
      pdf.text('MPX Studio', margin, 7);
      pdf.setFontSize(7); pdf.setFont('helvetica','normal');
      pdf.setTextColor(0,229,255);
      pdf.text('EA Portfolio Dashboard', margin, 12);

      // Stats strip (centre)
      const stats = [
        `📱 ${total} Apps`,
        `✅ ${active} Active`,
        `💪 Health ${avgH}`,
        `฿${Math.round(tco/1000)}M TCO/yr`,
      ];
      pdf.setFontSize(8); pdf.setFont('helvetica','bold'); pdf.setTextColor(255,255,255);
      const stripX = pdfW/2 - (stats.length * 24)/2;
      stats.forEach((s, i) => {
        pdf.text(s, stripX + i * 30, 8, { align: 'left' });
      });
      pdf.setFontSize(7); pdf.setFont('helvetica','normal'); pdf.setTextColor(200,220,255);
      pdf.text(`ข้อมูล ณ วันที่ ${dateStr} เวลา ${timeStr} น.`, pdfW/2, 15, { align: 'center' });

      // Date + page (right)
      pdf.setFontSize(7); pdf.setTextColor(180,200,240);
      pdf.text(`หน้า ${page+1}/${totalPages}`, pdfW-margin, 12, { align:'right' });

      // ── Content slice ────────────────────────────────────────
      const srcY   = page * pxPerPage;
      const srcH   = Math.min(pxPerPage, imgH - srcY);
      const sliceH = (srcH / 2) * ratio;

      const sc = document.createElement('canvas');
      sc.width = imgW; sc.height = srcH;
      sc.getContext('2d').drawImage(canvas, 0, srcY, imgW, srcH, 0, 0, imgW, srcH);
      pdf.addImage(sc.toDataURL('image/jpeg', 0.93), 'JPEG', margin, headerH + 1, usableW, sliceH);

      // ── Footer ──────────────────────────────────────────────
      pdf.setFillColor(245, 247, 250);
      pdf.rect(0, pdfH - footerH, pdfW, footerH, 'F');
      pdf.setDrawColor(220,225,235);
      pdf.line(0, pdfH - footerH, pdfW, pdfH - footerH);
      pdf.setFontSize(6.5); pdf.setTextColor(120,130,150); pdf.setFont('helvetica','normal');
      pdf.text('MPX Studio EA Portfolio — CONFIDENTIAL — ห้ามเผยแพร่ภายนอกองค์กร', margin, pdfH-3);
      pdf.text(`หน้า ${page+1} จาก ${totalPages}`, pdfW-margin, pdfH-3, { align:'right' });
    }

    const filename = `Dashboard_${_today()}_${timeStr.replace(':','')}.pdf`;
    pdf.save(filename);
    if(typeof showToast !== 'undefined')
      showToast(`✅ Dashboard PDF สร้างเสร็จแล้ว — ${filename}`, 'success');

  } catch(err){
    console.error('Dashboard Paper Out error:', err);
    alert('❌ สร้าง PDF ไม่สำเร็จ: ' + err.message);
  } finally {
    html.setAttribute('data-theme', prevTheme);
    btn.style.visibility = 'visible';
    scrollEls.forEach((el, i) => el.style.maxHeight = prevMaxH[i]);
    btn.classList.remove('loading');
    btn.querySelector('.paper-out-label').textContent = 'Paper Out';
  }
}

// ─── PORTFOLIO ────────────────────────────────────────────────────────────────
function renderPortfolio(f={}){
  const {search='',domain='',status='',bcg:bf=''}=f;
  const filtered=apps.filter(a=>(!domain||a.domain===domain)&&(!status||a.status===status)&&(!bf||a.bcg===bf)&&(!search||(a.name+a.vendor).toLowerCase().includes(search.toLowerCase())));
  document.getElementById('port-count').textContent=`${filtered.length} apps`;
  document.getElementById('port-grid').innerHTML=filtered.map(a=>`
    <div class="app-card ${escapeHTML(a.bcg.toLowerCase())}">
      <button class="app-zoom-btn" onclick="event.stopPropagation();openAppQuickView('${escapeHTML(a.id)}')" title="ดูรายละเอียด ${escapeHTML(a.name)}">🔍</button>
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px">
        <div><div class="app-name">${escapeHTML(a.name)}</div><div class="app-id">${escapeHTML(a.id)} · ${escapeHTML(a.vendor)}</div></div>
        ${badge(a.status,statusColor[a.status]||'var(--muted)')}
      </div>
      <div class="app-meta">${badge(a.domain,'var(--accent)')}${badge(a.bcg,bcgColor[a.bcg])}${badge(a.type,'var(--accent2)')}</div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px">
        <span style="font-size:11px;color:var(--dim)">Health Score</span>
        <span style="color:${hc(a.health)};font-weight:700;font-family:var(--mono)">${a.health}</span>
      </div>
      ${hbar(a.health,'100%')}
      <div class="app-stats" style="margin-top:12px">
        <div class="app-stat-item">TCO <span>${fmt(a.tco*1000)}</span></div>
        <div class="app-stat-item">Users <span>${a.users.toLocaleString()}</span></div>
        <div class="app-stat-item">Age <span style="color:${a.age>10?'var(--red)':'inherit'}">${a.age}y</span></div>
        <div class="app-stat-item">Integr. <span style="color:${a.integration>20?'var(--yellow)':'inherit'}">${a.integration}</span></div>
      </div>
      <div class="tech-tags">${(a.stack||[]).slice(0,3).map(s=>`<span class="tech-tag">${escapeHTML(s)}</span>`).join('')}</div>
    </div>`).join('');
}

function initPortfolioFilters(){
  const ds=document.getElementById('port-domain');
  getDomains().forEach(d=>{ const o=document.createElement('option');o.value=d;o.textContent=d;ds.appendChild(o); });
  const gf=()=>({search:document.getElementById('port-search').value,domain:document.getElementById('port-domain').value,status:document.getElementById('port-status').value,bcg:document.getElementById('port-bcg').value});
  document.getElementById('port-search').addEventListener('input',()=>renderPortfolio(gf()));
  ['port-domain','port-status','port-bcg'].forEach(id=>document.getElementById(id).addEventListener('change',()=>renderPortfolio(gf())));
}

// ─── ROADMAP ──────────────────────────────────────────────────────────────────
// ─── ROADMAP ──────────────────────────────────────────────────────────────────

// Roadmap state — offset in quarters from "default view start"
// Default: today - 4 quarters ... today + 8 quarters = 13 quarters visible
let rmOffset = 0;       // quarters shifted from default (+ = forward, - = back)
const RM_VISIBLE = 13;  // number of quarters shown at once
const RM_BACK    = 4;   // default quarters before today
const RM_AHEAD   = 8;   // default quarters after today

// Lane definitions — each app type with time span expressed as quarter offsets from app's wave start
const RM_LANES = [
  { filter: a => a.status==='Active'  && a.bcg==='Invest',         type:'Upgrade',   color:'#00d68f', dS: 0, dE: 3  },
  { filter: a => a.status==='Phase-out',                            type:'Migrate',   color:'#4a9eff', dS: 2, dE: 10 },
  { filter: a => a.status==='To-retire',                            type:'Retire',    color:'#ff4757', dS: 0, dE: 2  },
  { filter: a => a.status==='Planned',                              type:'New',       color:'#7b61ff', dS: 1, dE: 6  },
  { filter: a => a.bcg==='Grow' && a.status==='Active',             type:'Modernize', color:'#ffa000', dS: 3, dE: 10 },
];

// Helpers
function rmTodayQtr(){
  const n = new Date();
  return { year: n.getFullYear(), q: Math.floor(n.getMonth() / 3) }; // q = 0..3
}
function rmQtrAdd(base, delta){
  // base = {year, q}; delta = quarters to add (can be negative)
  const total = base.year * 4 + base.q + delta;
  return { year: Math.floor(total / 4), q: total % 4 };
}
function rmQtrToFloat(qtr){ return qtr.year + qtr.q / 4; }  // e.g. 2025.5 = Q3 2025
function rmQtrLabel(qtr){
  const names = ['Q1','Q2','Q3','Q4'];
  return `${qtr.year} ${names[qtr.q]}`;
}
function rmQtrCompare(a, b){ return rmQtrToFloat(a) - rmQtrToFloat(b); }

function renderRoadmap(){
  // Build visible quarter range
  const today    = rmTodayQtr();
  const viewStart = rmQtrAdd(today, -RM_BACK  + rmOffset);
  const viewEnd   = rmQtrAdd(today,  RM_AHEAD + rmOffset);  // inclusive last quarter

  // Update label
  const label = document.getElementById('rm-range-label');
  if(label) label.textContent = `${rmQtrLabel(viewStart)} – ${rmQtrLabel(viewEnd)}`;

  // Build quarter list
  const qtrs = [];
  for(let i = 0; i < RM_VISIBLE; i++){
    qtrs.push(rmQtrAdd(viewStart, i));
  }

  // Render quarter headers
  const headersEl = document.getElementById('rm-headers');
  const todayPct  = _rmTodayPct(today, viewStart, viewEnd);
  headersEl.innerHTML = qtrs.map(q => {
    const isToday = q.year === today.year && q.q === today.q;
    return `<div class="rm-qtr${isToday ? ' current-qtr' : ''}">${rmQtrLabel(q)}</div>`;
  }).join('');

  // Today line overlay (after headers render — uses same margin-left as labels)
  // Inject into a wrapper around headers+rows
  const existingLine = document.getElementById('rm-today-line');
  if(existingLine) existingLine.remove();
  if(todayPct >= 0 && todayPct <= 100){
    const line = document.createElement('div');
    line.id = 'rm-today-line';
    line.className = 'rm-today-line';
    // Position within the track area (offset by label width 192px)
    line.style.cssText = `position:absolute;top:0;bottom:0;width:2px;
      left:calc(192px + (100% - 192px) * ${todayPct/100});
      background:rgba(0,229,255,.7);pointer-events:none;z-index:10;`;
    line.innerHTML = `<span style="position:absolute;top:-20px;left:50%;transform:translateX(-50%);
      font-size:9px;font-weight:700;color:var(--accent);font-family:var(--mono);
      white-space:nowrap;background:var(--card);padding:1px 5px;border-radius:3px;
      border:1px solid rgba(0,229,255,.3)">Today</span>`;
    const rowsWrap = document.getElementById('roadmap-rows').parentElement;
    rowsWrap.style.position = 'relative';
    rowsWrap.insertBefore(line, document.getElementById('rm-headers'));
  }

  // Build rows from lane definitions
  const rows = [];
  RM_LANES.forEach(lane => {
    const matched = apps.filter(lane.filter).slice(0, lane.type === 'New' ? 999 : 8);
    matched.forEach(a => {
      // Anchor to wave: wave 1 = today, wave 2 = today+2q, wave 3 = today+4q
      const waveOffset = ((a.wave || 1) - 1) * 2;
      const barStart = rmQtrAdd(today, waveOffset + lane.dS - RM_BACK);  // in absolute quarters
      const barEnd   = rmQtrAdd(today, waveOffset + lane.dE - RM_BACK);
      rows.push({ a, type: lane.type, color: lane.color, barStart, barEnd });
    });
  });

  // Render rows
  const rowsEl = document.getElementById('roadmap-rows');
  if(!rows.length){
    rowsEl.innerHTML = '<div class="rm-empty">ไม่มีข้อมูลสำหรับช่วงเวลานี้</div>';
    return;
  }

  rowsEl.innerHTML = rows.map(r => {
    const pctStart = _rmBarPct(r.barStart, viewStart, viewEnd);
    const pctEnd   = _rmBarPct(r.barEnd,   viewStart, viewEnd);

    // Skip rows completely outside view
    if(pctEnd <= 0 || pctStart >= 100) return '';

    const clampedStart = Math.max(0,   pctStart);
    const clampedEnd   = Math.min(100, pctEnd);
    const width        = clampedEnd - clampedStart;
    if(width <= 0) return '';

    const clippedL = pctStart < 0   ? ' clipped-left'  : '';
    const clippedR = pctEnd   > 100 ? ' clipped-right' : '';

    return `<div class="rm-row">
      <div class="rm-label">
        <div class="name" title="${r.a.name}">${r.a.name}</div>
        <div class="domain">${r.a.domain}</div>
      </div>
      <div class="rm-track">
        <div class="rm-bar${clippedL}${clippedR}"
             style="left:${clampedStart.toFixed(2)}%;width:${width.toFixed(2)}%;background:${r.color};box-shadow:inset 0 1px 0 rgba(255,255,255,.2)"
             title="${r.a.name} | ${r.type} | ${rmQtrLabel(r.barStart)} → ${rmQtrLabel(r.barEnd)}">
          <span class="rm-bar-label">${r.type}</span>
        </div>
      </div>
    </div>`;
  }).join('');

  // Wire navigator buttons (idempotent)
  _rmWireNav();
}

function _rmBarPct(qtr, viewStart, viewEnd){
  const total  = RM_VISIBLE;
  const vsF    = rmQtrToFloat(viewStart);
  const veF    = rmQtrToFloat(viewEnd) + 0.25;  // +0.25 to include end quarter fully
  const qF     = rmQtrToFloat(qtr);
  return ((qF - vsF) / (veF - vsF)) * 100;
}

function _rmTodayPct(today, viewStart, viewEnd){
  const now = new Date();
  // fractional position within today's quarter (0..1)
  const monthInQtr = now.getMonth() % 3;
  const dayFrac    = (monthInQtr * 30 + now.getDate()) / 90;
  const todayF     = rmQtrToFloat(today) + dayFrac * 0.25;
  const vsF        = rmQtrToFloat(viewStart);
  const veF        = rmQtrToFloat(viewEnd) + 0.25;
  return ((todayF - vsF) / (veF - vsF)) * 100;
}

function _rmWireNav(){
  const prev  = document.getElementById('rm-prev');
  const next  = document.getElementById('rm-next');
  const todayBtn = document.getElementById('rm-today');
  if(prev && !prev.__wired){
    prev.__wired = true;
    prev.addEventListener('click', () => { rmOffset--; renderRoadmap(); });
    next.addEventListener('click', () => { rmOffset++; renderRoadmap(); });
    todayBtn.addEventListener('click', () => { rmOffset = 0; renderRoadmap(); });
  }
}

// ── PAPER OUT — Export Roadmap to PDF ─────────────────────────────────────────
function roadmapPaperOut(){
  const btn = document.getElementById('btn-roadmap-paper-out');
  btn.classList.add('loading');
  btn.querySelector('.paper-out-label').textContent = 'กำลังสร้าง PDF…';

  function loadScript(src){ return new Promise((res,rej)=>{ if(document.querySelector(`script[src="${src}"]`)){ res(); return; } const s=document.createElement('script'); s.src=src; s.onload=res; s.onerror=()=>rej(new Error('โหลด library ไม่ได้: '+src)); document.head.appendChild(s); }); }

  Promise.all([
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js'),
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js')
  ])
  .then(() => _doRoadmapPaperOut(btn))
  .catch(err => {
    alert('❌ โหลด library ไม่ได้ — กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต\n' + err.message);
    btn.classList.remove('loading');
    btn.querySelector('.paper-out-label').textContent = 'Paper Out';
  });
}

async function _doRoadmapPaperOut(btn){
  const { jsPDF } = window.jspdf;
  const cardEl    = document.querySelector('#view-roadmap .card');

  // Switch to light theme for clean render
  const html = document.documentElement;
  const prevTheme = html.getAttribute('data-theme');
  html.setAttribute('data-theme', 'light');
  // Temporarily remove max-height so all rows render
  const rowsEl = document.getElementById('roadmap-rows');
  const prevMaxH = rowsEl.style.maxHeight;
  rowsEl.style.maxHeight = 'none';
  // Hide Paper Out button from capture
  btn.style.visibility = 'hidden';

  await new Promise(r => setTimeout(r, 150));

  try {
    const canvas = await html2canvas(cardEl, {
      scale: 2,
      useCORS: true,
      logging: false,
      backgroundColor: '#ffffff',
      width:  cardEl.scrollWidth,
      height: cardEl.scrollHeight,
      windowWidth: cardEl.scrollWidth,
      scrollX: 0, scrollY: 0,
    });

    // A4 landscape — roadmap is wide
    const pdf    = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
    const pdfW   = pdf.internal.pageSize.getWidth();   // 297mm
    const pdfH   = pdf.internal.pageSize.getHeight();  // 210mm
    const margin = 10;
    const headerH = 16;
    const footerH = 8;
    const usableW = pdfW - margin * 2;
    const usableH = pdfH - margin * 2 - headerH - footerH;

    const imgW   = canvas.width;
    const imgH   = canvas.height;
    const ratio  = usableW / (imgW / 2);
    const totalH = (imgH / 2) * ratio;
    const pxPerPage = (usableH / ratio) * 2;
    const totalPages = Math.ceil(imgH / pxPerPage);

    // Range label for header
    const rangeLabel = document.getElementById('rm-range-label')?.textContent || '';
    const today = new Date();
    const dateStr = `${today.getDate()}/${today.getMonth()+1}/${today.getFullYear()}`;

    for(let page = 0; page < totalPages; page++){
      if(page > 0) pdf.addPage();

      // ── Header ──────────────────────────────────────────────
      pdf.setFillColor(15, 52, 96);
      pdf.rect(0, 0, pdfW, headerH, 'F');
      pdf.setTextColor(255,255,255);
      pdf.setFontSize(9); pdf.setFont('helvetica','bold');
      pdf.text('MPX Studio', margin, 6.5);
      pdf.setFontSize(7); pdf.setFont('helvetica','normal');
      pdf.setTextColor(0,229,255);
      pdf.text('Application Roadmap', margin, 11.5);
      // Range in centre
      pdf.setFontSize(9); pdf.setFont('helvetica','bold'); pdf.setTextColor(255,255,255);
      pdf.text(rangeLabel, pdfW/2, 7, { align:'center' });
      pdf.setFontSize(7); pdf.setFont('helvetica','normal'); pdf.setTextColor(200,220,255);
      pdf.text(`แสดง ${RM_VISIBLE} ไตรมาส · Wave-based timeline`, pdfW/2, 12, { align:'center' });
      // Date + page
      pdf.setTextColor(180,200,240);
      pdf.text(`${dateStr}  |  หน้า ${page+1}/${totalPages}`, pdfW-margin, 12, { align:'right' });

      // ── Content slice ────────────────────────────────────────
      const srcY  = page * pxPerPage;
      const srcH  = Math.min(pxPerPage, imgH - srcY);
      const sliceH = (srcH / 2) * ratio;

      const sliceCanvas = document.createElement('canvas');
      sliceCanvas.width  = imgW;
      sliceCanvas.height = srcH;
      sliceCanvas.getContext('2d').drawImage(canvas, 0, srcY, imgW, srcH, 0, 0, imgW, srcH);
      pdf.addImage(sliceCanvas.toDataURL('image/jpeg', 0.92), 'JPEG', margin, headerH + 1, usableW, sliceH);

      // ── Footer ──────────────────────────────────────────────
      pdf.setFillColor(245, 247, 250);
      pdf.rect(0, pdfH - footerH, pdfW, footerH, 'F');
      pdf.setDrawColor(220,225,235);
      pdf.line(0, pdfH - footerH, pdfW, pdfH - footerH);
      pdf.setFontSize(6.5); pdf.setTextColor(120,130,150); pdf.setFont('helvetica','normal');
      pdf.text('MPX Studio EA Portfolio — CONFIDENTIAL', margin, pdfH - 3);
      pdf.text(`หน้า ${page+1} จาก ${totalPages}`, pdfW - margin, pdfH - 3, { align:'right' });
    }

    const filename = `Roadmap_${rangeLabel.replace(/[^a-zA-Z0-9]/g,'_')}_${_today()}.pdf`;
    pdf.save(filename);
    if(typeof showToast !== 'undefined')
      showToast(`✅ Roadmap PDF สร้างเสร็จแล้ว — ${filename}`, 'success');

  } catch(err){
    console.error('Roadmap Paper Out error:', err);
    alert('❌ สร้าง PDF ไม่สำเร็จ: ' + err.message);
  } finally {
    html.setAttribute('data-theme', prevTheme);
    rowsEl.style.maxHeight = prevMaxH;
    btn.style.visibility = 'visible';
    btn.classList.remove('loading');
    btn.querySelector('.paper-out-label').textContent = 'Paper Out';
  }
}

// ─── LIFECYCLE ────────────────────────────────────────────────────────────────
function renderLifecycle(){
  const sorted=[...apps].sort((a,b)=>a.health-b.health);
  const actions={Active:'✅ Maintain','Phase-out':'⚠️ Plan migration','To-retire':'🛑 Retire now',Planned:'🚀 Build'};
  document.getElementById('tbl-lifecycle').innerHTML=`<thead><tr><th>Application</th><th>Domain</th><th>Status</th><th>Age</th><th>Health</th><th>Tech Debt</th><th>EOL</th><th>Criticality</th><th>Action</th></tr></thead>
    <tbody>${sorted.map(a=>`<tr>
      <td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td>
      <td style="color:var(--dim);font-size:12px">${escapeHTML(a.domain)}</td>
      <td>${badge(a.status,statusColor[a.status]||'var(--muted)')}</td>
      <td style="color:${a.age>10?'var(--red)':a.age>5?'var(--yellow)':'var(--dim)'};font-family:var(--mono)">${a.age}y</td>
      <td><div style="display:flex;align-items:center;gap:8px">${hbar(a.health,60)}<span style="color:${hc(a.health)};font-weight:700;font-family:var(--mono)">${a.health}</span></div></td>
      <td><div style="display:flex;align-items:center;gap:8px"><div class="hbar-wrap" style="width:60px;height:6px"><div class="hbar-fill" style="width:${a.techDebt}%;background:${a.techDebt>60?'var(--red)':a.techDebt>30?'var(--yellow)':'var(--green)'}"></div></div><span style="color:${a.techDebt>60?'var(--red)':'var(--dim)'};font-family:var(--mono);font-size:12px">${a.techDebt}</span></div></td>
      <td style="color:var(--dim);font-family:var(--mono);font-size:11px;white-space:nowrap">${a.eol}</td>
      <td>${badge(a.criticality,a.criticality==='Mission Critical'?'var(--accent2)':'var(--muted)')}</td>
      <td style="font-size:12px;white-space:nowrap">${actions[a.status]||'Review'}</td>
    </tr>`).join('')}</tbody>`;
}

// ─── TECH DEBT ────────────────────────────────────────────────────────────────
function renderTechDebt(){
  const sorted=[...apps].sort((a,b)=>b.techDebt-a.techDebt);
  const cats={'Legacy (>15y)':0,'Phase-out':0,'Aging (10–15y)':0,'Active':0};
  apps.forEach(a=>{ if(a.age>15)cats['Legacy (>15y)']+=a.techDebt;else if(a.status==='Phase-out')cats['Phase-out']+=a.techDebt;else if(a.age>10)cats['Aging (10–15y)']+=a.techDebt;else cats['Active']+=a.techDebt; });
  const catColors=['#ff4757','#ffa000','#f97316','#00d68f'];
  destroyChart('dD');
  charts.dD=new Chart(document.getElementById('chart-debt-donut'),{
    type:'doughnut',data:{labels:Object.keys(cats),datasets:[{data:Object.values(cats),backgroundColor:catColors.map(c=>c+'99'),borderColor:catColors,borderWidth:2}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:'60%',plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip}}
  });
  document.getElementById('debt-legend').innerHTML=Object.keys(cats).map((k,i)=>`<div class="leg-item"><div class="leg-dot" style="background:${catColors[i]}"></div>${k}</div>`).join('');
  destroyChart('dT');
  charts.dT=new Chart(document.getElementById('chart-debt-top10'),{
    type:'bar',
    data:{labels:sorted.slice(0,10).map(a=>a.name.length>14?a.name.slice(0,14)+'…':a.name),
      datasets:[{data:sorted.slice(0,10).map(a=>a.techDebt),backgroundColor:sorted.slice(0,10).map(a=>a.techDebt>60?'#ff475788':a.techDebt>30?'#ffa00088':'#00d68f88'),borderColor:sorted.slice(0,10).map(a=>a.techDebt>60?'#ff4757':a.techDebt>30?'#ffa000':'#00d68f'),borderWidth:1,borderRadius:4}]},
    options:{...chartOpts(),indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip},scales:{x:{...chartOpts().scales.x,max:100},y:chartOpts().scales.y}}
  });
  document.getElementById('tbl-debt').innerHTML=`<thead><tr><th>#</th><th>Application</th><th>Domain</th><th>Age</th><th>Tech Debt</th><th>Status</th><th>Est. Remediation</th></tr></thead>
    <tbody>${sorted.map((a,i)=>`<tr><td style="color:${i<3?'var(--red)':'var(--muted)'};font-family:var(--mono);font-weight:${i<3?700:400}">#${i+1}</td>
      <td style="font-weight:600;color:var(--text)">${a.name}</td><td style="color:var(--dim);font-size:12px">${a.domain}</td>
      <td style="color:${a.age>15?'var(--red)':a.age>10?'var(--yellow)':'var(--dim)'};font-family:var(--mono)">${a.age}y</td>
      <td><div style="display:flex;align-items:center;gap:8px"><div class="hbar-wrap" style="width:80px;height:8px"><div class="hbar-fill" style="width:${a.techDebt}%;background:${a.techDebt>60?'var(--red)':a.techDebt>30?'var(--yellow)':'var(--green)'}"></div></div><span style="color:${a.techDebt>60?'var(--red)':'var(--text)'};font-weight:700;font-family:var(--mono)">${a.techDebt}/100</span></div></td>
      <td>${badge(a.status,statusColor[a.status]||'var(--muted)')}</td>
      <td style="color:var(--accent3);font-family:var(--mono)">${fmt(Math.round(a.techDebt*a.tco*0.01)*1000)}</td>
    </tr>`).join('')}</tbody>`;
}

// ─── CAPABILITY ───────────────────────────────────────────────────────────────
function renderCapability(){
  const caps={};
  apps.forEach(a=>{ if(!caps[a.capability])caps[a.capability]={list:[],tco:0};caps[a.capability].list.push(a);caps[a.capability].tco+=a.tco; });
  const arr=Object.entries(caps).map(([cap,{list,tco}])=>({cap,list,tco,avgH:Math.round(list.reduce((s,a)=>s+a.health,0)/list.length)})).sort((a,b)=>a.avgH-b.avgH);
  document.getElementById('cap-stats').textContent=`${arr.length} capabilities · ${apps.length} applications`;
  document.getElementById('cap-grid').innerHTML=arr.map(({cap,list,tco,avgH})=>`
    <div class="cap-card" style="border-color:${hc(avgH)}">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px">
        <div style="font-size:13px;font-weight:700;color:var(--text);flex:1;margin-right:8px">${cap}</div>
        <div class="cap-score" style="color:${hc(avgH)}">${avgH}</div>
      </div>
      ${hbar(avgH,'100%')}<div class="cap-tco">${fmt(tco*1000)} TCO · ${list.length} app${list.length>1?'s':''}</div>
      <div style="margin-top:10px;display:flex;flex-direction:column;gap:5px">${list.map(a=>`
        <div style="display:flex;align-items:center;justify-content:space-between;gap:8px">
          <span style="font-size:11px;color:var(--dim);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:140px">${a.name}</span>
          <div style="display:flex;gap:6px;align-items:center;flex-shrink:0">${hbar(a.health,40)}${badge(a.bcg,bcgColor[a.bcg])}</div>
        </div>`).join('')}
      </div></div>`).join('');
}

// ─── STANDARDS ────────────────────────────────────────────────────────────────
function renderStandards(){
  // ── ใช้ COMPLIANCE_STANDARDS (centralized) — เพิ่ม standard ใหม่แก้ที่ constant เดียว ──
  const activeApps=apps.filter(a=>!a.decommissioned);
  const stds=Object.entries(COMPLIANCE_STANDARDS).map(([key,desc])=>({
    name:key, desc,
    all:activeApps,
    comp:activeApps.filter(a=>(a.compliance||[]).includes(key))
  }));
  document.getElementById('std-bars').innerHTML=stds.map(s=>{
    const pct=Math.round(s.comp.length/s.all.length*100)||0,c=pct>80?'var(--green)':pct>60?'var(--yellow)':'var(--red)';
    return`<div class="std-row"><div class="std-name"><div class="n">${s.name}</div><div class="d">${s.desc}</div></div>
      <div class="std-bar-wrap"><div class="std-bar-fill" style="width:${pct}%;background:${c}"></div></div>
      <div class="std-pct" style="color:${c}">${pct}%</div><div class="std-count">${s.comp.length}/${s.all.length}</div></div>`;
  }).join('');
  const vs={};apps.forEach(a=>vs[a.vendor]=(vs[a.vendor]||0)+1);
  const vArr=Object.entries(vs).sort((a,b)=>b[1]-a[1]);
  destroyChart('vnd');
  charts.vnd=new Chart(document.getElementById('chart-vendor'),{
    type:'bar',
    data:{labels:vArr.map(e=>e[0]),datasets:[{data:vArr.map(e=>e[1]),backgroundColor:vArr.map((_,i)=>i===0?'#ff475788':i<3?'#ffa00088':isDark()?'#00e5ff44':'#0066cc33'),borderColor:vArr.map((_,i)=>i===0?'#ff4757':i<3?'#ffa000':'var(--accent)'),borderWidth:1,borderRadius:4}]},
    options:{...chartOpts(),responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip},scales:{x:{...chartOpts().scales.x,ticks:{...chartOpts().scales.x.ticks,maxRotation:45}},y:{...chartOpts().scales.y,beginAtZero:true}}}
  });
  const ct=apps.filter(a=>a.contractEnd!=='N/A').sort((a,b)=>a.contractEnd.localeCompare(b.contractEnd)).slice(0,14);
  document.getElementById('contract-list').innerHTML=ct.map(a=>{
    const m=Math.round((new Date(a.contractEnd+'-01')-new Date('2025-01-01'))/(1000*60*60*24*30));
    const u=m<6?'var(--red)':m<12?'var(--yellow)':'var(--green)';
    return`<div style="display:flex;justify-content:space-between;align-items:center;padding:7px 0;border-bottom:1px solid rgba(128,128,128,.13)">
      <span style="font-size:12px;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:160px">${a.name}</span>
      <div style="display:flex;gap:8px;align-items:center;flex-shrink:0"><span style="font-size:11px;color:var(--dim);font-family:var(--mono)">${a.contractEnd}</span><div style="width:8px;height:8px;border-radius:50%;background:${u}"></div></div></div>`;
  }).join('');
}

// ─── FINANCIAL ────────────────────────────────────────────────────────────────
function renderFinancial(){
  const tot=apps.reduce((s,a)=>s+a.tco,0),leg=apps.filter(a=>a.age>10).reduce((s,a)=>s+a.tco,0),
    ret=apps.filter(a=>['To-retire','Phase-out'].includes(a.status)).reduce((s,a)=>s+a.tco,0),
    tu=apps.reduce((s,a)=>s+Math.max(a.users,1),0);
  document.getElementById('fin-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--accent3)"><div class="kpi-label">Total Portfolio TCO</div><div class="kpi-value">${fmt(tot*1000)}</div><div class="kpi-sub">Annual cost</div></div>
    <div class="kpi" style="--kpi-color:var(--red)"><div class="kpi-label">Legacy Cost</div><div class="kpi-value">${fmt(leg*1000)}</div><div class="kpi-sub">Apps older than 10y</div></div>
    <div class="kpi" style="--kpi-color:var(--green)"><div class="kpi-label">Potential Savings</div><div class="kpi-value">${fmt(ret*1000)}</div><div class="kpi-sub">Retire phase-out apps</div></div>
    <div class="kpi" style="--kpi-color:var(--accent2)"><div class="kpi-label">Cost/1K Users</div><div class="kpi-value">฿${Math.round(tot/(tu/1000)).toLocaleString()}K</div><div class="kpi-sub">Portfolio efficiency</div></div>`;
  const sc=apps.map(a=>({x:a.tco,y:a.health,r:Math.max(5,Math.log(a.users+1)*3),label:a.name,bcg:a.bcg}));
  const bc={Invest:'#00d68f99',Grow:'#4a9eff99',Tolerate:'#ffa00099',Retire:'#ff475799'};
  destroyChart('tcoSc');
  charts.tcoSc=new Chart(document.getElementById('chart-tco-scatter'),{
    type:'bubble',data:{datasets:[{data:sc,backgroundColor:sc.map(d=>bc[d.bcg]),borderWidth:1}]},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{...chartOpts().plugins.tooltip,callbacks:{label:c=>`${c.raw.label}: ฿${c.raw.x}K | H:${c.raw.y}`}}},
      scales:{x:{...chartOpts().scales.x,title:{display:true,text:'TCO (K THB)',color:'var(--dim)',font:{family:'JetBrains Mono',size:10}}},
               y:{...chartOpts().scales.y,min:0,max:100,title:{display:true,text:'Health Score',color:'var(--dim)',font:{family:'JetBrains Mono',size:10}}}}}
  });
  const ra=apps.filter(a=>['To-retire','Phase-out'].includes(a.status)).sort((a,b)=>b.tco-a.tco);
  destroyChart('retSv');
  charts.retSv=new Chart(document.getElementById('chart-retire-save'),{
    type:'bar',
    data:{labels:ra.map(a=>a.name.length>16?a.name.slice(0,16)+'…':a.name),datasets:[{data:ra.map(a=>a.tco),backgroundColor:'#00d68f55',borderColor:'var(--green)',borderWidth:1,borderRadius:4,label:'Annual Savings'}]},
    options:{...chartOpts(),indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:11}}},tooltip:{...chartOpts().plugins.tooltip,callbacks:{label:c=>`฿${c.raw.toLocaleString()}K`}}}}
  });
  const lg=apps.filter(a=>a.age>10).sort((a,b)=>b.tco-a.tco);
  document.getElementById('tbl-legacy').innerHTML=`<thead><tr><th>Application</th><th>Age</th><th>Health</th><th>Annual TCO</th><th>BCG</th><th>Status</th><th>Action</th></tr></thead>
    <tbody>${lg.map(a=>`<tr><td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td>
      <td style="color:var(--red);font-family:var(--mono);font-weight:700">${a.age}y</td>
      <td><div style="display:flex;align-items:center;gap:8px">${hbar(a.health,60)}<span style="color:${hc(a.health)};font-weight:700;font-family:var(--mono)">${a.health}</span></div></td>
      <td style="color:var(--accent3);font-family:var(--mono);font-weight:700">${fmt(a.tco*1000)}</td>
      <td>${badge(a.bcg,bcgColor[a.bcg])}</td><td>${badge(a.status,statusColor[a.status]||'var(--muted)')}</td>
      <td style="font-size:12px;color:${a.bcg==='Retire'?'var(--red)':'var(--yellow)'}">${a.bcg==='Retire'?'🛑 Retire':'⚠️ Modernize'}</td>
    </tr>`).join('')}</tbody>`;
}

// ─── EXECUTIVE ────────────────────────────────────────────────────────────────
function renderExecutive(){
  const rs=apps.filter(a=>['To-retire','Phase-out'].includes(a.status)).reduce((s,a)=>s+a.tco,0),
    noDr=apps.filter(a=>a.criticality==='Mission Critical'&&!a.dr).length,
    leg=apps.filter(a=>a.age>10).length,
    avgS=Math.round(apps.reduce((s,a)=>s+a.strategic,0)/apps.length);
  document.getElementById('exec-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--green)"><div class="kpi-label">Retirement Savings</div><div class="kpi-value">${fmt(rs*1000)}</div><div class="kpi-sub">Annual savings potential</div></div>
    <div class="kpi" style="--kpi-color:var(--red)"><div class="kpi-label">Critical No DR</div><div class="kpi-value">${noDr}</div><div class="kpi-sub">Resilience risk — urgent</div></div>
    <div class="kpi" style="--kpi-color:var(--yellow)"><div class="kpi-label">Legacy (>10y)</div><div class="kpi-value">${leg}</div><div class="kpi-sub">${fmt(apps.filter(a=>a.age>10).reduce((s,a)=>s+a.tco,0)*1000)} annual TCO</div></div>
    <div class="kpi" style="--kpi-color:var(--accent2)"><div class="kpi-label">Strategic Alignment</div><div class="kpi-value">${avgS}%</div><div class="kpi-sub">Portfolio avg score</div></div>`;
  const dD={};
  apps.forEach(a=>{ if(!dD[a.domain])dD[a.domain]={tco:0,str:[]}; dD[a.domain].tco+=a.tco; dD[a.domain].str.push(a.strategic); });
  const dArr=Object.entries(dD).map(([d,v])=>({d,tco:v.tco,avgStr:Math.round(v.str.reduce((s,x)=>s+x,0)/v.str.length)})).sort((a,b)=>b.tco-a.tco);
  destroyChart('exI');
  charts.exI=new Chart(document.getElementById('chart-exec-inv'),{
    type:'bar',
    data:{labels:dArr.map(e=>e.d),datasets:[
      {label:'TCO (K THB)',data:dArr.map(e=>e.tco),backgroundColor:'#7b61ff55',borderColor:'var(--accent2)',borderWidth:1,borderRadius:4,yAxisID:'y'},
      {label:'Strategic %',data:dArr.map(e=>e.avgStr),borderColor:'var(--accent)',backgroundColor:'transparent',borderWidth:2,type:'line',tension:.3,pointRadius:4,yAxisID:'y1'}
    ]},
    options:{...chartOpts(),responsive:true,maintainAspectRatio:false,
      plugins:{legend:{labels:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:10}}},tooltip:chartOpts().plugins.tooltip},
      scales:{x:{...chartOpts().scales.x,ticks:{...chartOpts().scales.x.ticks,maxRotation:35}},y:{...chartOpts().scales.y,position:'left'},y1:{...chartOpts().scales.y,position:'right',min:0,max:100,grid:{display:false}}}}
  });
  const sc=apps.map(a=>({x:a.health,y:a.strategic,r:Math.max(4,Math.log10(a.tco)*4),label:a.name,bcg:a.bcg}));
  const bc={Invest:'#00d68f99',Grow:'#4a9eff99',Tolerate:'#ffa00099',Retire:'#ff475799'};
  destroyChart('exSc');
  charts.exSc=new Chart(document.getElementById('chart-exec-scatter'),{
    type:'bubble',data:{datasets:[{data:sc,backgroundColor:sc.map(d=>bc[d.bcg]),borderWidth:1}]},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{...chartOpts().plugins.tooltip,callbacks:{label:c=>`${c.raw.label}: H${c.raw.x} S${c.raw.y}`}}},
      scales:{x:{...chartOpts().scales.x,min:0,max:100},y:{...chartOpts().scales.y,min:0,max:100}}}
  });
  document.getElementById('exec-domain-grid').innerHTML=dArr.map(d=>{
    const da=apps.filter(a=>a.domain===d.d),avgH=Math.round(da.reduce((s,a)=>s+a.health,0)/da.length),rc=da.filter(a=>['To-retire','Phase-out'].includes(a.status)).length;
    return`<div class="domain-card" style="border-color:${hc(avgH)}"><div class="dc-name">${d.d}</div>
      <div class="dc-row">Apps <span>${da.length}</span></div>
      <div class="dc-row">TCO <span style="color:var(--accent3)">${fmt(d.tco*1000)}</span></div>
      <div class="dc-row">Avg Health <span style="color:${hc(avgH)}">${avgH}</span></div>
      <div class="dc-row">Strategic <span style="color:var(--accent2)">${d.avgStr}%</span></div>
      ${rc>0?`<div class="dc-row">Retiring <span style="color:var(--red)">${rc}</span></div>`:''}
    </div>`;
  }).join('');
  const risky=apps.filter(a=>a.criticality==='Mission Critical'||(!a.dr&&a.age>5)).sort((a,b)=>a.health-b.health);
  document.getElementById('tbl-resilience').innerHTML=`<thead><tr><th>Application</th><th>Domain</th><th>Criticality</th><th>Health</th><th>DR</th><th>Age</th><th>PI/SPI</th><th>Risk Action</th></tr></thead>
    <tbody>${risky.map(a=>{
      const rl=!a.dr&&a.criticality==='Mission Critical'?'🚨 DR Uplift':a.health<50?'🛑 Urgent':a.age>15?'⚠️ Modernize':'✅ Monitor';
      return`<tr><td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td><td style="color:var(--dim);font-size:12px">${escapeHTML(a.domain)}</td>
        <td>${badge(a.criticality,a.criticality==='Mission Critical'?'var(--accent2)':'var(--blue)')}</td>
        <td><div style="display:flex;align-items:center;gap:8px">${hbar(a.health,60)}<span style="color:${hc(a.health)};font-weight:700;font-family:var(--mono)">${a.health}</span></div></td>
        <td style="font-size:16px;text-align:center;color:${a.dr?'var(--green)':'var(--red)'}">${a.dr?'✓':'✗'}</td>
        <td style="color:${a.age>10?'var(--red)':'var(--dim)'};font-family:var(--mono)">${a.age}y</td>
        <td style="text-align:center">${a.piSpi?badge('PI/SPI','var(--red)'):badge('None','var(--muted)')}</td>
        <td style="font-size:12px">${rl}</td></tr>`;
    }).join('')}</tbody>`;
}

// ═══════════════════════════════════════════════════════════════════════════════
// IT OPS VIEWS
// ═══════════════════════════════════════════════════════════════════════════════

function renderOpsRisk(){
  const highRisk=apps.filter(a=>a.persons<=2&&['Mission Critical','High'].includes(a.criticality));
  const noSrc=apps.filter(a=>!a.srcAvail&&['Mission Critical','High'].includes(a.criticality));
  const keyPerson=apps.filter(a=>a.persons===1);
  document.getElementById('ops-risk-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--red)"><div class="kpi-label">High Ops Risk Apps</div><div class="kpi-value">${highRisk.length}</div><div class="kpi-sub">Critical + ≤2 people</div></div>
    <div class="kpi" style="--kpi-color:var(--yellow)"><div class="kpi-label">Key Person Risk</div><div class="kpi-value">${keyPerson.length}</div><div class="kpi-sub">Only 1 person managing</div></div>
    <div class="kpi" style="--kpi-color:var(--accent2)"><div class="kpi-label">No Source Code</div><div class="kpi-value">${noSrc.length}</div><div class="kpi-sub">Critical apps, no src</div></div>
    <div class="kpi" style="--kpi-color:var(--accent)"><div class="kpi-label">24x7 Services</div><div class="kpi-value">${apps.filter(a=>a.serviceHour==='24x7').length}</div><div class="kpi-sub">Always-on applications</div></div>`;

  // Risk Matrix
  const matrix=[['Mission Critical','High'],['Low','Medium']];
  const RISK_COLORS=['var(--red)','var(--yellow)','var(--green)'];
  let html=`<table class="tbl" style="min-width:500px"><thead><tr><th>Criticality</th><th>People ≤1</th><th>People 2–3</th><th>People 4+</th></tr></thead><tbody>`;
  ['Mission Critical','High','Medium'].forEach(crit=>{
    html+=`<tr><td>${badge(crit,crit==='Mission Critical'?'var(--accent2)':crit==='High'?'var(--yellow)':'var(--muted)')}</td>`;
    [1,3,4].forEach((maxP,i)=>{
      const minP=i===0?0:i===1?2:4;
      const bucket=apps.filter(a=>a.criticality===crit&&a.persons>=(minP||0)&&(i===2||a.persons<=maxP));
      const riskLevel=crit==='Mission Critical'&&i===0?'CRITICAL':crit==='Mission Critical'&&i===1?'HIGH':crit==='High'&&i===0?'HIGH':'OK';
      const rc={CRITICAL:'var(--red)',HIGH:'var(--yellow)',OK:'var(--green)'}[riskLevel];
      html+=`<td style="background:${rc}11"><div style="display:flex;flex-direction:column;gap:3px">${bucket.slice(0,3).map(a=>`<div style="font-size:11px;color:var(--text)">${escapeHTML(a.name.slice(0,20))}</div>`).join('')}${bucket.length>3?`<div style="font-size:10px;color:var(--muted)">+${bucket.length-3} more</div>`:''}</div></td>`;
    });
    html+=`</tr>`;
  });
  html+=`</tbody></table>`;
  document.getElementById('ops-risk-matrix').innerHTML=html;

  // Key Person Chart
  const kpApps=apps.filter(a=>a.persons<=2&&a.criticality!=='Low').sort((a,b)=>a.persons-b.persons).slice(0,12);
  destroyChart('kp');
  charts.kp=new Chart(document.getElementById('chart-keyperson'),{
    type:'bar',
    data:{labels:kpApps.map(a=>a.name.length>14?a.name.slice(0,14)+'…':a.name),
      datasets:[{data:kpApps.map(a=>a.persons),backgroundColor:kpApps.map(a=>a.persons===1?'#ff475799':a.persons===2?'#ffa00088':'#00d68f88'),borderColor:kpApps.map(a=>a.persons===1?'#ff4757':a.persons===2?'#ffa000':'#00d68f'),borderWidth:1,borderRadius:4,label:'# People'}]},
    options:{...chartOpts(),indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip},scales:{x:{...chartOpts().scales.x,max:6,beginAtZero:true},y:chartOpts().scales.y}}
  });

  // Risk Table
  document.getElementById('tbl-ops-risk').innerHTML=`<thead><tr><th>Application</th><th>Criticality</th><th>People</th><th>Source Code</th><th>Service Hour</th><th>Support Type</th><th>Owner</th><th>Risk Action</th></tr></thead>
    <tbody>${apps.sort((a,b)=>a.persons-b.persons).map(a=>{
      const risk=a.persons===1&&a.criticality==='Mission Critical'?'🚨 CRITICAL':a.persons<=2&&['Mission Critical','High'].includes(a.criticality)?'⚠️ HIGH':!a.srcAvail&&a.type==='Inhouse'?'⚠️ NO SRC':'✅ OK';
      return`<tr><td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td>
        <td>${badge(a.criticality,a.criticality==='Mission Critical'?'var(--accent2)':'var(--muted)')}</td>
        <td><span style="font-family:var(--mono);font-weight:700;color:${a.persons===1?'var(--red)':a.persons<=2?'var(--yellow)':'var(--green)'}">${a.persons} 👤</span></td>
        <td style="text-align:center;font-size:14px;color:${a.srcAvail?'var(--green)':'var(--red)'}">${a.srcAvail?'✓':'✗'}</td>
        <td style="font-size:11px;font-family:var(--mono);color:var(--dim)">${escapeHTML(a.serviceHour)}</td>
        <td>${badge(a.support||'Inhouse',a.support==='Vendor'?'var(--blue)':a.support?.includes('+')?'var(--accent2)':'var(--green)')}</td>
        <td style="font-size:12px;color:var(--dim)">${escapeHTML(a.owner||'TBD')}</td>
        <td style="font-size:12px">${risk}</td></tr>`;
    }).join('')}</tbody>`;
}

function renderOpsRelease(){
  const months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const blackout=[0,2,3,5,8,9,11]; // Jan,Mar,Apr,Jun,Sep,Oct,Dec (month-end/campaign)
  const caution=[1,4,7,10]; // Feb,May,Aug,Nov

  document.getElementById('release-calendar').innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(12,1fr);gap:8px;margin-bottom:4px">
      ${months.map((m,i)=>{
        const style=blackout.includes(i)?`background:rgba(255,71,87,.15);border:1px solid rgba(255,71,87,.4)`:caution.includes(i)?`background:rgba(255,160,0,.1);border:1px solid rgba(255,160,0,.3)`:`background:rgba(0,214,143,.08);border:1px solid rgba(0,214,143,.3)`;
        const label=blackout.includes(i)?'🔴':caution.includes(i)?'🟡':'🟢';
        const deploys=apps.filter(a=>a.maintWindow&&a.maintWindow!=='N/A').slice(0,3);
        return`<div style="border-radius:8px;padding:10px 6px;text-align:center;${style}">
          <div style="font-size:11px;font-weight:700;color:var(--text);margin-bottom:4px">${m}</div>
          <div style="font-size:16px">${label}</div>
          <div style="font-size:9px;color:var(--muted);margin-top:3px;font-family:var(--mono)">${blackout.includes(i)?'BLACKOUT':caution.includes(i)?'CAUTION':'OPEN'}</div>
        </div>`;
      }).join('')}
    </div>`;

  // Service hour donut
  const sh={'24x7':0,'Business Hours':0,'Off-Hours':0};
  apps.forEach(a=>{if(sh[a.serviceHour]!==undefined)sh[a.serviceHour]++;else sh['Business Hours']++;});
  destroyChart('svcH');
  charts.svcH=new Chart(document.getElementById('chart-service-hour'),{
    type:'doughnut',
    data:{labels:Object.keys(sh),datasets:[{data:Object.values(sh),backgroundColor:['#ff475788','#4a9eff88','#00d68f88'],borderColor:['#ff4757','#4a9eff','#00d68f'],borderWidth:2}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:'55%',plugins:{legend:{labels:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:11}}},tooltip:chartOpts().plugins.tooltip}}
  });

  // Maintenance windows
  const mw=apps.filter(a=>a.maintWindow&&a.maintWindow!=='N/A').sort((a,b)=>a.maintWindow.localeCompare(b.maintWindow));
  document.getElementById('maint-windows').innerHTML=mw.map(a=>`
    <div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid rgba(128,128,128,.13)">
      <div><div style="font-size:12px;font-weight:600;color:var(--text)">${a.name}</div>
      <div style="font-size:11px;color:var(--dim)">${a.domain} · ${a.criticality}</div></div>
      <div style="text-align:right"><div style="font-size:11px;font-family:var(--mono);color:var(--accent)">${a.maintWindow}</div>
      <div style="font-size:10px;color:var(--dim)">${a.serviceHour}</div></div>
    </div>`).join('');
}

function renderOpsPlatform(){
  const langs={},os_={},dbs={};
  apps.forEach(a=>{ langs[a.lang]=(langs[a.lang]||0)+1; os_[a.os]=(os_[a.os]||0)+1; dbs[a.db]=(dbs[a.db]||0)+1; });
  const cloudApps=apps.filter(a=>(a.os||'').includes('Cloud')||a.os==='SaaS').length;
  const legacyPlatforms=apps.filter(a=>(a.os||'').includes('AS/400')||(a.os||'').includes('z/OS')||(a.os||'').includes('AIX')).length;
  document.getElementById('platform-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--accent)"><div class="kpi-label">Cloud / SaaS</div><div class="kpi-value">${cloudApps}</div><div class="kpi-sub">${Math.round(cloudApps/apps.length*100)}% of portfolio</div></div>
    <div class="kpi" style="--kpi-color:var(--red)"><div class="kpi-label">Legacy Platforms</div><div class="kpi-value">${legacyPlatforms}</div><div class="kpi-sub">AS/400, z/OS, AIX</div></div>
    <div class="kpi" style="--kpi-color:var(--green)"><div class="kpi-label">Distinct Languages</div><div class="kpi-value">${Object.keys(langs).length}</div><div class="kpi-sub">Tech diversity</div></div>
    <div class="kpi" style="--kpi-color:var(--yellow)"><div class="kpi-label">DB Platforms</div><div class="kpi-value">${Object.keys(dbs).length}</div><div class="kpi-sub">Database sprawl</div></div>`;

  const langArr=Object.entries(langs).sort((a,b)=>b[1]-a[1]).slice(0,10);
  destroyChart('stk');
  charts.stk=new Chart(document.getElementById('chart-stack-dist'),{
    type:'bar',
    data:{labels:langArr.map(e=>e[0]),datasets:[{data:langArr.map(e=>e[1]),backgroundColor:isDark()?'#7b61ff55':'#5a3fd422',borderColor:'var(--accent2)',borderWidth:1,borderRadius:4}]},
    options:{...chartOpts(),responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip}}
  });

  const osArr=Object.entries(os_).sort((a,b)=>b[1]-a[1]).slice(0,8);
  const osColors=['#00e5ff88','#7b61ff88','#00d68f88','#ffa00088','#ff475788','#4a9eff88','#f9731688','#00bcd488'];
  destroyChart('plc');
  charts.plc=new Chart(document.getElementById('chart-platform-coverage'),{
    type:'doughnut',
    data:{labels:osArr.map(e=>e[0]),datasets:[{data:osArr.map(e=>e[1]),backgroundColor:osColors,borderWidth:1}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:'50%',plugins:{legend:{labels:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:10},boxWidth:10}},tooltip:chartOpts().plugins.tooltip}}
  });

  // Stack inventory tags
  const allStacks=[...new Set(apps.flatMap(a=>a.stack||[]))].sort();
  document.getElementById('stack-inventory').innerHTML=allStacks.map(s=>{
    const cnt=apps.filter(a=>(a.stack||[]).includes(s)).length;
    const c=cnt>5?'var(--accent2)':cnt>2?'var(--accent)':'var(--muted)';
    return`<span class="stack-pill" style="background:${c}22;color:${c};border:1px solid ${c}44">${s} <span style="opacity:.6">${cnt}</span></span>`;
  }).join('');

  // Platform table
  const legacyStack=['RPG','COBOL','JCL','Oracle Forms','Siebel','Crystal Reports','PL/SQL','Documentum'];
  document.getElementById('tbl-platform').innerHTML=`<thead><tr><th>Application</th><th>Language</th><th>OS Platform</th><th>Database</th><th>Platform Status</th><th>Recommended Action</th></tr></thead>
    <tbody>${apps.map(a=>{
      const isLeg=legacyStack.some(ls=>(a.lang||'').includes(ls)||(a.stack||[]).some(s=>s.includes(ls)));
      const isCloud=(a.os||'').includes('Cloud')||(a.os||'').includes('SaaS');
      const pStatus=isLeg?'Legacy':isCloud?'Cloud-Native':'On-Prem';
      const pColor={Legacy:'var(--red)',Cloud:'var(--green)','Cloud-Native':'var(--green)','On-Prem':'var(--yellow)'}[pStatus]||'var(--muted)';
      const action=isLeg?'⚠️ Modernize stack':isCloud?'✅ Current':['RHEL 7','Windows Server 2012','AIX'].includes(a.os)?'⬆️ OS Upgrade':'✅ OK';
      return`<tr><td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td>
        <td style="font-family:var(--mono);font-size:12px;color:var(--dim)">${escapeHTML(a.lang||'N/A')}</td>
        <td style="font-size:12px;color:var(--dim)">${escapeHTML(a.os||'N/A')}</td>
        <td style="font-size:12px;color:var(--dim)">${escapeHTML(a.db||'N/A')}</td>
        <td>${badge(pStatus,pColor)}</td>
        <td style="font-size:12px">${action}</td></tr>`;
    }).join('')}</tbody>`;
}

function renderOpsSupport(){
  const types={'Vendor':0,'Inhouse':0,'Vendor+Inhouse':0};
  apps.forEach(a=>{ const t=a.support||'Inhouse'; if(types[t]!==undefined)types[t]++;else types['Inhouse']++; });
  const mc247=apps.filter(a=>a.criticality==='Mission Critical'&&a.serviceHour==='24x7').length;
  const vendorCrit=apps.filter(a=>a.criticality==='Mission Critical'&&(a.support||'').includes('Vendor')).length;
  document.getElementById('support-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--accent)"><div class="kpi-label">Vendor Supported</div><div class="kpi-value">${types['Vendor']+types['Vendor+Inhouse']}</div><div class="kpi-sub">External dependency</div></div>
    <div class="kpi" style="--kpi-color:var(--green)"><div class="kpi-label">Inhouse Managed</div><div class="kpi-value">${types['Inhouse']}</div><div class="kpi-sub">Internal team support</div></div>
    <div class="kpi" style="--kpi-color:var(--yellow)"><div class="kpi-label">Critical on Vendor</div><div class="kpi-value">${vendorCrit}</div><div class="kpi-sub">MC apps vendor-dependent</div></div>
    <div class="kpi" style="--kpi-color:var(--accent2)"><div class="kpi-label">Mission Critical 24x7</div><div class="kpi-value">${mc247}</div><div class="kpi-sub">Always-on critical services</div></div>`;

  const typeColors=['#4a9eff88','#00d68f88','#7b61ff88'];
  const typeKeys=Object.keys(types);
  destroyChart('supM');
  charts.supM=new Chart(document.getElementById('chart-support-model'),{
    type:'doughnut',
    data:{labels:typeKeys,datasets:[{data:typeKeys.map(k=>types[k]),backgroundColor:typeColors,borderColor:typeColors.map(c=>c.slice(0,7)),borderWidth:2}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:'55%',plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip}}
  });
  document.getElementById('support-legend').innerHTML=typeKeys.map((k,i)=>`<div class="leg-item"><div class="leg-dot" style="background:${typeColors[i].slice(0,7)}"></div>${k} (${types[k]})</div>`).join('');

  // RACI
  const roles=['IT App Owner','DDPE','Vendor','IT Support','Business'];
  document.getElementById('tbl-raci').innerHTML=`<thead><tr><th>Activity</th>${roles.map(r=>`<th>${r}</th>`).join('')}</tr></thead>
    <tbody>${[
      ['Incident Mgmt','A','R','C','I','I'],
      ['Problem Mgmt','R','A','C','C','I'],
      ['Change/Release','A','R','I','I','C'],
      ['Capacity Plan','R','A','C','I','I'],
      ['DR Testing','A','R','C','I','I'],
      ['Security Patch','C','A','I','R','I'],
    ].map(([act,...r])=>`<tr><td style="font-weight:600;color:var(--text)">${act}</td>${r.map(v=>`<td style="text-align:center">${badge(v,v==='R'?'var(--accent)':v==='A'?'var(--red)':v==='C'?'var(--yellow)':'var(--muted)')}</td>`).join('')}</tr>`).join('')}</tbody>`;

  // Support Directory
  const owners={};
  apps.forEach(a=>{ const o=a.owner||'TBD'; if(!owners[o])owners[o]=[]; owners[o].push(a); });
  document.getElementById('support-directory').innerHTML=Object.entries(owners).map(([owner,list])=>`
    <div class="support-card">
      <div class="sc-app" style="color:var(--accent)">${owner}</div>
      ${list.slice(0,4).map(a=>`
        <div style="display:flex;justify-content:space-between;align-items:center;padding:4px 0;border-bottom:1px solid rgba(128,128,128,.13)">
          <span style="font-size:12px;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:130px">${a.name}</span>
          <div style="display:flex;gap:4px;flex-shrink:0">${badge(a.support||'Inhouse',a.support==='Vendor'?'var(--blue)':a.support?.includes('+')?'var(--accent2)':'var(--green)')}</div>
        </div>`).join('')}
      ${list.length>4?`<div style="font-size:10px;color:var(--muted);margin-top:4px;font-family:var(--mono)">+${list.length-4} more apps</div>`:''}
    </div>`).join('');
}

// ═══════════════════════════════════════════════════════════════════════════════
// PPM VIEWS
// ═══════════════════════════════════════════════════════════════════════════════

// ─── WAVE OFFSET STATE (shared quarter helpers with Roadmap) ──────────────────
let wvOffset = 0;

function renderPPMWave(){
  const waves={1:[],2:[],3:[]};
  apps.forEach(a=>{ const w=a.wave||3; if(waves[w])waves[w].push(a); });
  const streams={};
  apps.forEach(a=>{ const s=a.stream||'Other'; if(!streams[s])streams[s]=[]; streams[s].push(a); });

  // KPIs
  document.getElementById('wave-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--invest)"><div class="kpi-label">Wave 1 (2025)</div><div class="kpi-value">${waves[1].length}</div><div class="kpi-sub">Highest priority</div></div>
    <div class="kpi" style="--kpi-color:var(--blue)"><div class="kpi-label">Wave 2 (2026)</div><div class="kpi-value">${waves[2].length}</div><div class="kpi-sub">Medium priority</div></div>
    <div class="kpi" style="--kpi-color:var(--muted)"><div class="kpi-label">Wave 3 (2027+)</div><div class="kpi-value">${waves[3].length}</div><div class="kpi-sub">Long-term backlog</div></div>
    <div class="kpi" style="--kpi-color:var(--accent2)"><div class="kpi-label">Streams</div><div class="kpi-value">${Object.keys(streams).length}</div><div class="kpi-sub">Programme streams</div></div>`;

  // Stream cards
  const waveColors={1:'#00d68f',2:'#4a9eff',3:'#8a8fa8'};
  document.getElementById('wave-grid').innerHTML=Object.entries(streams).map(([stream,list])=>{
    const w=Math.min(...list.map(a=>a.wave||3));
    return`<div class="wave-card" style="border-color:${waveColors[w]}">
      <div class="wave-title">${stream}</div>
      <div style="font-size:11px;color:var(--dim);margin-bottom:8px;font-family:var(--mono)">Wave ${w} · ${list.length} apps · ฿${list.reduce((s,a)=>s+a.tco,0).toLocaleString()}K TCO</div>
      ${list.map(a=>`<div class="wave-app">
        <div style="flex:1"><div style="font-size:12px;font-weight:600;color:var(--text)">${a.name}</div>
          <div style="font-size:10px;color:var(--dim);font-family:var(--mono)">${a.approach} · Wave ${a.wave}</div></div>
        ${badge(a.status,statusColor[a.status]||'var(--muted)')}
      </div>`).join('')}
    </div>`;
  }).join('');

  // Render timeline with navigator
  _renderWaveTimeline(waves, waveColors);
  _wvWireNav(waves, waveColors);
}

function _renderWaveTimeline(waves, waveColors){
  // Reuse Roadmap quarter helpers (rmTodayQtr, rmQtrAdd, rmQtrToFloat, rmQtrLabel, _rmBarPct, _rmTodayPct)
  const today     = rmTodayQtr();
  const viewStart = rmQtrAdd(today, -RM_BACK  + wvOffset);
  const viewEnd   = rmQtrAdd(today,  RM_AHEAD + wvOffset);

  // Update range label
  const label = document.getElementById('wv-range-label');
  if(label) label.textContent = `${rmQtrLabel(viewStart)} – ${rmQtrLabel(viewEnd)}`;

  // Quarter headers
  const qtrs = [];
  for(let i = 0; i < RM_VISIBLE; i++) qtrs.push(rmQtrAdd(viewStart, i));

  document.getElementById('wv-headers').innerHTML =
    `<div style="display:flex;margin-left:192px;margin-bottom:6px;position:relative">` +
    qtrs.map(q => {
      const isCur = q.year===today.year && q.q===today.q;
      return `<div class="rm-qtr${isCur?' current-qtr':''}">${rmQtrLabel(q)}</div>`;
    }).join('') + `</div>`;

  // Today line
  const todayPct = _rmTodayPct(today, viewStart, viewEnd);
  const existingLine = document.getElementById('wv-today-line');
  if(existingLine) existingLine.remove();
  const timelineEl = document.getElementById('wave-timeline');
  timelineEl.style.position = 'relative';
  if(todayPct >= 0 && todayPct <= 100){
    const line = document.createElement('div');
    line.id = 'wv-today-line';
    line.style.cssText = `position:absolute;top:0;bottom:0;width:2px;pointer-events:none;z-index:10;
      left:calc(192px + (100% - 192px) * ${todayPct/100});
      background:rgba(0,229,255,.7);`;
    line.innerHTML = `<span style="position:absolute;top:-20px;left:50%;transform:translateX(-50%);
      font-size:9px;font-weight:700;color:var(--accent);font-family:var(--mono);
      white-space:nowrap;background:var(--card);padding:1px 5px;border-radius:3px;
      border:1px solid rgba(0,229,255,.3)">Today</span>`;
    timelineEl.parentElement.insertBefore(line, timelineEl);
  }

  // Wave → anchor quarters (Wave 1 = today Q, Wave 2 = today+4Q, Wave 3 = today+8Q)
  const waveAnchors = { 1: 0, 2: 4, 3: 8 };
  // Bar spans per wave (in quarters duration)
  const waveSpans  = { 1: 4, 2: 5, 3: 5 };

  const tLines = [
    ...waves[1].slice(0,10).map(a=>({...a})),
    ...waves[2].slice(0,10).map(a=>({...a})),
    ...waves[3].slice(0,8).map(a=>({...a})),
  ];

  timelineEl.innerHTML = tLines.map(r => {
    const w        = r.wave || 3;
    const anchor   = waveAnchors[w] ?? 0;
    const span     = waveSpans[w] ?? 4;
    const barStart = rmQtrAdd(today, anchor);
    const barEnd   = rmQtrAdd(today, anchor + span);

    const pctStart = _rmBarPct(barStart, viewStart, viewEnd);
    const pctEnd   = _rmBarPct(barEnd,   viewStart, viewEnd);

    if(pctEnd <= 0 || pctStart >= 100) return '';

    const clampedStart = Math.max(0,   pctStart);
    const clampedEnd   = Math.min(100, pctEnd);
    const width        = clampedEnd - clampedStart;
    if(width <= 0) return '';

    const clippedL = pctStart < 0   ? ' clipped-left'  : '';
    const clippedR = pctEnd   > 100 ? ' clipped-right' : '';

    return `<div class="rm-row">
      <div class="rm-label">
        <div class="name" title="${r.name}">${r.name}</div>
        <div class="domain">${r.stream||r.domain}</div>
      </div>
      <div class="rm-track">
        <div class="rm-bar${clippedL}${clippedR}"
             style="left:${clampedStart.toFixed(2)}%;width:${width.toFixed(2)}%;background:${waveColors[w]};box-shadow:inset 0 1px 0 rgba(255,255,255,.2)"
             title="${r.name} | Wave ${w} | ${r.approach} | ${rmQtrLabel(barStart)} → ${rmQtrLabel(barEnd)}">
          <span class="rm-bar-label">Wave ${w} · ${r.approach}</span>
        </div>
      </div>
    </div>`;
  }).join('') || '<div class="rm-empty">ไม่มีข้อมูลในช่วงเวลานี้</div>';
}

function _wvWireNav(waves, waveColors){
  const prev     = document.getElementById('wv-prev');
  const next     = document.getElementById('wv-next');
  const todayBtn = document.getElementById('wv-today');
  if(prev && !prev.__wired){
    prev.__wired = true;
    prev.addEventListener('click',     () => { wvOffset--; _renderWaveTimeline(waves, waveColors); });
    next.addEventListener('click',     () => { wvOffset++; _renderWaveTimeline(waves, waveColors); });
    todayBtn.addEventListener('click', () => { wvOffset=0; _renderWaveTimeline(waves, waveColors); });
  }
}

// ── PAPER OUT — Wave Timeline PDF ─────────────────────────────────────────────
function wavePaperOut(){
  const btn = document.getElementById('btn-wave-paper-out');
  btn.classList.add('loading');
  btn.querySelector('.paper-out-label').textContent = 'กำลังสร้าง PDF…';

  function loadScript(src){ return new Promise((res,rej)=>{ if(document.querySelector(`script[src="${src}"]`)){ res(); return; } const s=document.createElement('script'); s.src=src; s.onload=res; s.onerror=()=>rej(new Error('โหลด library ไม่ได้: '+src)); document.head.appendChild(s); }); }

  Promise.all([
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js'),
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js')
  ])
  .then(() => _doWavePaperOut(btn))
  .catch(err => {
    alert('❌ โหลด library ไม่ได้\n' + err.message);
    btn.classList.remove('loading');
    btn.querySelector('.paper-out-label').textContent = 'Paper Out';
  });
}

async function _doWavePaperOut(btn){
  const { jsPDF } = window.jspdf;
  // Capture the whole wave card (timeline card only)
  const cardEl   = document.querySelector('#view-ppm-wave .card');
  const html     = document.documentElement;
  const prevTheme = html.getAttribute('data-theme');
  html.setAttribute('data-theme', 'light');

  // Temporarily expand timeline height
  const tlEl = document.getElementById('wave-timeline');
  const prevMaxH = tlEl.style.maxHeight;
  tlEl.style.maxHeight = 'none';
  btn.style.visibility = 'hidden';

  await new Promise(r => setTimeout(r, 150));

  try {
    const canvas = await html2canvas(cardEl, {
      scale: 2, useCORS: true, logging: false,
      backgroundColor: '#ffffff',
      width: cardEl.scrollWidth, height: cardEl.scrollHeight,
      windowWidth: cardEl.scrollWidth, scrollX: 0, scrollY: 0,
    });

    const pdf    = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });
    const pdfW   = pdf.internal.pageSize.getWidth();
    const pdfH   = pdf.internal.pageSize.getHeight();
    const margin = 10;
    const headerH = 16;
    const footerH = 8;
    const usableW = pdfW - margin * 2;
    const usableH = pdfH - margin * 2 - headerH - footerH;

    const imgW      = canvas.width;
    const imgH      = canvas.height;
    const ratio     = usableW / (imgW / 2);
    const pxPerPage = (usableH / ratio) * 2;
    const totalPages = Math.ceil(imgH / pxPerPage);

    const rangeLabel = document.getElementById('wv-range-label')?.textContent || '';
    const now = new Date();
    const dateStr = `${now.getDate()}/${now.getMonth()+1}/${now.getFullYear()}`;

    // Count per wave for header
    const waves={1:[],2:[],3:[]};
    apps.forEach(a=>{ const w=a.wave||3; if(waves[w]) waves[w].push(a); });

    for(let page = 0; page < totalPages; page++){
      if(page > 0) pdf.addPage();

      // Header
      pdf.setFillColor(15,52,96);
      pdf.rect(0, 0, pdfW, headerH, 'F');
      pdf.setTextColor(255,255,255);
      pdf.setFontSize(9); pdf.setFont('helvetica','bold');
      pdf.text('MPX Studio', margin, 6.5);
      pdf.setFontSize(7); pdf.setFont('helvetica','normal');
      pdf.setTextColor(0,229,255);
      pdf.text('Wave Programme Timeline', margin, 11.5);
      // Centre — range
      pdf.setFontSize(9); pdf.setFont('helvetica','bold'); pdf.setTextColor(255,255,255);
      pdf.text(rangeLabel, pdfW/2, 7, {align:'center'});
      pdf.setFontSize(7); pdf.setFont('helvetica','normal'); pdf.setTextColor(200,220,255);
      pdf.text(`Wave 1: ${waves[1].length} apps  ·  Wave 2: ${waves[2].length} apps  ·  Wave 3: ${waves[3].length} apps`, pdfW/2, 12, {align:'center'});
      // Right — date + page
      pdf.setTextColor(180,200,240);
      pdf.text(`${dateStr}  |  หน้า ${page+1}/${totalPages}`, pdfW-margin, 12, {align:'right'});

      // Content slice
      const srcY   = page * pxPerPage;
      const srcH   = Math.min(pxPerPage, imgH - srcY);
      const sliceH = (srcH / 2) * ratio;
      const sc     = document.createElement('canvas');
      sc.width = imgW; sc.height = srcH;
      sc.getContext('2d').drawImage(canvas, 0, srcY, imgW, srcH, 0, 0, imgW, srcH);
      pdf.addImage(sc.toDataURL('image/jpeg', 0.92), 'JPEG', margin, headerH+1, usableW, sliceH);

      // Footer
      pdf.setFillColor(245,247,250);
      pdf.rect(0, pdfH-footerH, pdfW, footerH, 'F');
      pdf.setDrawColor(220,225,235);
      pdf.line(0, pdfH-footerH, pdfW, pdfH-footerH);
      pdf.setFontSize(6.5); pdf.setTextColor(120,130,150); pdf.setFont('helvetica','normal');
      pdf.text('MPX Studio EA Portfolio — CONFIDENTIAL', margin, pdfH-3);
      pdf.text(`หน้า ${page+1} จาก ${totalPages}`, pdfW-margin, pdfH-3, {align:'right'});
    }

    const filename = `WaveTimeline_${rangeLabel.replace(/[^a-zA-Z0-9]/g,'_')}_${_today()}.pdf`;
    pdf.save(filename);
    if(typeof showToast !== 'undefined')
      showToast(`✅ Wave Timeline PDF สร้างเสร็จแล้ว — ${filename}`, 'success');

  } catch(err){
    console.error('Wave Paper Out error:', err);
    alert('❌ สร้าง PDF ไม่สำเร็จ: ' + err.message);
  } finally {
    html.setAttribute('data-theme', prevTheme);
    tlEl.style.maxHeight = prevMaxH;
    btn.style.visibility = 'visible';
    btn.classList.remove('loading');
    btn.querySelector('.paper-out-label').textContent = 'Paper Out';
  }
}

function renderPPMDependency(){
  const highInt=apps.filter(a=>a.integration>20).sort((a,b)=>b.integration-a.integration);
  const blocked=apps.filter(a=>['To-retire','Phase-out'].includes(a.status)&&a.integration>15);
  document.getElementById('dep-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--red)"><div class="kpi-label">High Complexity</div><div class="kpi-value">${highInt.length}</div><div class="kpi-sub">>20 integrations</div></div>
    <div class="kpi" style="--kpi-color:var(--yellow)"><div class="kpi-label">Retire-Blocked</div><div class="kpi-value">${blocked.length}</div><div class="kpi-sub">Retiring but heavily integrated</div></div>
    <div class="kpi" style="--kpi-color:var(--accent)"><div class="kpi-label">Total Integration Points</div><div class="kpi-value">${apps.reduce((s,a)=>s+a.integration,0)}</div><div class="kpi-sub">Portfolio-wide</div></div>
    <div class="kpi" style="--kpi-color:var(--accent2)"><div class="kpi-label">Avg Integrations</div><div class="kpi-value">${Math.round(apps.reduce((s,a)=>s+a.integration,0)/apps.length)}</div><div class="kpi-sub">Per application</div></div>`;

  // Complexity chart
  const top15=apps.sort((a,b)=>b.integration-a.integration).slice(0,15);
  destroyChart('depCx');
  charts.depCx=new Chart(document.getElementById('chart-dep-complexity'),{
    type:'bar',
    data:{labels:top15.map(a=>a.name.length>14?a.name.slice(0,14)+'…':a.name),
      datasets:[{data:top15.map(a=>a.integration),backgroundColor:top15.map(a=>a.integration>40?'#ff475788':a.integration>20?'#ffa00088':'#00d68f88'),borderColor:top15.map(a=>a.integration>40?'#ff4757':a.integration>20?'#ffa000':'#00d68f'),borderWidth:1,borderRadius:4,label:'# Integrations'}]},
    options:{...chartOpts(),indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip}}
  });

  // Blocked list
  document.getElementById('dep-blocked').innerHTML=blocked.map(a=>`
    <div class="dep-chain">
      <div style="flex:1"><div style="font-size:12px;font-weight:600;color:var(--text)">${a.name}</div>
        <div style="font-size:10px;color:var(--dim)">${a.domain} · ${a.integration} integrations</div></div>
      <div style="display:flex;gap:4px;flex-direction:column;align-items:flex-end">
        ${badge(a.status,statusColor[a.status]||'var(--muted)')}
        <span style="font-size:10px;color:var(--red);font-family:var(--mono)">🔗 ${a.integration} deps</span>
      </div>
    </div>`).join('');

  // Dependency table
  document.getElementById('tbl-dependency').innerHTML=`<thead><tr><th>Application</th><th>Domain</th><th>Status</th><th>Integration Points</th><th>Criticality</th><th>Dependency Risk</th><th>Recommendation</th></tr></thead>
    <tbody>${apps.sort((a,b)=>b.integration-a.integration).map(a=>{
      const risk=a.integration>40?'CRITICAL':a.integration>20?'HIGH':a.integration>10?'MEDIUM':'LOW';
      const rc={CRITICAL:'var(--red)',HIGH:'var(--yellow)',MEDIUM:'var(--accent)','LOW':'var(--green)'}[risk];
      const rec=risk==='CRITICAL'&&['To-retire','Phase-out'].includes(a.status)?'🛑 Replace first':risk==='HIGH'?'📋 Document all APIs':'✅ Monitor';
      return`<tr><td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td>
        <td style="color:var(--dim);font-size:12px">${escapeHTML(a.domain)}</td>
        <td>${badge(a.status,statusColor[a.status]||'var(--muted)')}</td>
        <td style="text-align:center"><span style="font-family:var(--mono);font-weight:700;color:${rc}">${a.integration}</span></td>
        <td>${badge(a.criticality,a.criticality==='Mission Critical'?'var(--accent2)':'var(--muted)')}</td>
        <td>${badge(risk,rc)}</td>
        <td style="font-size:12px">${rec}</td></tr>`;
    }).join('')}</tbody>`;
}

function renderPPMResource(){
  const approachEff={Build:8,Replace:10,Migrate:7,Modernize:6,Upgrade:4,Extend:3,Grow:4,Retire:2,Invest:5};
  const byApproach={};
  apps.forEach(a=>{ const ap=a.approach||'Upgrade'; if(!byApproach[ap])byApproach[ap]={count:0,tco:0}; byApproach[ap].count++;byApproach[ap].tco+=a.tco; });
  document.getElementById('res-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--accent)"><div class="kpi-label">Build (New)</div><div class="kpi-value">${byApproach['Build']?.count||0}</div><div class="kpi-sub">New development projects</div></div>
    <div class="kpi" style="--kpi-color:var(--yellow)"><div class="kpi-label">Replace/Migrate</div><div class="kpi-value">${(byApproach['Replace']?.count||0)+(byApproach['Migrate']?.count||0)}</div><div class="kpi-sub">Platform migration effort</div></div>
    <div class="kpi" style="--kpi-color:var(--green)"><div class="kpi-label">Inhouse</div><div class="kpi-value">${apps.filter(a=>a.type==='Inhouse').length}</div><div class="kpi-sub">Internal dev required</div></div>
    <div class="kpi" style="--kpi-color:var(--red)"><div class="kpi-label">High Complexity</div><div class="kpi-value">${apps.filter(a=>(approachEff[a.approach||'Upgrade']||5)>=8).length}</div><div class="kpi-sub">Effort estimate ≥ 8/10</div></div>`;

  const apArr=Object.entries(byApproach).sort((a,b)=>b[1].count-a[1].count);
  destroyChart('eff');
  charts.eff=new Chart(document.getElementById('chart-effort'),{
    type:'bar',
    data:{labels:apArr.map(e=>e[0]),
      datasets:[
        {label:'# Apps',data:apArr.map(e=>e[1].count),backgroundColor:isDark()?'#00e5ff44':'#0066cc22',borderColor:'var(--accent)',borderWidth:1,borderRadius:4,yAxisID:'y'},
        {label:'Effort Level',data:apArr.map(e=>approachEff[e[0]]||5),backgroundColor:isDark()?'#ff9f4344':'#c4780022',borderColor:'var(--accent3)',borderWidth:1,borderRadius:4,type:'line',tension:.3,pointRadius:5,yAxisID:'y1'},
      ]},
    options:{...chartOpts(),responsive:true,maintainAspectRatio:false,
      plugins:{legend:{labels:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:10}}},tooltip:chartOpts().plugins.tooltip},
      scales:{x:chartOpts().scales.x,y:{...chartOpts().scales.y,position:'left',beginAtZero:true},y1:{...chartOpts().scales.y,position:'right',max:10,grid:{display:false}}}}
  });

  // Skills radar
  const skillDomains=['Python/AI','Java/Spring','ABAP/SAP','JavaScript','COBOL/RPG','.NET/C#','K8s/Cloud'];
  const skillCounts=skillDomains.map(s=>{
    const kwMap={'Python/AI':['Python','TensorFlow','LangChain'],'Java/Spring':['Java','Spring'],'ABAP/SAP':['ABAP','SAP'],'JavaScript':['JavaScript','React','Node'],'COBOL/RPG':['COBOL','RPG','ILE'],'.NET/C#':['C#','.NET'],'K8s/Cloud':['Kubernetes','Helm','Terraform']};
    return apps.filter(a=>(a.stack||[]).some(st=>kwMap[s]?.some(k=>st.includes(k)))).length;
  });
  destroyChart('skl');
  charts.skl=new Chart(document.getElementById('chart-skills'),{
    type:'radar',
    data:{labels:skillDomains,datasets:[{label:'Apps Requiring Skill',data:skillCounts,backgroundColor:isDark()?'rgba(0,229,255,.15)':'rgba(0,102,204,.1)',borderColor:'var(--accent)',borderWidth:2,pointBackgroundColor:'var(--accent)'}]},
    options:{responsive:true,maintainAspectRatio:false,
      plugins:{legend:{labels:{color:isDark()?'#6b84a0':'#5872a0',font:{family:'JetBrains Mono',size:11}}},tooltip:chartOpts().plugins.tooltip},
      scales:{r:{ticks:{color:isDark()?'#6b84a0':'#5872a0',backdropColor:'transparent',font:{family:'JetBrains Mono',size:9}},grid:{color:isDark()?'rgba(26,45,71,.5)':'rgba(180,200,230,.4)'},pointLabels:{color:isDark()?'#dde6f0':'#1a2540',font:{family:'Syne',size:11,weight:'600'}}}}}
  });

  // Complexity table
  document.getElementById('tbl-complexity').innerHTML=`<thead><tr><th>Application</th><th>Type</th><th>Approach</th><th>Effort</th><th>Source Code</th><th>Stream</th><th>Wave</th><th>Skill Requirements</th></tr></thead>
    <tbody>${apps.sort((a,b)=>(approachEff[b.approach||'Upgrade']||5)-(approachEff[a.approach||'Upgrade']||5)).map(a=>{
      const eff=approachEff[a.approach||'Upgrade']||5;
      const effBar=`<div style="display:flex;align-items:center;gap:6px"><div class="hbar-wrap" style="width:60px;height:6px"><div class="hbar-fill" style="width:${eff*10}%;background:${eff>=8?'var(--red)':eff>=5?'var(--yellow)':'var(--green)'}"></div></div><span style="font-family:var(--mono);font-size:11px;color:${eff>=8?'var(--red)':'var(--text)'}">${eff}/10</span></div>`;
      return`<tr><td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td>
        <td>${badge(a.type,a.type==='Inhouse'?'var(--green)':'var(--blue)')}</td>
        <td>${badge(a.approach||'TBD','var(--accent)')}</td>
        <td>${effBar}</td>
        <td style="text-align:center;font-size:14px;color:${a.srcAvail?'var(--green)':'var(--red)'}">${a.srcAvail?'✓':'✗'}</td>
        <td style="font-size:11px;color:var(--dim)">${escapeHTML(a.stream||'N/A')}</td>
        <td style="text-align:center">${badge(`W${a.wave||3}`,a.wave===1?'var(--invest)':a.wave===2?'var(--blue)':'var(--muted)')}</td>
        <td style="font-size:11px;color:var(--dim)">${escapeHTML((a.stack||[]).slice(0,2).join(', '))}</td></tr>`;
    }).join('')}</tbody>`;
}

function renderPPMAssessment(){
  const statusCounts={'Completed':0,'In Progress':0,'Planned':0,'Not Started':0};
  apps.forEach(a=>{ const s=a.assessStatus||'Not Started'; if(statusCounts[s]!==undefined)statusCounts[s]++;else statusCounts['Not Started']++; });
  const overdue=apps.filter(a=>a.assessStatus==='Completed'&&a.assessDate&&new Date(a.assessDate+'-01')<new Date('2024-01-01')).length;
  document.getElementById('assess-kpis').innerHTML=`
    <div class="kpi" style="--kpi-color:var(--green)"><div class="kpi-label">Completed</div><div class="kpi-value">${statusCounts['Completed']}</div><div class="kpi-sub">Assessment done</div></div>
    <div class="kpi" style="--kpi-color:var(--yellow)"><div class="kpi-label">In Progress</div><div class="kpi-value">${statusCounts['In Progress']}</div><div class="kpi-sub">Currently assessing</div></div>
    <div class="kpi" style="--kpi-color:var(--muted)"><div class="kpi-label">Not Started</div><div class="kpi-value">${statusCounts['Not Started']}</div><div class="kpi-sub">Needs scheduling</div></div>
    <div class="kpi" style="--kpi-color:var(--red)"><div class="kpi-label">Overdue (>1y)</div><div class="kpi-value">${overdue}</div><div class="kpi-sub">Assessment expired</div></div>`;

  const scColors={'Completed':'#00d68f','In Progress':'#4a9eff','Planned':'#ffa000','Not Started':'#6b84a0'};
  destroyChart('assSt');
  charts.assSt=new Chart(document.getElementById('chart-assess-status'),{
    type:'doughnut',
    data:{labels:Object.keys(statusCounts),datasets:[{data:Object.values(statusCounts),backgroundColor:Object.values(scColors).map(c=>c+'88'),borderColor:Object.values(scColors),borderWidth:2}]},
    options:{responsive:true,maintainAspectRatio:false,cutout:'55%',plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip}}
  });
  document.getElementById('assess-legend').innerHTML=Object.keys(statusCounts).map(k=>`<div class="leg-item"><div class="leg-dot" style="background:${scColors[k]}"></div>${k} (${statusCounts[k]})</div>`).join('');

  // Timeline bar
  const byQtr={'2024 H1':0,'2024 H2':0,'2025 H1':0,'2025 H2+':0,'Not Scheduled':0};
  apps.forEach(a=>{
    if(!a.assessDate){byQtr['Not Scheduled']++;return;}
    const y=parseInt(a.assessDate.split('-')[0]),m=parseInt(a.assessDate.split('-')[1]);
    if(y===2024&&m<=6)byQtr['2024 H1']++;else if(y===2024)byQtr['2024 H2']++;else if(y===2025&&m<=6)byQtr['2025 H1']++;else byQtr['2025 H2+']++;
  });
  destroyChart('assT');
  charts.assT=new Chart(document.getElementById('chart-assess-timeline'),{
    type:'bar',
    data:{labels:Object.keys(byQtr),datasets:[{data:Object.values(byQtr),backgroundColor:['#00d68f88','#00d68f66','#4a9eff88','#ffa00088','#6b84a088'],borderRadius:4}]},
    options:{...chartOpts(),responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:chartOpts().plugins.tooltip}}
  });

  // Assessment Register
  document.getElementById('tbl-assessment').innerHTML=`<thead><tr><th>Application</th><th>Domain</th><th>Criticality</th><th>Assessment Status</th><th>Last Assessed</th><th>Wave</th><th>Approach</th><th>Action</th></tr></thead>
    <tbody>${apps.sort((a,b)=>{
      const order={'Not Started':0,'Planned':1,'In Progress':2,'Completed':3};
      return (order[a.assessStatus||'Not Started']||0)-(order[b.assessStatus||'Not Started']||0);
    }).map(a=>{
      const sc=scColors[a.assessStatus||'Not Started']||'#6b84a0';
      const ageDays=a.assessDate?Math.round((new Date()-(new Date(a.assessDate+'-01')))/(1000*60*60*24)):null;
      const stale=ageDays&&ageDays>365;
      const action=!a.assessDate?'📅 Schedule':stale?'🔄 Re-assess':a.assessStatus==='Not Started'?'🚀 Initiate':'✅ OK';
      return`<tr><td style="font-weight:600;color:var(--text)">${escapeHTML(a.name)}</td>
        <td style="color:var(--dim);font-size:12px">${escapeHTML(a.domain)}</td>
        <td>${badge(a.criticality,a.criticality==='Mission Critical'?'var(--accent2)':'var(--muted)')}</td>
        <td>${badge(a.assessStatus||'Not Started',sc)}</td>
        <td style="font-size:11px;font-family:var(--mono);color:${stale?'var(--red)':'var(--dim)'}">${escapeHTML(a.assessDate||'—')}${stale?' ⚠️':''}</td>
        <td style="text-align:center">${badge(`W${a.wave||3}`,a.wave===1?'var(--invest)':a.wave===2?'var(--blue)':'var(--muted)')}</td>
        <td>${badge(a.approach||'TBD','var(--accent)')}</td>
        <td style="font-size:12px">${action}</td></tr>`;
    }).join('')}</tbody>`;
}

// ─── APP INSIGHT ──────────────────────────────────────────────────────────────
let insightSelectedId = null;

function renderAppInsight(){
  // Populate dropdown (once)
  const sel = document.getElementById('insight-app-select');
  if(sel.options.length <= 1){
    const sorted = [...apps].filter(a=>!a.decommissioned).sort((a,b)=>a.id.localeCompare(b.id));
    const decomm = apps.filter(a=>a.decommissioned);
    sorted.forEach(a=>{
      const o = document.createElement('option');
      o.value = a.id;
      o.textContent = `${a.id}  —  ${a.name}`;
      sel.appendChild(o);
    });
    if(decomm.length){
      const og = document.createElement('optgroup');
      og.label = '— Decommissioned —';
      decomm.forEach(a=>{
        const o = document.createElement('option');
        o.value = a.id;
        o.textContent = `${a.id}  —  ${a.name}  [Decommissioned]`;
        og.appendChild(o);
      });
      sel.appendChild(og);
    }
    sel.addEventListener('change', ()=>{
      insightSelectedId = sel.value;
      renderInsightReport(insightSelectedId);
    });
  }
  // Restore last selection
  if(insightSelectedId){
    sel.value = insightSelectedId;
    renderInsightReport(insightSelectedId);
  }
}

function renderInsightReport(appId){
  const content = document.getElementById('insight-content');
  const badge   = document.getElementById('insight-app-badge');

  if(!appId){
    badge.style.display = 'none';
    document.getElementById('btn-paper-out').style.display = 'none';
    content.innerHTML = `<div class="insight-empty">
      <div class="insight-empty-icon">🔬</div>
      <div class="insight-empty-title">App Insight Report</div>
      <div class="insight-empty-sub">เลือกแอปพลิเคชันจาก dropdown ด้านบนเพื่อดูรายละเอียดและการวิเคราะห์เชิงลึก</div>
    </div>`;
    return;
  }

  const a = apps.find(x=>x.id===appId);
  if(!a) return;

  // ── helpers ──
  const statusColor  = {Active:'var(--green)',"Phase-out":'var(--yellow)',"To-retire":'var(--red)',Planned:'var(--accent)',Decommissioned:'var(--muted)'};
  const critColor    = {'Mission Critical':'var(--red)',High:'var(--yellow)',Medium:'var(--accent)',Low:'var(--green)'};
  const bcgColor2    = {Invest:'var(--invest)',Grow:'var(--blue)',Tolerate:'var(--tolerate)',Retire:'var(--retire)'};
  const sc = statusColor[a.status]||'var(--muted)';
  const cc = critColor[a.criticality]||'var(--dim)';
  const bc = bcgColor2[a.bcg]||'var(--dim)';
  const hc = a.health>=80?'var(--green)':a.health>=60?'var(--yellow)':'var(--red)';
  const td = a.techDebt||(100-a.health);

  // Header badge
  badge.style.display = 'flex';
  badge.innerHTML = `<span class="insight-app-badge" style="background:${sc}18;color:${sc};border:1px solid ${sc}44">${a.status}</span>`;

  // ── Analysis engine ──
  const findings = [];

  // Health & Tech Debt
  if(a.health < 50)       findings.push({type:'risk', icon:'🔴', title:'Health Score วิกฤต', desc:`Health อยู่ที่ ${a.health}/100 ต่ำกว่าเกณฑ์ขั้นต่ำ 60 มาก — ต้องการแผน remediation ทันที`});
  else if(a.health < 70)  findings.push({type:'warn', icon:'🟡', title:'Health Score ต่ำกว่าเกณฑ์', desc:`Health ${a.health}/100 — ควรวางแผน Technical Debt reduction ใน roadmap ถัดไป`});
  else if(a.health >= 85) findings.push({type:'good', icon:'🟢', title:'Health Score ดีเยี่ยม', desc:`Health ${a.health}/100 อยู่ในระดับดี — ควรรักษาระดับนี้ด้วยการ maintenance สม่ำเสมอ`});

  if(td > 60)             findings.push({type:'risk', icon:'⚠️', title:'Technical Debt สูงมาก', desc:`Tech Debt สะสม ${td}% — มีความเสี่ยงสูงที่จะเป็นอุปสรรคต่อการพัฒนาในอนาคต`});
  else if(td > 35)        findings.push({type:'warn', icon:'🔧', title:'Technical Debt ปานกลาง', desc:`Tech Debt อยู่ที่ ${td}% — ควรจัดสรรเวลา refactoring ใน sprint ถัดไป`});

  // Age
  if(a.age > 15)          findings.push({type:'risk', icon:'🏚', title:'ระบบเก่ามาก', desc:`อายุระบบ ${a.age} ปี สูงเกินเกณฑ์อนุโลม 15 ปี — ความเสี่ยงด้าน End-of-Life และ vendor support สูง`});
  else if(a.age > 8)      findings.push({type:'warn', icon:'📅', title:'ระบบมีอายุมาก', desc:`อายุ ${a.age} ปี ควรวางแผน modernization หรือ migration ใน 2–3 ปีข้างหน้า`});

  // EoL
  const now = new Date();
  if(a.eol){
    const eolDate = new Date(a.eol + '-01');
    const monthsLeft = (eolDate - now) / (1000*60*60*24*30);
    if(monthsLeft < 0)    findings.push({type:'risk', icon:'💀', title:'End-of-Life ผ่านแล้ว', desc:`EoL ผ่านมาแล้ว (${a.eol}) — ระบบอาจไม่ได้รับ security patch และ vendor support อีกต่อไป`});
    else if(monthsLeft<12) findings.push({type:'risk', icon:'⏰', title:`EoL ใกล้มาถึง (${Math.ceil(monthsLeft)} เดือน)`, desc:`End-of-Life คือ ${a.eol} — ต้องเร่งวางแผน migration หรือ upgrade โดยด่วน`});
    else if(monthsLeft<24) findings.push({type:'warn', icon:'📆', title:`EoL ภายใน 2 ปี (${a.eol})`, desc:'ควรเริ่มวางแผน modernization เพื่อหลีกเลี่ยงการทำงานบนระบบที่ไม่ได้รับการ support'});
  }

  // Criticality vs DR
  if(a.criticality==='Mission Critical' && !a.dr)
    findings.push({type:'risk', icon:'🚨', title:'Mission Critical ไม่มี DR!', desc:'ระบบ Mission Critical แต่ไม่มี Disaster Recovery — ความเสี่ยงสูงมากต่อธุรกิจ ต้องแก้ไขทันที'});
  else if(a.criticality==='High' && !a.dr)
    findings.push({type:'warn', icon:'⚡', title:'ระบบ High Criticality ไม่มี DR', desc:'ควรพิจารณาวาง DR Plan สำหรับระบบที่มี criticality สูงระดับนี้'});
  else if(a.dr)
    findings.push({type:'good', icon:'🛡', title:'มี Disaster Recovery Plan', desc:`ระบบ ${a.criticality} มี DR — ความต่อเนื่องทางธุรกิจอยู่ในระดับที่ยอมรับได้`});

  // TCO
  const avgTCO = apps.reduce((s,x)=>s+x.tco,0)/apps.length;
  if(a.tco > avgTCO*2)
    findings.push({type:'warn', icon:'💰', title:'TCO สูงกว่าค่าเฉลี่ยมาก', desc:`TCO ฿${a.tco.toLocaleString()}K สูงกว่าค่าเฉลี่ย (฿${Math.round(avgTCO).toLocaleString()}K) ถึง ${Math.round(a.tco/avgTCO*100-100)}% — ควรทบทวนความคุ้มค่า`});
  else if(a.tco < avgTCO*0.4 && a.criticality==='Mission Critical')
    findings.push({type:'warn', icon:'💸', title:'งบลงทุนต่ำสำหรับระบบ Mission Critical', desc:`TCO เพียง ฿${a.tco.toLocaleString()}K อาจไม่เพียงพอสำหรับการดูแลระบบ Mission Critical อย่างเหมาะสม`});

  // Strategic score
  if(a.strategic && a.strategic < 40 && a.bcg !== 'Retire')
    findings.push({type:'warn', icon:'🎯', title:'Strategic Score ต่ำ', desc:`Strategic value เพียง ${a.strategic}/100 — ควรพิจารณา retire หรือ replace ด้วยระบบที่ตอบโจทย์กลยุทธ์มากกว่า`});
  else if(a.strategic >= 80)
    findings.push({type:'good', icon:'⭐', title:'Strategic Value สูง', desc:`Strategic score ${a.strategic}/100 — ระบบนี้มีคุณค่าเชิงกลยุทธ์สูง ควรลงทุนต่อเนื่อง`});

  // BCG
  if(a.bcg==='Retire')
    findings.push({type:'risk', icon:'🗑', title:'กำหนด Retire ใน BCG', desc:'ระบบนี้ถูกจัดอยู่ใน BCG Quadrant Retire — ควรมีแผน decommission ที่ชัดเจนพร้อม timeline'});
  else if(a.bcg==='Invest')
    findings.push({type:'good', icon:'📈', title:'BCG Quadrant: Invest', desc:'ระบบนี้ได้รับการจัดลำดับความสำคัญด้านการลงทุน — เหมาะสำหรับ feature development และ modernization'});

  // Integration complexity
  if(a.integration > 20)
    findings.push({type:'warn', icon:'🔗', title:`Integration ซับซ้อน (${a.integration} connections)`, desc:'จำนวน integration สูง — การเปลี่ยนแปลงใดๆ จะมี impact กว้าง ต้องวางแผน change management อย่างรอบคอบ'});

  // Contract
  if(a.contractEnd && a.contractEnd !== 'N/A'){
    const ctDate = new Date(a.contractEnd + '-01');
    const mLeft = (ctDate - now) / (1000*60*60*24*30);
    if(mLeft < 6)  findings.push({type:'risk', icon:'📋', title:`Contract หมดใน ${Math.max(0,Math.ceil(mLeft))} เดือน`, desc:`Contract หมดอายุ ${a.contractEnd} — ต้องเจรจาต่อสัญญาหรือหาทางเลือกใหม่โดยด่วน`});
    else if(mLeft<12) findings.push({type:'warn', icon:'📝', title:`Contract ใกล้หมด (${a.contractEnd})`, desc:'ควรเริ่มกระบวนการต่อสัญญาหรือประเมินทางเลือกอื่น'});
  }

  // Source code
  if(!a.srcAvail && a.type==='Inhouse')
    findings.push({type:'risk', icon:'💾', title:'ไม่มี Source Code สำหรับ Inhouse System', desc:'ระบบพัฒนาภายในแต่ไม่มี source code — ความเสี่ยงสูงมากต่อ maintainability และ knowledge retention'});

  // Persons
  if(a.persons <= 1)
    findings.push({type:'warn', icon:'👤', title:'ผู้ดูแลระบบน้อยเกินไป', desc:`มีผู้ดูแลเพียง ${a.persons} คน — ความเสี่ยง single point of failure สูง ควรวาง knowledge transfer plan`});

  if(findings.length === 0)
    findings.push({type:'good', icon:'✅', title:'ผ่านเกณฑ์ทุกด้าน', desc:'ระบบนี้ผ่านการตรวจสอบทุกมิติในระดับที่ดี — ควรรักษาระดับมาตรฐานนี้ต่อไป'});

  // ── Render ──
  const stackTags = (a.stack||[]).map(s=>`<span class="insight-stack-tag">${s}</span>`).join('');
  const eaPath = [a.eaGroup, a.eaCategory, a.eaSubCategory&&a.eaSubCategory!=='-'?a.eaSubCategory:null].filter(Boolean).join(' › ');

  // ── Compliance badges ──
  const _compColors = {'ISO 27001':'#4a9eff','PDPA':'#7b61ff','DR Policy':'#f97316','API Standards':'#00d4ff','Cloud-First':'#00d68f','Zero-Trust':'#ff4757'};
  const compList = Array.isArray(a.compliance) ? a.compliance : [];
  const compBadges = compList.length
    ? compList.map(c=>{const col=_compColors[c]||'#888';return`<span style="display:inline-block;padding:3px 9px;border-radius:12px;font-size:10px;font-weight:700;letter-spacing:.2px;background:${col}18;color:${col};border:1px solid ${col}44;white-space:nowrap">${c}</span>`;}).join('')
    : '<span style="font-size:11px;color:var(--dim);font-style:italic">ยังไม่ระบุ</span>';

  const gauge = (label, val, color, max=100) => `
    <div class="insight-gauge-wrap">
      <div class="insight-gauge-label">
        <span>${label}</span><span style="color:${color}">${val}${max===100?'%':''}</span>
      </div>
      <div class="insight-gauge-track">
        <div class="insight-gauge-fill" style="width:${Math.min(100,val/max*100)}%;background:${color}"></div>
      </div>
    </div>`;

  const row = (k,v) => `<div class="insight-row"><span class="insight-row-key">${k}</span><span class="insight-row-val">${v||'—'}</span></div>`;
  const batchBadge = (t,c) => `<span class="badge" style="background:${c}18;color:${c};border:1px solid ${c}44">${t}</span>`;

  const findingsHtml = findings.map(f=>`
    <div class="insight-finding ${f.type}">
      <div class="insight-finding-icon">${f.icon}</div>
      <div class="insight-finding-body">
        <div class="insight-finding-title">${f.title}</div>
        <div class="insight-finding-desc">${f.desc}</div>
      </div>
    </div>`).join('');

  const riskCount = findings.filter(f=>f.type==='risk').length;
  const warnCount = findings.filter(f=>f.type==='warn').length;
  const goodCount = findings.filter(f=>f.type==='good').length;

  // Overall risk level
  const overallRisk = riskCount>=3?['Critical','var(--red)']:riskCount>=1?['High','var(--yellow)']:warnCount>=3?['Medium','var(--yellow)']:['Low','var(--green)'];

  content.innerHTML = `
  <div class="insight-report">

    ${a.decommissioned?`<div class="insight-decomm-banner">🔴 แอปพลิเคชันนี้ถูก Decommission แล้ว — วันที่: ${a.decommDate||'ไม่ระบุ'} | เหตุผล: ${a.decommReason||'ไม่ระบุ'}</div>`:''}

    <!-- Header -->
    <div class="insight-header">
      <div class="insight-header-icon" style="background:${bc}22;color:${bc};border:1px solid ${bc}44">${a.id.split('-')[1]}</div>
      <div class="insight-header-main">
        <div class="insight-app-name">${a.name}</div>
        <div class="insight-app-id">${a.id} · ${a.vendor} · ${a.domain}</div>
        <div class="insight-badges">
          ${batchBadge(a.status, sc)}
          ${batchBadge(a.bcg, bc)}
          ${batchBadge(a.criticality, cc)}
          ${batchBadge(a.type, 'var(--dim)')}
          ${a.dr?batchBadge('DR ✓','var(--green)'):''}
          ${a.piSpi?batchBadge('PI/SPI','var(--accent)'):''}
        </div>
      </div>
      <div class="insight-header-right">
        <div class="insight-score-big" style="color:${hc}">${a.health}</div>
        <div class="insight-score-label">Health Score</div>
        <div style="display:flex;gap:6px;margin-top:8px">
          <span style="font-size:11px;background:rgba(255,71,87,.12);color:var(--red);border-radius:6px;padding:4px 10px;font-family:var(--mono)">⚠ ${riskCount} Risk</span>
          <span style="font-size:11px;background:rgba(255,159,67,.1);color:var(--yellow);border-radius:6px;padding:4px 10px;font-family:var(--mono)">! ${warnCount} Warn</span>
          <span style="font-size:11px;background:rgba(0,214,143,.1);color:var(--green);border-radius:6px;padding:4px 10px;font-family:var(--mono)">✓ ${goodCount} Good</span>
        </div>
      </div>
    </div>

    <!-- KPI row -->
    <div class="insight-grid-3">
      <!-- Performance -->
      <div class="insight-card">
        <div class="insight-card-title">📊 Performance & Health</div>
        ${gauge('Health Score', a.health, hc)}
        ${gauge('Technical Debt', td, td>60?'var(--red)':td>35?'var(--yellow)':'var(--green)')}
        ${gauge('Strategic Value', a.strategic||70, 'var(--accent)')}
        <div style="margin-top:10px">
          ${row('BCG Quadrant', `<span style="color:${bc};font-weight:700">${a.bcg}</span>`)}
          ${row('Assess Status', a.assessStatus||'—')}
          ${row('Assessment Wave', a.wave?`Wave ${a.wave}`:'—')}
        </div>
      </div>

      <!-- Identity -->
      <div class="insight-card">
        <div class="insight-card-title">🏷 App Identity</div>
        ${row('App ID', `<span style="font-family:var(--mono);color:var(--accent)">${a.id}</span>`)}
        ${row('ชื่อแอป', a.name)}
        ${row('Domain', a.domain||'—')}
        ${row('Vendor', a.vendor||'—')}
        ${row('Type', a.type||'—')}
        ${row('Criticality', `<span style="color:${cc};font-weight:700">${a.criticality}</span>`)}
        ${row('Status', `<span style="color:${sc};font-weight:700">${a.status}</span>`)}
        ${row('DR Required', a.dr?'<span style="color:var(--green)">✓ Yes</span>':'<span style="color:var(--red)">✗ No</span>')}
      </div>

      <!-- Risk Summary -->
      <div class="insight-card">
        <div class="insight-card-title">⚡ Risk Overview</div>
        <div style="display:flex;justify-content:center;gap:16px;padding:12px 0 16px">
          ${[['Risk',riskCount,'var(--red)'],['Warn',warnCount,'var(--yellow)'],['Good',goodCount,'var(--green)']].map(([l,n,c])=>`
          <div style="text-align:center">
            <div style="font-size:32px;font-weight:900;font-family:var(--mono);color:${c}">${n}</div>
            <div style="font-size:11px;color:var(--dim)">${l}</div>
          </div>`).join('')}
        </div>
        ${row('Overall Risk Level', `<span style="color:${overallRisk[1]};font-weight:700">${overallRisk[0]}</span>`)}
        ${row('System Age', `${a.age} ปี`)}
        ${row('EoL Date', a.eol||'—')}
        ${row('Contract End', a.contractEnd||'—')}
        ${row('PI/SPI Impact', a.piSpi?'<span style="color:var(--red)">Yes</span>':'No')}
      </div>
    </div>

    <!-- Middle row: Technical + Business + EA -->
    <div class="insight-grid-3">
      <!-- Technical -->
      <div class="insight-card">
        <div class="insight-card-title">⚙️ Technical Details</div>
        ${row('Language', a.lang||'—')}
        ${row('Operating System', a.os||'—')}
        ${row('Database', a.db||'—')}
        ${row('Service Hour', a.serviceHour||'—')}
        ${row('Maint. Window', a.maintWindow||'—')}
        ${row('Source Code', a.srcAvail?'<span style="color:var(--green)">✓ Available</span>':'<span style="color:var(--red)">✗ Not Available</span>')}
        ${row('Support Type', a.support||'—')}
        <div class="insight-row" style="flex-direction:column;align-items:flex-start;gap:6px">
          <span class="insight-row-key">Tech Stack</span>
          <div class="insight-stack-wrap">${stackTags||'<span style="color:var(--muted);font-size:11px">—</span>'}</div>
        </div>
      </div>

      <!-- Business -->
      <div class="insight-card">
        <div class="insight-card-title">💼 Business Information</div>
        ${row('Business Capability', a.capability||'—')}
        ${row('Project Stream', a.stream||'—')}
        ${row('Approach', a.approach||'—')}
        ${row('Active Users', (a.users||0).toLocaleString())}
        ${row('Annual TCO', `฿${(a.tco||0).toLocaleString()}K`)}
        ${row('No. of Integrations', a.integration||0)}
        ${row('Business App Owner', a.bizOwner||'—')}
        ${row('IT App Owner', a.owner||'—')}
        ${row('No. of Persons', a.persons||'—')}
        ${row('Assess Date', a.assessDate||'—')}
        ${row('Last Updated', a.lastUpdated||'—')}
      </div>

      <!-- EA Landscape -->
      <div class="insight-card">
        <div class="insight-card-title">🏛 EA Landscape Position</div>
        <div style="margin-bottom:14px">
          <div style="font-size:11px;color:var(--dim);margin-bottom:6px">EA Path</div>
          <div style="font-size:12px;color:var(--text);line-height:1.8;font-weight:600">${eaPath||'ยังไม่ได้กำหนด'}</div>
        </div>
        ${row('EA Group', a.eaGroup?`<span style="font-weight:700;color:var(--accent2)">${a.eaGroup}</span>`:'—')}
        ${row('EA Category', a.eaCategory||'—')}
        ${row('EA Sub-Category', a.eaSubCategory&&a.eaSubCategory!=='-'?a.eaSubCategory:'—')}
        <div style="margin-top:12px;padding-top:12px;border-top:1px solid var(--border)">
          <div style="font-size:11px;color:var(--dim);margin-bottom:7px;font-weight:600;letter-spacing:.3px">COMPLIANCE STANDARDS</div>
          <div style="display:flex;flex-wrap:wrap;gap:5px">${compBadges}</div>
        </div>
        <div style="margin-top:16px;padding-top:14px;border-top:1px solid var(--border)">
          <div style="font-size:11px;color:var(--dim);margin-bottom:8px">TCO vs Portfolio Average</div>
          ${gauge('This App', a.tco, 'var(--accent)', Math.max(a.tco, avgTCO)*1.2)}
          ${gauge('Portfolio Avg', Math.round(avgTCO), 'var(--dim)', Math.max(a.tco, avgTCO)*1.2)}
        </div>
      </div>
    </div>

    <!-- Analysis findings -->
    <div class="insight-analysis">
      <div class="insight-analysis-title">🧠 การวิเคราะห์เชิงลึก — ${findings.length} ประเด็น
        <span style="margin-left:auto;font-size:11px;color:${overallRisk[1]};font-weight:700;background:${overallRisk[1]}18;padding:3px 10px;border-radius:6px;border:1px solid ${overallRisk[1]}44">Overall Risk: ${overallRisk[0]}</span>
      </div>
      ${findingsHtml}
    </div>

    <!-- Recommendations -->
    <div class="insight-card">
      <div class="insight-card-title">💡 คำแนะนำเชิงกลยุทธ์</div>
      ${_generateRecommendations(a, findings).map(r=>`
        <div style="display:flex;align-items:flex-start;gap:10px;padding:10px 0;border-bottom:1px solid var(--border);font-size:13px">
          <span style="font-size:16px;flex-shrink:0">${r.icon}</span>
          <div>
            <div style="font-weight:700;color:var(--text);margin-bottom:2px">${r.title}</div>
            <div style="color:var(--dim);font-size:12px">${r.desc}</div>
          </div>
          <span style="margin-left:auto;flex-shrink:0;font-size:10px;font-weight:700;padding:3px 8px;border-radius:4px;background:${r.pColor}18;color:${r.pColor};border:1px solid ${r.pColor}44">${r.priority}</span>
        </div>`).join('')}
    </div>

  </div>`;

  // Show Paper Out button now that report is ready
  document.getElementById('btn-paper-out').style.display = 'flex';
}

// ── PAPER OUT — Export App Insight to PDF ─────────────────────────────────────
function insightPaperOut(){
  const btn = document.getElementById('btn-paper-out');
  const a   = apps.find(x => x.id === insightSelectedId);
  if(!a) return;

  btn.classList.add('loading');
  btn.querySelector('.paper-out-label').textContent = 'กำลังสร้าง PDF…';

  // Load html2canvas + jsPDF from CDN if not already loaded
  function loadScript(src){ return new Promise((res,rej)=>{ if(document.querySelector(`script[src="${src}"]`)){ res(); return; } const s=document.createElement('script'); s.src=src; s.onload=res; s.onerror=()=>rej(new Error('โหลด library ไม่ได้: '+src)); document.head.appendChild(s); }); }

  Promise.all([
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js'),
    loadScript('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js')
  ])
  .then(() => _doPaperOut(a, btn))
  .catch(err => {
    alert('❌ โหลด library ไม่ได้ — กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต\n'+err.message);
    btn.classList.remove('loading');
    btn.querySelector('.paper-out-label').textContent = 'Paper Out';
  });
}

async function _doPaperOut(a, btn){
  const { jsPDF } = window.jspdf;
  const reportEl  = document.getElementById('insight-content');

  // Temporarily force light colours for clean PDF rendering
  const html = document.documentElement;
  const prevTheme = html.getAttribute('data-theme');
  html.setAttribute('data-theme', 'light');

  // Small delay to let theme repaint
  await new Promise(r => setTimeout(r, 120));

  try {
    const canvas = await html2canvas(reportEl, {
      scale:       2,          // 2x for crisp text
      useCORS:     true,
      logging:     false,
      backgroundColor: '#ffffff',
      windowWidth: reportEl.scrollWidth,
      scrollX:     0,
      scrollY:     0,
      width:       reportEl.scrollWidth,
      height:      reportEl.scrollHeight,
      onclone: (doc) => {
        // Hide Paper Out button in clone so it doesn't appear in PDF
        const b = doc.getElementById('btn-paper-out');
        if(b) b.style.display = 'none';
        // Ensure all content is visible
        doc.getElementById('insight-content').style.overflow = 'visible';
      }
    });

    // A4 landscape PDF
    const pdf      = new jsPDF({ orientation:'portrait', unit:'mm', format:'a4' });
    const pdfW     = pdf.internal.pageSize.getWidth();   // 210mm
    const pdfH     = pdf.internal.pageSize.getHeight();  // 297mm
    const margin   = 10;
    const usableW  = pdfW - margin * 2;
    const usableH  = pdfH - margin * 2;

    const imgW     = canvas.width;
    const imgH     = canvas.height;
    const ratio    = usableW / (imgW / 2);   // canvas is 2x
    const totalH   = (imgH / 2) * ratio;     // total height in mm

    // ── Header strip (first page only) ──────────────────────────────
    const headerH  = 18;
    const riskCount = document.querySelectorAll('.insight-finding.risk').length;
    const warnCount = document.querySelectorAll('.insight-finding.warn').length;
    const goodCount = document.querySelectorAll('.insight-finding.good').length;

    function drawHeader(pdf, a, pageNum, totalPages){
      // Dark navy bar
      pdf.setFillColor(15, 52, 96);
      pdf.rect(0, 0, pdfW, headerH, 'F');
      // Logo text
      pdf.setTextColor(255,255,255);
      pdf.setFontSize(9); pdf.setFont('helvetica','bold');
      pdf.text('MPX Studio', margin, 6.5);
      pdf.setFontSize(7); pdf.setFont('helvetica','normal');
      pdf.setTextColor(0,229,255);
      pdf.text('App Insight Report', margin, 11.5);
      // App name
      pdf.setFontSize(10); pdf.setFont('helvetica','bold'); pdf.setTextColor(255,255,255);
      pdf.text(`${a.id} — ${a.name}`, pdfW/2, 7, {align:'center'});
      pdf.setFontSize(7); pdf.setFont('helvetica','normal'); pdf.setTextColor(200,220,255);
      pdf.text(`${a.domain} · ${a.vendor} · ${a.type}`, pdfW/2, 12, {align:'center'});
      // Risk summary (top right)
      pdf.setFontSize(7); pdf.setTextColor(255,100,100);
      pdf.text(`⚠ ${riskCount} Risk`, pdfW-margin-42, 7);
      pdf.setTextColor(255,190,50);
      pdf.text(`! ${warnCount} Warn`, pdfW-margin-27, 7);
      pdf.setTextColor(50,205,120);
      pdf.text(`✓ ${goodCount} Good`, pdfW-margin-12, 7);
      // Date + page
      pdf.setTextColor(180,200,240);
      const now = new Date();
      const dateStr = `${now.getDate()}/${now.getMonth()+1}/${now.getFullYear()}`;
      pdf.text(`${dateStr}  |  หน้า ${pageNum}/${totalPages}`, pdfW-margin, 13, {align:'right'});
    }

    // ── Footer strip ────────────────────────────────────────────────
    function drawFooter(pdf, pageNum, totalPages){
      pdf.setFillColor(245,247,250);
      pdf.rect(0, pdfH-8, pdfW, 8, 'F');
      pdf.setDrawColor(220,225,235);
      pdf.line(0, pdfH-8, pdfW, pdfH-8);
      pdf.setFontSize(6.5); pdf.setTextColor(120,130,150);
      pdf.setFont('helvetica','normal');
      pdf.text('MPX Studio EA Portfolio — CONFIDENTIAL', margin, pdfH-3);
      pdf.text(`หน้า ${pageNum} จาก ${totalPages}`, pdfW-margin, pdfH-3, {align:'right'});
    }

    // ── Slice canvas into pages ─────────────────────────────────────
    const contentAreaH   = pdfH - headerH - 10; // 10mm footer
    const pxPerPage      = (contentAreaH / ratio) * 2; // in canvas px (2x)
    const totalPages     = Math.ceil(imgH / pxPerPage);

    const imgData = canvas.toDataURL('image/jpeg', 0.92);

    for(let page = 0; page < totalPages; page++){
      if(page > 0) pdf.addPage();

      drawHeader(pdf, a, page+1, totalPages);
      drawFooter(pdf, page+1, totalPages);

      // Crop slice of image for this page
      const srcY   = page * pxPerPage;
      const srcH   = Math.min(pxPerPage, imgH - srcY);
      const sliceH = (srcH / 2) * ratio; // mm

      // Create a temporary canvas for this page slice
      const sliceCanvas   = document.createElement('canvas');
      sliceCanvas.width   = imgW;
      sliceCanvas.height  = srcH;
      sliceCanvas.getContext('2d').drawImage(canvas, 0, srcY, imgW, srcH, 0, 0, imgW, srcH);

      const sliceData = sliceCanvas.toDataURL('image/jpeg', 0.92);
      pdf.addImage(sliceData, 'JPEG', margin, headerH+1, usableW, sliceH);
    }

    // Save
    const filename = `AppInsight_${a.id}_${a.name.replace(/[^a-zA-Z0-9]/g,'_')}_${_today()}.pdf`;
    pdf.save(filename);

    if(typeof showToast !== 'undefined')
      showToast(`✅ PDF สร้างเสร็จแล้ว — ${filename}`, 'success');

  } catch(err){
    console.error('Paper Out error:', err);
    alert('❌ สร้าง PDF ไม่สำเร็จ: ' + err.message);
  } finally {
    // Restore original theme
    html.setAttribute('data-theme', prevTheme);
    btn.classList.remove('loading');
    btn.querySelector('.paper-out-label').textContent = 'Paper Out';
  }
}

function _generateRecommendations(a, findings){
  const recs = [];
  const riskCount = findings.filter(f=>f.type==='risk').length;

  if(riskCount >= 2)
    recs.push({icon:'🚨', title:'จัดทำ Risk Remediation Plan', desc:'มีประเด็นความเสี่ยงหลายรายการ — ควรประชุม stakeholder ทันทีเพื่อวางแผนแก้ไขตามลำดับความสำคัญ', priority:'ด่วนมาก', pColor:'var(--red)'});

  if(a.bcg==='Retire' || a.status==='To-retire')
    recs.push({icon:'🗓', title:'วางแผน Decommission Timeline', desc:`กำหนด timeline ที่ชัดเจนสำหรับการ retire พร้อม data migration plan และ user communication plan`, priority:'ด่วน', pColor:'var(--red)'});

  if(a.techDebt > 50 || (100-a.health) > 50)
    recs.push({icon:'🔧', title:'Tech Debt Reduction Program', desc:'จัดสรร capacity ประมาณ 20-30% ของ sprint สำหรับ refactoring และ modernization โดยเฉพาะ', priority:'สูง', pColor:'var(--yellow)'});

  if(a.age > 10 && a.bcg !== 'Retire')
    recs.push({icon:'🔄', title:'Modernization Assessment', desc:`ระบบอายุ ${a.age} ปี ควรทำ modernization assessment เพื่อพิจารณา re-platform, re-architect หรือ replace`, priority:'สูง', pColor:'var(--yellow)'});

  if(!a.dr && (a.criticality==='Mission Critical'||a.criticality==='High'))
    recs.push({icon:'🛡', title:'วาง Disaster Recovery Plan', desc:'จัดทำ DR strategy ตาม criticality — กำหนด RTO/RPO และทดสอบ DR drill อย่างน้อยปีละ 2 ครั้ง', priority:'ด่วน', pColor:'var(--red)'});

  if(a.integration > 20)
    recs.push({icon:'🗺', title:'จัดทำ Integration Map', desc:`${a.integration} integrations มีความซับซ้อนสูง — ควรทำ dependency mapping และพิจารณา API gateway เพื่อลด coupling`, priority:'ปานกลาง', pColor:'var(--accent)'});

  if(a.persons <= 1)
    recs.push({icon:'👥', title:'Knowledge Transfer & Bus Factor', desc:'ควรเพิ่ม team member ที่มีความเข้าใจระบบ หรือจัดทำ documentation อย่างละเอียดเพื่อลด single point of failure', priority:'สูง', pColor:'var(--yellow)'});

  if(a.bcg==='Invest' || a.strategic >= 80)
    recs.push({icon:'📈', title:'ลงทุนต่อเนื่องและพัฒนา Feature', desc:'ระบบมี strategic value สูง — ควรจัดสรรงบประมาณเพียงพอและวาง feature roadmap ที่ชัดเจน 12-18 เดือนข้างหน้า', priority:'ปานกลาง', pColor:'var(--green)'});

  if(a.type==='Package' && (!a.contractEnd||a.contractEnd==='N/A'))
    recs.push({icon:'📋', title:'ตรวจสอบ Vendor Contract', desc:'ระบบ Package ควรมีข้อมูล contract และ vendor relationship ที่ชัดเจน เพื่อการ negotiation และ renewal ที่มีประสิทธิภาพ', priority:'ต่ำ', pColor:'var(--dim)'});

  if(recs.length === 0)
    recs.push({icon:'✅', title:'รักษาระดับมาตรฐานปัจจุบัน', desc:'ระบบอยู่ในสถานะที่ดี — ควรทบทวน health assessment ทุก 6 เดือนและอัปเดต EA classification ให้เป็นปัจจุบันเสมอ', priority:'ปกติ', pColor:'var(--green)'});

  return recs;
}

// ─── SETTINGS: IMPORT / EXPORT ────────────────────────────────────────────────

// Column definitions — order matters (matches XLSX columns)
const IE_COLS = [
  {key:'id',            label:'App ID',             type:'str'},
  {key:'name',          label:'App Name',            type:'str'},
  {key:'domain',        label:'Domain',              type:'str'},
  {key:'vendor',        label:'Vendor',              type:'str'},
  {key:'type',          label:'Type',                type:'str'},
  {key:'status',        label:'Status',              type:'str'},
  {key:'bcg',           label:'BCG Quadrant',        type:'str'},
  {key:'health',        label:'Health Score',        type:'int'},
  {key:'techDebt',      label:'Tech Debt %',         type:'int'},
  {key:'age',           label:'Age (Years)',         type:'int'},
  {key:'tco',           label:'TCO (KTHb)',          type:'int'},
  {key:'users',         label:'Users',               type:'int'},
  {key:'criticality',   label:'Criticality',         type:'str'},
  {key:'dr',            label:'DR',                  type:'bool'},
  {key:'eol',           label:'End of Life',         type:'str'},
  {key:'piSpi',         label:'PI/SPI Impact',       type:'bool'},
  {key:'contractEnd',   label:'Contract End',        type:'str'},
  {key:'integration',   label:'Integrations',        type:'int'},
  {key:'stack',         label:'Tech Stack',          type:'arr'},
  {key:'capability',    label:'Capability',          type:'str'},
  {key:'strategic',     label:'Strategic Score',     type:'int'},
  {key:'persons',       label:'Persons',             type:'int'},
  {key:'srcAvail',      label:'Source Available',    type:'bool'},
  {key:'serviceHour',   label:'Service Hour',        type:'str'},
  {key:'maintWindow',   label:'Maint Window',        type:'str'},
  {key:'lang',          label:'Language',            type:'str'},
  {key:'os',            label:'OS',                  type:'str'},
  {key:'db',            label:'Database',            type:'str'},
  {key:'support',       label:'Support Type',        type:'str'},
  {key:'owner',         label:'IT Owner',            type:'str'},
  {key:'bizOwner',      label:'Business App Owner',  type:'str'},
  {key:'compliance',    label:'Compliance',          type:'arr'},
  {key:'stream',        label:'Stream',              type:'str'},
  {key:'approach',      label:'Approach',            type:'str'},
  {key:'assessStatus',  label:'Assess Status',       type:'str'},
  {key:'assessDate',    label:'Assess Date',         type:'str'},
  {key:'wave',          label:'Wave',                type:'int'},
  {key:'eaGroup',       label:'EA Group',            type:'str'},
  {key:'eaCategory',    label:'EA Category',         type:'str'},
  {key:'eaSubCategory', label:'EA Sub-Category',     type:'str'},
];

// ── Render page ───────────────────────────────────────────────────────────────
function renderSettingsImportExport(){
  const el = document.getElementById('ie-content');
  el.innerHTML = `
  <div class="ie-page">

    <!-- Export section -->
    <div class="ie-section">
      <div class="ie-section-header">
        <div class="ie-section-icon" style="background:rgba(0,229,255,.1);color:var(--accent)">📤</div>
        <div>
          <div class="ie-section-title">Export ข้อมูลออก Excel</div>
          <div class="ie-section-desc">Export แอปพลิเคชันทั้งหมดออกเป็น .xlsx พร้อม header และ formatting — นำไปใช้ได้เลยหรือ import กลับได้</div>
        </div>
      </div>
      <div class="ie-section-body">
        <div class="ie-action">
          <div class="ie-action-info">
            <div class="ie-action-title">📊 Export All Applications</div>
            <div class="ie-action-desc">Export ข้อมูลแอปทั้งหมด ${apps.filter(a=>!a.decommissioned).length} รายการ (ไม่รวม Decommissioned) ออกเป็น AppPort_Export.xlsx</div>
          </div>
          <button class="ie-btn ie-btn-primary" onclick="ieExport(false)">⬇ Export Active</button>
        </div>
        <div class="ie-action">
          <div class="ie-action-info">
            <div class="ie-action-title">📋 Export ทั้งหมด (รวม Decommissioned)</div>
            <div class="ie-action-desc">Export ข้อมูลแอปทั้งหมด ${apps.length} รายการ รวมที่ Decommission แล้ว</div>
          </div>
          <button class="ie-btn ie-btn-primary" style="background:var(--accent2)" onclick="ieExport(true)">⬇ Export All</button>
        </div>
        <div id="ie-export-status"></div>
      </div>
    </div>

    <!-- Import section -->
    <div class="ie-section">
      <div class="ie-section-header">
        <div class="ie-section-icon" style="background:rgba(0,214,143,.1);color:var(--green)">📥</div>
        <div>
          <div class="ie-section-title">Import ข้อมูลจาก Excel</div>
          <div class="ie-section-desc">Import ไฟล์ .xlsx ที่ Export มาจากระบบนี้ — ระบบจะตรวจสอบ format และ preview ก่อน import จริง</div>
        </div>
      </div>
      <div class="ie-section-body">
        <div class="ie-dropzone" id="ie-dropzone" onclick="document.getElementById('ie-file-input').click()">
          <input type="file" id="ie-file-input" accept=".xlsx" onchange="ieFileSelected(this.files[0])">
          <div class="ie-dropzone-icon">📂</div>
          <div class="ie-dropzone-title">คลิกเพื่อเลือกไฟล์ หรือ ลากไฟล์มาวาง</div>
          <div class="ie-dropzone-sub">รองรับไฟล์ .xlsx ที่ Export จากระบบนี้เท่านั้น</div>
        </div>
        <div id="ie-import-status"></div>
        <div id="ie-import-preview"></div>
        <div id="ie-import-actions" style="display:none">
          <div style="display:flex;gap:10px;margin-top:4px">
            <button class="ie-btn ie-btn-success" id="ie-btn-confirm" onclick="ieConfirmImport()">✅ ยืนยัน Import</button>
            <button class="ie-btn ie-btn-danger" onclick="ieCancelImport()">✕ ยกเลิก</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Format guide -->
    <div class="ie-section">
      <div class="ie-section-header">
        <div class="ie-section-icon" style="background:rgba(123,97,255,.1);color:#7b61ff">📖</div>
        <div>
          <div class="ie-section-title">คำแนะนำการใช้งาน</div>
          <div class="ie-section-desc">Format ของไฟล์และข้อกำหนดสำหรับการ Import</div>
        </div>
      </div>
      <div class="ie-section-body">
        <div class="ie-preview-scroll">
          <table class="ie-preview-tbl">
            <thead><tr>
              <th>#</th><th>Column</th><th>Type</th><th>ตัวอย่าง</th>
            </tr></thead>
            <tbody>
              ${IE_COLS.map((c,i)=>`<tr>
                <td style="color:var(--dim)">${i+1}</td>
                <td style="font-weight:700">${c.label}</td>
                <td style="font-family:var(--mono);font-size:10px;color:var(--accent)">${c.type}</td>
                <td style="color:var(--dim)">${_ieExample(c)}</td>
              </tr>`).join('')}
            </tbody>
          </table>
        </div>
        <div class="ie-status info" style="margin-top:0">
          ℹ️ &nbsp;<span><strong>App ID</strong> ใช้ในการ match ข้อมูล — ถ้า ID ซ้ำจะ <strong>อัพเดต</strong> record เดิม, ถ้า ID ใหม่จะ <strong>เพิ่ม</strong> record ใหม่ &nbsp;|&nbsp; <strong>Tech Stack</strong> คั่นด้วย comma เช่น <code>SAP,ABAP,HANA</code></span>
        </div>
      </div>
    </div>

  </div>`;

  // Wire drag-and-drop
  const dz = document.getElementById('ie-dropzone');
  dz.addEventListener('dragover', e=>{ e.preventDefault(); dz.classList.add('drag-over'); });
  dz.addEventListener('dragleave', ()=> dz.classList.remove('drag-over'));
  dz.addEventListener('drop', e=>{
    e.preventDefault(); dz.classList.remove('drag-over');
    const f = e.dataTransfer.files[0];
    if(f) ieFileSelected(f);
  });
}

function _ieExample(c){
  const ex = {
    id:'APP-001', name:'SAP S/4HANA', domain:'Finance', vendor:'SAP',
    type:'Package', status:'Active', bcg:'Invest', health:'88', techDebt:'12',
    age:'3', tco:'4200', users:'850', criticality:'Mission Critical',
    dr:'true', eol:'2032-12', piSpi:'true', contractEnd:'2027-06',
    integration:'12', stack:'ABAP,SAP UI5,HANA', capability:'ERP Core',
    strategic:'92', persons:'8', srcAvail:'true', serviceHour:'24x7',
    maintWindow:'Sun 02:00-06:00', lang:'ABAP', os:'SUSE Linux',
    db:'SAP HANA', support:'Vendor+Inhouse', owner:'Somchai K.',
    stream:'Core Finance', approach:'Upgrade', assessStatus:'Completed',
    assessDate:'2024-06', wave:'1', eaGroup:'3. Core Products',
    eaCategory:'3.2 Corporate & Core System', eaSubCategory:'-',
    bizOwner:'Surachai M.', compliance:'ISO 27001,PDPA,DR Policy',
  };
  return ex[c.key] || '—';
}

// ── EXPORT ────────────────────────────────────────────────────────────────────
async function ieExport(includeDecomm){
  const status = document.getElementById('ie-export-status');
  status.innerHTML = `<div class="ie-status info">⏳ กำลังสร้างไฟล์ Excel...</div>`;

  try {
    // ── Fetch data ────────────────────────────────────────────────────────────
    // For "Export All (รวม Decommissioned)": always fetch fresh from API so that
    //   (1) decommissioned apps are included regardless of current apps[] state,
    //   (2) field mapping is freshly applied via mapApiApp() — prevents
    //       any stale / incorrectly-mapped data (e.g. bizOwner ≠ compliance).
    let exportApps;
    if(includeDecomm){
      const raw = await apiGet('/api/export?include_decomm=true');
      exportApps = raw.map(mapApiApp);
    } else {
      exportApps = apps.filter(a=>!a.decommissioned);
    }

    // Build CSV-compatible data → use SheetJS via manual XLSX creation
    const header = IE_COLS.map(c=>c.label);
    const rows   = exportApps.map(a => IE_COLS.map(c => {
      const v = a[c.key];
      if(c.type==='arr') return Array.isArray(v) ? v.join(',') : (v||'');
      if(c.type==='bool') return v ? 'true' : 'false';
      return v==null ? '' : String(v);
    }));

    // Create workbook using manual XML (no library needed)
    const wb = _buildXLSX(header, rows, exportApps);
    _downloadBlob(wb, `AppPort_Export_${_today()}.xlsx`);
    status.innerHTML = `<div class="ie-status success">✅ Export สำเร็จ ${exportApps.length} แอปพลิเคชัน — กำลัง download...</div>`;
  } catch(e){
    status.innerHTML = `<div class="ie-status error">❌ Export ล้มเหลว: ${e.message}</div>`;
    console.error(e);
  }
}

// ── Build XLSX (Office Open XML) manually ─────────────────────────────────────
function _buildXLSX(header, rows, exportApps){
  // Shared strings
  const strings = [];
  const strIdx  = {};
  const si = s => {
    const k = String(s);
    if(strIdx[k]===undefined){ strIdx[k]=strings.length; strings.push(k); }
    return strIdx[k];
  };

  // Pre-index all values
  header.forEach(h=>si(h));
  rows.forEach(r=>r.forEach(v=>{ if(isNaN(v)||v===''||v==='true'||v==='false') si(v); }));

  // Worksheet rows XML
  const colNums = IE_COLS.map(c=>c.type);
  const wsRows  = [header, ...rows].map((row, ri) => {
    const cells = row.map((val, ci) => {
      const colLetter = _colLetter(ci+1);
      const ref = `${colLetter}${ri+1}`;
      const isNum = ri>0 && (colNums[ci]==='int') && val!=='' && !isNaN(val);
      if(isNum) return `<c r="${ref}" s="${ci===7?2:ci===8?3:1}"><v>${val}</v></c>`;
      return `<c r="${ref}" t="s" s="${ri===0?4:0}"><v>${si(val)}</v></c>`;
    });
    return `<row r="${ri+1}">${cells.join('')}</row>`;
  }).join('');

  // Column widths
  const colWidths = IE_COLS.map((c,i)=>`<col min="${i+1}" max="${i+1}" width="${_colWidth(c)}" customWidth="1"/>`).join('');

  // Auto filter range
  const lastCol = _colLetter(IE_COLS.length);
  const lastRow = rows.length + 1;

  const ws = `<?xml version="1.0" encoding="UTF-8"?>
<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
           xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">
  <sheetViews><sheetView tabSelected="1" workbookViewId="0"><selection activeCell="A2"/></sheetView></sheetViews>
  <sheetFormatPr defaultRowHeight="16"/>
  <cols>${colWidths}</cols>
  <sheetData>${wsRows}</sheetData>
  <autoFilter ref="A1:${lastCol}1"/>
  <sheetProtection sheet="0"/>
</worksheet>`;

  // Shared strings XML
  const ssXml = `<?xml version="1.0" encoding="UTF-8"?>
<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="${strings.length}" uniqueCount="${strings.length}">
${strings.map(s=>`<si><t xml:space="preserve">${_escXml(s)}</t></si>`).join('\n')}
</sst>`;

  // Styles
  const stylesXml = `<?xml version="1.0" encoding="UTF-8"?>
<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">
  <fonts count="3">
    <font><sz val="10"/><name val="Arial"/></font>
    <font><sz val="10"/><name val="Arial"/><color rgb="FF003366"/></font>
    <font><sz val="10"/><name val="Arial"/><color rgb="FF006400"/></font>
    <font><sz val="10"/><name val="Arial"/><b/><color rgb="FFFFFFFF"/></font>
  </fonts>
  <fills count="4">
    <fill><patternFill patternType="none"/></fill>
    <fill><patternFill patternType="gray125"/></fill>
    <fill><patternFill patternType="solid"><fgColor rgb="FF003366"/></patternFill></fill>
    <fill><patternFill patternType="solid"><fgColor rgb="FFE8F4FD"/></patternFill></fill>
  </fills>
  <borders count="2">
    <border><left/><right/><top/><bottom/><diagonal/></border>
    <border><left style="thin"><color rgb="FFCCCCCC"/></left><right style="thin"><color rgb="FFCCCCCC"/></right><top style="thin"><color rgb="FFCCCCCC"/></top><bottom style="thin"><color rgb="FFCCCCCC"/></bottom><diagonal/></border>
  </borders>
  <cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>
  <cellXfs count="5">
    <xf numFmtId="0" fontId="0" fillId="0" borderId="1" xfId="0" applyBorder="1"/>
    <xf numFmtId="0" fontId="1" fillId="3" borderId="1" xfId="0" applyFont="1" applyFill="1" applyBorder="1"/>
    <xf numFmtId="0" fontId="2" fillId="3" borderId="1" xfId="0" applyFont="1" applyFill="1" applyBorder="1"/>
    <xf numFmtId="0" fontId="2" fillId="3" borderId="1" xfId="0" applyFont="1" applyFill="1" applyBorder="1"/>
    <xf numFmtId="0" fontId="3" fillId="2" borderId="1" xfId="0" applyFont="1" applyFill="1" applyBorder="1" applyAlignment="1"><alignment horizontal="center" vertical="center"/></xf>
  </cellXfs>
  <cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>
</styleSheet>`;

  const wb = `<?xml version="1.0" encoding="UTF-8"?>
<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"
          xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">
  <sheets><sheet name="AppPort Data" sheetId="1" r:id="rId1"/></sheets>
</workbook>`;

  const wbRels = `<?xml version="1.0" encoding="UTF-8"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/>
  <Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/>
  <Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>
</Relationships>`;

  const pkgRels = `<?xml version="1.0" encoding="UTF-8"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
  <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/>
</Relationships>`;

  const ct = `<?xml version="1.0" encoding="UTF-8"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
  <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
  <Default Extension="xml" ContentType="application/xml"/>
  <Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>
  <Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>
  <Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>
  <Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>
</Types>`;

  // Zip it up using JSZip (loaded from CDN) or fallback manual zip
  return {ws,ssXml,stylesXml,wb,wbRels,pkgRels,ct};
}

function _downloadBlob(parts, filename){
  // Use fflate for zip (small, fast, no server needed)
  // Load fflate dynamically if not present
  if(typeof fflate === 'undefined'){
    const s = document.createElement('script');
    s.src = 'https://cdn.jsdelivr.net/npm/fflate@0.8.2/umd/index.js';
    s.onload = () => _doZipAndDownload(parts, filename);
    s.onerror = () => { throw new Error('ไม่สามารถโหลด fflate library ได้ — กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เต็ต'); };
    document.head.appendChild(s);
  } else {
    _doZipAndDownload(parts, filename);
  }
}

function _doZipAndDownload(parts, filename){
  const enc = s => fflate.strToU8(s);
  const zip = {
    '[Content_Types].xml':         enc(parts.ct),
    '_rels/.rels':                 enc(parts.pkgRels),
    'xl/workbook.xml':             enc(parts.wb),
    'xl/_rels/workbook.xml.rels':  enc(parts.wbRels),
    'xl/worksheets/sheet1.xml':    enc(parts.ws),
    'xl/sharedStrings.xml':        enc(parts.ssXml),
    'xl/styles.xml':               enc(parts.stylesXml),
  };
  fflate.zip(zip, {level:6}, (err, data) => {
    if(err) throw err;
    const blob = new Blob([data], {type:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'});
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    a.href = url; a.download = filename; a.click();
    setTimeout(()=>URL.revokeObjectURL(url), 5000);
  });
}

// ── IMPORT ────────────────────────────────────────────────────────────────────
let ieImportData = null;

function ieFileSelected(file){
  if(!file) return;
  const statusEl  = document.getElementById('ie-import-status');
  const previewEl = document.getElementById('ie-import-preview');
  const actionsEl = document.getElementById('ie-import-actions');
  ieImportData = null;
  actionsEl.style.display = 'none';
  previewEl.innerHTML = '';

  if(!file.name.endsWith('.xlsx')){
    statusEl.innerHTML = `<div class="ie-status error">❌ รองรับเฉพาะไฟล์ .xlsx เท่านั้น</div>`;
    return;
  }
  statusEl.innerHTML = `<div class="ie-status info">⏳ กำลังอ่านไฟล์...</div>`;

  // Use FileReader + fflate to parse XLSX
  const reader = new FileReader();
  reader.onload = e => {
    if(typeof fflate === 'undefined'){
      const s = document.createElement('script');
      s.src = 'https://cdn.jsdelivr.net/npm/fflate@0.8.2/umd/index.js';
      s.onload = () => _parseXLSX(e.target.result, file.name, statusEl, previewEl, actionsEl);
      document.head.appendChild(s);
    } else {
      _parseXLSX(e.target.result, file.name, statusEl, previewEl, actionsEl);
    }
  };
  reader.readAsArrayBuffer(file);
}

function _parseXLSX(buffer, filename, statusEl, previewEl, actionsEl){
  try {
    const u8    = new Uint8Array(buffer);
    const files = {};
    fflate.unzipSync(u8, {filter: f=>true});
    const unzipped = fflate.unzipSync(u8);

    // Decode XML files
    const dec = name => {
      const key = Object.keys(unzipped).find(k=>k.endsWith(name));
      return key ? fflate.strFromU8(unzipped[key]) : null;
    };

    const wsXml  = dec('sheet1.xml');
    const ssXml  = dec('sharedStrings.xml');
    if(!wsXml) throw new Error('ไม่พบ sheet1.xml — ไฟล์อาจไม่ถูกต้อง');

    // Parse shared strings
    const ssArr = [];
    if(ssXml){
      const matches = ssXml.matchAll(/<t(?:\s[^>]*)?>([^<]*)<\/t>/g);
      for(const m of matches) ssArr.push(_unescXml(m[1]));
    }

    // Parse rows
    const rowMatches = [...wsXml.matchAll(/<row r="(\d+)"[^>]*>(.*?)<\/row>/gs)];
    const sheetData  = rowMatches.map(rm => {
      const cells = {};
      const cellMatches = [...rm[2].matchAll(/<c r="([A-Z]+)(\d+)"[^>]*>(.*?)<\/c>/gs)];
      cellMatches.forEach(cm => {
        const col   = cm[1];
        const inner = cm[3];
        const tAttr = cm[0].match(/t="([^"]+)"/)?.[1];
        const vMatch= inner.match(/<v>([^<]*)<\/v>/);
        let val = vMatch ? vMatch[1] : '';
        if(tAttr === 's') val = ssArr[parseInt(val)] ?? '';
        cells[col] = val;
      });
      return cells;
    });

    if(sheetData.length < 2) throw new Error('ไม่มีข้อมูล — ไฟล์ต้องมีอย่างน้อย 1 แถวข้อมูล');

    // Map column letters to header labels
    const headerRow = sheetData[0];
    const colMap    = {};  // letter → IE_COL key
    Object.entries(headerRow).forEach(([col, label]) => {
      const def = IE_COLS.find(c=>c.label===label);
      if(def) colMap[col] = def.key;
    });

    const foundCols  = Object.values(colMap);
    const missingReq = ['id','name','domain'].filter(k=>!foundCols.includes(k));
    if(missingReq.length) throw new Error(`ไม่พบ column ที่จำเป็น: ${missingReq.map(k=>IE_COLS.find(c=>c.key===k)?.label).join(', ')}`);

    // Parse data rows
    const parsed = sheetData.slice(1).map((row, ri) => {
      const a = {};
      Object.entries(colMap).forEach(([col, key]) => {
        const def = IE_COLS.find(c=>c.key===key);
        let val = row[col] ?? '';
        if(def.type==='int')  val = isNaN(parseInt(val)) ? 0 : parseInt(val);
        else if(def.type==='bool') val = val==='true'||val==='1'||val===true;
        else if(def.type==='arr')  val = val ? val.split(',').map(s=>s.trim()).filter(Boolean) : [];
        a[key] = val;
      });
      // Fill defaults
      IE_COLS.forEach(c=>{
        if(a[c.key]===undefined) a[c.key] = c.type==='int'?0:c.type==='bool'?false:c.type==='arr'?[]:'-';
      });
      a.techDebt = a.techDebt || (100 - (a.health||75));
      return a;
    }).filter(a=>a.id && a.name);

    if(parsed.length === 0) throw new Error('ไม่พบข้อมูลแอปพลิเคชันในไฟล์');

    ieImportData = parsed;

    // Count new vs update
    const existing = new Set(apps.map(a=>a.id));
    const toUpdate = parsed.filter(a=>existing.has(a.id)).length;
    const toAdd    = parsed.length - toUpdate;

    statusEl.innerHTML = `<div class="ie-status success">✅ อ่านไฟล์สำเร็จ — พบ ${parsed.length} แอป (เพิ่มใหม่ ${toAdd}, อัพเดต ${toUpdate})</div>`;

    // Preview first 5 rows
    previewEl.innerHTML = `
      <div class="ie-preview">
        <div class="ie-preview-title">Preview (5 แถวแรก จากทั้งหมด ${parsed.length} แถว)</div>
        <div class="ie-preview-scroll">
          <table class="ie-preview-tbl">
            <thead><tr>
              <th>App ID</th><th>App Name</th><th>Domain</th><th>Vendor</th>
              <th>Status</th><th>Health</th><th>EA Group</th><th>EA Category</th>
            </tr></thead>
            <tbody>
              ${parsed.slice(0,5).map(a=>`<tr>
                <td style="font-family:var(--mono);color:var(--accent)">${a.id}</td>
                <td style="font-weight:600">${a.name}</td>
                <td>${a.domain||'—'}</td>
                <td>${a.vendor||'—'}</td>
                <td>${a.status||'—'}</td>
                <td>${a.health||'—'}</td>
                <td>${a.eaGroup||'—'}</td>
                <td>${a.eaCategory||'—'}</td>
              </tr>`).join('')}
            </tbody>
          </table>
        </div>
      </div>`;

    actionsEl.style.display = 'block';

  } catch(e){
    statusEl.innerHTML = `<div class="ie-status error">❌ อ่านไฟล์ไม่สำเร็จ: ${e.message}</div>`;
    console.error(e);
    ieImportData = null;
  }
}

async function ieConfirmImport(){
  if(!ieImportData) return;
  const btn = document.getElementById('ie-btn-confirm');
  const statusEl = document.getElementById('ie-import-status');
  btn.disabled = true; btn.textContent = '⏳ กำลัง Import...';

  try {
    let added=0, updated=0, errors=0;
    const existing = new Set(apps.map(a=>a.id));

    for(const a of ieImportData){
      try {
        if(typeof apiPut !== 'undefined' && existing.has(a.id)){
          // Fullstack mode — call API
          await apiPut(`/api/apps/${a.id}`, _ieFrontendToApi(a));
          updated++;
        } else if(typeof apiPost !== 'undefined' && !existing.has(a.id)){
          await apiPost('/api/apps', _ieFrontendToApi(a));
          added++;
        } else if(typeof apiPut === 'undefined'){
          // Demo mode — update in-memory
          const idx = apps.findIndex(x=>x.id===a.id);
          if(idx>=0){ Object.assign(apps[idx], a); updated++; }
          else { apps.push(a); added++; }
        }
      } catch(e){ errors++; console.warn('Import error for', a.id, e); }
    }

    // Refresh
    if(typeof refreshAndRender !== 'undefined'){
      await refreshAndRender();
    } else {
      const activeView = document.querySelector('.view.active')?.id?.replace('view-','');
      if(activeView) renderView(activeView);
    }

    statusEl.innerHTML = `<div class="ie-status success">✅ Import เสร็จสิ้น — เพิ่มใหม่ ${added} แอป, อัพเดต ${updated} แอป${errors?`, ข้ามเนื่องจาก error ${errors} แอป`:''}. <strong>กรุณา restart server เพื่อให้ข้อมูลถูกบันทึกใน DB</strong></div>`;
    document.getElementById('ie-import-actions').style.display = 'none';
    document.getElementById('ie-import-preview').innerHTML = '';
    ieImportData = null;
    if(typeof showToast !== 'undefined') showToast(`✅ Import เสร็จ: +${added} เพิ่ม, ~${updated} อัพเดต`);

  } catch(e){
    statusEl.innerHTML = `<div class="ie-status error">❌ Import ล้มเหลว: ${e.message}</div>`;
    btn.disabled = false; btn.textContent = '✅ ยืนยัน Import';
  }
}

function _ieFrontendToApi(a){
  return {
    name:a.name, domain:a.domain, vendor:a.vendor, type:a.type, status:a.status,
    bcg:a.bcg, health:a.health, tech_debt:a.techDebt, age:a.age, tco:a.tco,
    users:a.users, criticality:a.criticality, dr:a.dr, eol:a.eol, pi_spi:a.piSpi,
    contract_end:a.contractEnd, integration:a.integration, stack:a.stack,
    capability:a.capability, strategic:a.strategic, persons:a.persons,
    src_avail:a.srcAvail, service_hour:a.serviceHour, maint_window:a.maintWindow,
    lang:a.lang, os:a.os, db_platform:a.db, support:a.support, owner:a.owner,
    biz_owner:a.bizOwner, compliance:a.compliance||[],
    stream:a.stream, approach:a.approach, assess_status:a.assessStatus,
    assess_date:a.assessDate, wave:a.wave, ea_group:a.eaGroup,
    ea_category:a.eaCategory, ea_sub_category:a.eaSubCategory||'-',
  };
}

function ieCancelImport(){
  ieImportData = null;
  document.getElementById('ie-import-status').innerHTML = '';
  document.getElementById('ie-import-preview').innerHTML = '';
  document.getElementById('ie-import-actions').style.display = 'none';
  document.getElementById('ie-file-input').value = '';
}

// ── Utilities ─────────────────────────────────────────────────────────────────
function _colLetter(n){
  let s='';
  while(n>0){ s=String.fromCharCode(64+(n%26||26))+s; n=Math.floor((n-1)/26); }
  return s;
}
function _colWidth(c){
  const w = {id:10,name:28,domain:16,vendor:18,type:12,status:14,bcg:14,
    health:8,techDebt:8,age:6,tco:10,users:10,criticality:18,dr:8,eol:12,
    piSpi:8,contractEnd:14,integration:10,stack:30,capability:24,strategic:8,
    persons:8,srcAvail:8,serviceHour:16,maintWindow:20,lang:16,os:18,db:18,
    support:18,owner:20,bizOwner:22,compliance:30,stream:22,approach:16,assessStatus:16,assessDate:12,
    wave:6,eaGroup:22,eaCategory:36,eaSubCategory:20};
  return w[c.key]||14;
}
function _escXml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&apos;'); }
function _unescXml(s){ return s.replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"').replace(/&apos;/g,"'"); }
function _today(){ const d=new Date(); return `${d.getFullYear()}${String(d.getMonth()+1).padStart(2,'0')}${String(d.getDate()).padStart(2,'0')}`; }

// ─── EA LANDSCAPE ─────────────────────────────────────────────────────────────
let eaViewMode = 'landscape';

function renderMPXBlueprint(){
  const canvas  = document.getElementById('bp-canvas');
  const tooltip = document.getElementById('bp-tooltip');
  if(!canvas) return;

  const hc   = v => v>=70?'#00d68f':v>=50?'#ffa000':'#ff4757';
  const hcBg = v => v>=70?'rgba(0,214,143,.13)':v>=50?'rgba(255,160,0,.13)':'rgba(255,71,87,.13)';
  const g1   = EA_STRUCTURE.find(g=>g.group==='1. Direction');
  const g2   = EA_STRUCTURE.find(g=>g.group==='2. Services');
  const g3   = EA_STRUCTURE.find(g=>g.group==='3. Core Products');
  const g4   = EA_STRUCTURE.find(g=>g.group==='4. Support');
  const g5   = EA_STRUCTURE.find(g=>g.group==='5. Governance');

  const getApps = (grp,cat) => apps.filter(a=>
    !a.decommissioned && a.eaGroup===grp.group && a.eaCategory &&
    (a.eaCategory.startsWith(cat.code) ||
     a.eaCategory.replace(/^\d+\.\d+\s*/,'')===cat.name)
  );

  // vertical side pill — pure CSS, no fixed height
  const vSide = (label, color, bg, cat=null, grp=null) => {
    const list  = (cat&&grp) ? getApps(grp,cat) : [];
    const n     = list.length;
    const avg   = n ? Math.round(list.reduce((s,a)=>s+a.health,0)/n) : 0;
    const c     = n ? hc(avg) : color;
    const dAttr = cat ? `data-grp="${grp.group}" data-cat="${cat.name}" data-code="${cat.code}"` : '';
    const badge = n ? `<span style="writing-mode:horizontal-tb;margin-top:6px;background:${c}28;
      color:${c};border:1px solid ${c}50;border-radius:4px;padding:1px 5px;
      font-size:10px;font-family:var(--mono)">${n}</span>` : '';
    const code  = cat ? `<span style="writing-mode:horizontal-tb;font-size:9px;opacity:.6;
      font-family:var(--mono);margin-bottom:2px">${cat.code}</span>` : '';
    return `<div ${dAttr} style="
        writing-mode:vertical-rl;text-orientation:mixed;
        display:flex;flex-direction:column;align-items:center;justify-content:center;
        background:${bg};color:${c};border:2px solid ${c}40;border-radius:7px;
        font-size:11px;font-weight:700;letter-spacing:.4px;padding:10px 7px;
        cursor:${cat?'pointer':'default'};transition:filter .18s;width:100%;height:100%;
        box-sizing:border-box;${cat?'':''}">
      ${code}${label}${badge}
    </div>`;
  };

  // horizontal category row
  const catRow = (grp,cat,pl=14) => {
    const list=getApps(grp,cat), n=list.length;
    const avg=n?Math.round(list.reduce((s,a)=>s+a.health,0)/n):0;
    const c=n?hc(avg):'var(--muted)', bg=n?hcBg(avg):'rgba(128,128,128,.04)';
    return `<div class="bp-cat" style="background:${bg};padding-left:${pl}px"
        data-grp="${grp.group}" data-cat="${cat.name}" data-code="${cat.code}">
      <div class="bp-cat-label">
        <span style="font-size:9px;color:var(--dim);font-family:var(--mono);margin-right:5px">${cat.code}</span>${cat.name}
      </div>
      <div class="bp-cat-right">
        ${n?`<div class="bp-hbar"><div class="bp-hbar-fill" style="width:${avg}%;background:${c}"></div></div>`:''}
        <div class="bp-badge" style="background:${n?'#00d68f':'rgba(128,128,128,.2)'};color:${n?'#fff':'var(--muted)'};border:none;border-radius:11px">
          ${n||'—'}
        </div>
      </div>
    </div>`;
  };

  const secHdr = (label,color) =>
    `<div style="background:${color}18;padding:4px 12px;font-size:9px;font-weight:800;
      color:${color};letter-spacing:.5px;font-family:var(--mono);border-bottom:1px solid ${color}33">${label}</div>`;

  // ── shortcuts ──────────────────────────────────────────────────────────────
  const C = (code,grp) => grp.categories.find(c=>c.code===code);
  const cCust=C('2.1',g2), cPart=C('2.2',g2), cSvc=C('2.3',g2), cEmp=C('2.4',g2);
  const cChan=C('2.6',g2), cPort=C('2.7',g2);
  const c51=C('5.1',g5), c52=C('5.2',g5), c53=C('5.3',g5);
  const c41=C('4.1',g4), c42=C('4.2',g4), c43=C('4.3',g4);

  // ── Corp App & IT row (just outside main box) ─────────────────────────────
  const appIT = (()=>{
    const list=getApps(g4,c43), n=list.length;
    const avg=n?Math.round(list.reduce((s,a)=>s+a.health,0)/n):0;
    const c=n?hc(avg):g4.color;
    return `<div class="bp-cat" style="background:${n?hcBg(avg):'rgba(128,128,128,.04)'};
        border:2px solid ${c}44;border-radius:7px;margin-top:5px;padding-left:14px"
        data-grp="${g4.group}" data-cat="${c43.name}" data-code="${c43.code}">
      <div class="bp-cat-label">
        <span style="font-size:9px;color:var(--dim);font-family:var(--mono);margin-right:5px">${c43.code}</span>${c43.name}
      </div>
      <div class="bp-cat-right">
        ${n?`<div class="bp-hbar" style="width:70px"><div class="bp-hbar-fill" style="width:${avg}%;background:${c}"></div></div>`:''}
        <div class="bp-badge" style="background:${n?'#00d68f':'rgba(128,128,128,.2)'};color:${n?'#fff':'var(--muted)'};border:none;border-radius:11px">
          ${n||'—'}
        </div>
      </div>
    </div>`;
  })();

  // ── Enterprise IT bottom bar ───────────────────────────────────────────────
  const eitApps=apps.filter(a=>!a.decommissioned&&(!a.eaGroup||!a.eaCategory));
  const eitN=eitApps.length, eitAvg=eitN?Math.round(eitApps.reduce((s,a)=>s+a.health,0)/eitN):0;
  const eitC=eitN?hc(eitAvg):'var(--dim)';

  // ── MAIN CONTENT BOX (determines total height) ────────────────────────────
  const mainBox = `
    <div style="flex:1;display:flex;flex-direction:column">
      <div style="border:2px solid ${g1.color}44;border-radius:9px;overflow:hidden;background:var(--card2)">
        ${secHdr('CORPORATE DIRECTION — SPONSOR / DRIVE', g1.color)}
        <div style="background:${g1.bgColor}">
          ${g1.categories.map(cat=>catRow(g1,cat,16)).join('')}
        </div>
        <div style="border-top:2px solid ${g3.color}33">
          ${secHdr('CORE PRODUCTS',g3.color)}
          ${g3.categories.map(cat=>catRow(g3,cat,14)).join('')}
        </div>
        <div style="border-top:2px solid ${g4.color}33">
          ${secHdr('SUPPORT',g4.color)}
          ${[c41,c42].map(cat=>catRow(g4,cat,14)).join('')}
        </div>
      </div>
      ${appIT}
    </div>`;

  // ══════════════════════════════════════════════════════════════════════════
  // LAYOUT STRATEGY:
  //  • Outer = display:flex, flex-direction:row
  //  • LEFT GROUP  : col1(cust/part/svc/emp stacked) + col2(chan+port stacked)
  //                  + col3(Corp Dir) + col4(Sponsor) — all flex:none fixed widths
  //  • CENTER      : mainBox — flex:1 (takes remaining space)
  //  • RIGHT GROUP : col6(Sup)+col7(Act)+col8(5.1)+col9(5.2)+col10(5.3)
  //                  +col11(Reg)+col12(SL) — all flex:none fixed widths
  //  Height is dictated by CENTER content → all side columns stretch:100%
  // ══════════════════════════════════════════════════════════════════════════

  const W1=46, W2=46, W3=38, W4=38, W6=38, W7=38, W8=58, W9=58, W10=58, W11=42, W12=42;
  const GAP=5;

  // left 4-stack: Customer/Partner/Service/Employee
  // col1: Customer/Partner/Service/Employee — 4 กล่องเรียงแนวตั้ง
  const leftStack = `
    <div style="display:flex;flex-direction:column;gap:${GAP}px;width:${W1}px;flex-shrink:0;align-self:stretch">
      <div style="flex:1;display:flex">${vSide('Customer',g2.color,g2.bgColor,cCust,g2)}</div>
      <div style="flex:1;display:flex">${vSide('Partner', g2.color,g2.bgColor,cPart,g2)}</div>
      <div style="flex:1;display:flex">${vSide('Service', g2.color,g2.bgColor,cSvc, g2)}</div>
      <div style="flex:1;display:flex">${vSide('Employee',g2.color,g2.bgColor,cEmp, g2)}</div>
    </div>`;

  // col2: Channels — full height column
  const chanCol = `<div style="width:${W2}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Channels',g2.color,g2.bgColor,cChan,g2)}</div>`;

  // col3: Portal & Gateway — full height column
  const portCol = `<div style="width:${W2}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Portal &amp; Gateway',g2.color,g2.bgColor,cPort,g2)}</div>`;

  // Corp Direction label (full height)
  const cdLabel = `<div style="width:${W3}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Corporate Direction',g1.color,g1.bgColor)}</div>`;

  // Sponsor label (full height)
  const spLabel = `<div style="width:${W4}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Sponsor',g1.color,g1.bgColor)}</div>`;

  // Support + Actions (full height)
  const supLabel = `<div style="width:${W6}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Support',g1.color,g1.bgColor)}</div>`;
  const actLabel = `<div style="width:${W7}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Actions',g1.color,g1.bgColor)}</div>`;

  // Governance 5.1 / 5.2 / 5.3 (full height)
  const g51 = `<div style="width:${W8}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Corporate Security &amp; IT Policy',g5.color,g5.bgColor,c51,g5)}</div>`;
  const g52 = `<div style="width:${W9}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Risk Management &amp; Internal Control',g5.color,g5.bgColor,c52,g5)}</div>`;
  const g53 = `<div style="width:${W10}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Law &amp; Compliance',g5.color,g5.bgColor,c53,g5)}</div>`;

  // Regulations + State Laws (static, full height)
  const regLabel = `<div style="width:${W11}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('Regulations','#999','rgba(150,150,150,.07)')}</div>`;
  const slLabel  = `<div style="width:${W12}px;flex-shrink:0;align-self:stretch;display:flex;">
    ${vSide('State Laws','#999','rgba(150,150,150,.07)')}</div>`;

  canvas.innerHTML = `
  <div style="display:flex;flex-direction:column;gap:${GAP}px">

    <!-- Main row: left + center + right all flex, height = center -->
    <div style="display:flex;flex-direction:row;gap:${GAP}px;align-items:stretch">
      ${leftStack}
      ${chanCol}
      ${portCol}
      ${cdLabel}
      ${spLabel}
      <div style="flex:1;min-width:0">${mainBox}</div>
      ${supLabel}
      ${actLabel}
      ${g51}
      ${g52}
      ${g53}
      ${regLabel}
      ${slLabel}
    </div>

    <!-- Enterprise IT — full width bottom bar -->
    <div class="bp-cat" style="background:rgba(80,100,140,.08);border:2px solid rgba(80,100,140,.3);
        border-radius:8px;padding-left:16px"
        data-grp="" data-cat="Enterprise Information Technology" data-code="EIT">
      <div class="bp-cat-label" style="font-size:13px;font-weight:700">
        🖧 Enterprise Information Technology
      </div>
      <div class="bp-cat-right">
        ${eitN?`<div class="bp-hbar" style="width:80px"><div class="bp-hbar-fill" style="width:${eitAvg}%;background:${eitC}"></div></div>`:''}
        <div class="bp-badge" style="background:${eitN?'#00d68f':'rgba(128,128,128,.2)'};color:${eitN?'#fff':'var(--muted)'};border:none;border-radius:11px">
          ${eitN||'—'}
        </div>
      </div>
    </div>

  </div>`;

  // ── Tooltip wiring ─────────────────────────────────────────────────────────
  const showTip = (el,grp,catName) => {
    const gd=EA_STRUCTURE.find(g=>g.group===grp);
    const cd=gd?.categories.find(c=>c.name===catName);
    const list=cd?getApps(gd,cd):[];
    if(!list.length){tooltip.classList.remove('visible');return;}
    const col=gd?.color||'var(--accent)';
    const shown=list.slice(0,8), more=list.length-shown.length;
    tooltip.innerHTML=`
      <div class="bp-tooltip-title" style="color:${col}">${catName}
        <span style="color:var(--dim);font-weight:400;font-size:11px">(${list.length} apps)</span>
      </div>
      ${shown.map(a=>`<div class="bp-tooltip-app">
        <span class="bp-tooltip-name">${a.name}</span>
        <span class="bp-tooltip-score" style="color:${hc(a.health)}">${a.health}</span>
      </div>`).join('')}
      ${more?`<div class="bp-tooltip-more">+${more} apps เพิ่มเติม</div>`:''}`;
    tooltip.classList.add('visible');
  };
  const moveTip = e => {
    const tw=tooltip.offsetWidth, th=tooltip.offsetHeight;
    const vw=window.innerWidth,   vh=window.innerHeight;
    tooltip.style.left=(e.clientX+tw+16>vw?e.clientX-tw-8:e.clientX+12)+'px';
    tooltip.style.top =(e.clientY+th+8>vh?e.clientY-th-4:e.clientY+10)+'px';
  };
  canvas.querySelectorAll('[data-cat]').forEach(el=>{
    el.addEventListener('mouseenter',e=>showTip(el,el.dataset.grp,el.dataset.cat));
    el.addEventListener('mousemove', moveTip);
    el.addEventListener('mouseleave',()=>tooltip.classList.remove('visible'));
    el.addEventListener('click',()=>{
      tooltip.classList.remove('visible');
      if(el.dataset.grp){
        navigate('ea-landscape');
        setTimeout(()=>{
          const s=document.getElementById('inv-ea-group');
          if(s){s.value=el.dataset.grp;s.dispatchEvent(new Event('change'));}
        },100);
      }
    });
  });
}


// ─── MPX 2 — Image Overlay ────────────────────────────────────────────────
function renderMPX2(){
  const wrap    = document.getElementById('mpx2-wrap');
  const overlay = document.getElementById('mpx2-overlay');
  const tooltip = document.getElementById('mpx2-tooltip');
  if(!overlay) return;

  const hc   = v => v>=70?'#00d68f':v>=50?'#ffa000':'#ff4757';
  const hcBg = v => v>=70?'rgba(0,214,143,.18)':v>=50?'rgba(255,160,0,.18)':'rgba(255,71,87,.18)';

  const getApps = (grp,cat) => {
    const gd = EA_STRUCTURE.find(g=>g.group===grp);
    const cd = gd?.categories.find(c=>c.name===cat);
    if(!gd||!cd) return [];
    return apps.filter(a=>
      !a.decommissioned && a.eaGroup===gd.group && a.eaCategory &&
      (a.eaCategory.startsWith(cd.code) ||
       a.eaCategory.replace(/^\d+\.\d+\s*/,'')===cd.name)
    );
  };

  // Badge positions: อ่านจาก API (/api/config/mpx2/badges) ก่อน
  // ถ้า API ไม่มี (demo mode) fallback ไปอ่านจาก <script id="appport-config">
  const _getEmbeddedBlocks = () => {
    try{
      const el  = document.getElementById('appport-config');
      const cfg = el ? JSON.parse(el.textContent) : {};
      return cfg.mpx2?.badges || [];
    }catch(e){
      console.warn('appport-config parse error:',e);
      return [];
    }
  };

  const _buildBadges = (BLOCKS) => {
  // Build badges
  overlay.innerHTML = BLOCKS.map(b => {
    const list = getApps(b.grp, b.cat);
    const n    = list.length;
    const avg  = n ? Math.round(list.reduce((s,a)=>s+a.health,0)/n) : 0;
    const c    = n ? hc(avg)  : '#888';
    const bg   = n ? hcBg(avg): 'rgba(100,100,100,.15)';
    // Badge positioned at center of block
    const bx   = b.l + b.w/2;
    const by   = b.t + b.h/2;
    return `<div
      data-grp="${b.grp}" data-cat="${b.cat}"
      style="position:absolute;left:${bx}%;top:${by}%;
        transform:translate(-50%,-50%);
        pointer-events:all;cursor:${n?'pointer':'default'};
        z-index:10">
      <div style="
        background:white;border:2.5px solid #1565c0;border-radius:50%;
        color:#1565c0;font-size:13px;font-weight:800;font-family:var(--mono);
        width:32px;height:32px;display:flex;align-items:center;justify-content:center;
        box-shadow:0 2px 8px rgba(0,0,0,.30);
        transition:transform .15s,box-shadow .15s;
        ${n?'':'opacity:.45'}">
        ${n || '—'}
      </div>
    </div>`;
  }).join('');

  // ── wire all events INSIDE _buildBadges (badges exist at this point) ────────
  const showTip = (el, grp, catName) => {
    const list = getApps(grp, catName);
    if(!list.length){ tooltip.classList.remove('visible'); return; }
    const gd  = EA_STRUCTURE.find(g=>g.group===grp);
    const col = gd?.color||'#888';
    const shown = list.slice(0,8), more = list.length - shown.length;
    tooltip.innerHTML = `
      <div class="bp-tooltip-title" style="color:${col}">${catName}
        <span style="color:var(--dim);font-weight:400;font-size:11px">(${list.length} apps)</span>
      </div>
      ${shown.map(a=>`<div class="bp-tooltip-app">
        <span class="bp-tooltip-name">${a.name}</span>
        <span class="bp-tooltip-score" style="color:${hc(a.health)}">${a.health}</span>
      </div>`).join('')}
      ${more?`<div class="bp-tooltip-more">+${more} apps เพิ่มเติม</div>`:''}`;
    tooltip.classList.add('visible');
  };
  const moveTip = e => {
    const tw=tooltip.offsetWidth, th=tooltip.offsetHeight;
    const vw=window.innerWidth, vh=window.innerHeight;
    tooltip.style.left=(e.clientX+tw+16>vw?e.clientX-tw-8:e.clientX+12)+'px';
    tooltip.style.top =(e.clientY+th+8>vh?e.clientY-th-4:e.clientY+10)+'px';
  };
  overlay.querySelectorAll('[data-cat]').forEach(el => {
    el.addEventListener('mouseenter', () => { showTip(el,el.dataset.grp,el.dataset.cat); el.querySelector('div').style.transform='scale(1.12)'; });
    el.addEventListener('mousemove',  moveTip);
    el.addEventListener('mouseleave', () => { tooltip.classList.remove('visible'); el.querySelector('div').style.transform=''; });
    el.addEventListener('click', () => {
      tooltip.classList.remove('visible');
      if(el.dataset.grp){
        navigate('ea-landscape');
        setTimeout(()=>{
          const s=document.getElementById('inv-ea-group');
          if(s){s.value=el.dataset.grp; s.dispatchEvent(new Event('change'));}
        },120);
      }
    });
  });
  }; // end _buildBadges

  // ── Async loader: API first → fallback embedded ───────────────────────────
  fetch('/api/config/mpx2/badges')
    .then(r => r.ok ? r.json() : Promise.reject('no-api'))
    .then(data => {
      const blocks = data.badges || data;
      if(Array.isArray(blocks) && blocks.length){
        console.log('[MPX2] loaded', blocks.length, 'badges from /api/config');
        _buildBadges(blocks);
      } else {
        throw new Error('empty');
      }
    })
    .catch(() => {
      console.log('[MPX2] API unavailable — using embedded config');
      _buildBadges(_getEmbeddedBlocks());
    });
}

function renderEALandscape(){
  const gf = document.getElementById('ea-filter-group');
  if(gf && gf.options.length <= 1){
    EA_STRUCTURE.forEach(g => {
      const o = document.createElement('option');
      o.value = g.group; o.textContent = g.group; gf.appendChild(o);
    });
  }
  if(!document.getElementById('ea-search').__eaWired){
    document.getElementById('ea-search').__eaWired = true;
    ['ea-search','ea-filter-group','ea-filter-status'].forEach(id=>{
      const el = document.getElementById(id);
      const evt = id==='ea-search'?'input':'change';
      el?.addEventListener(evt, ()=>renderEAContent());
    });
    document.getElementById('ea-view-landscape').addEventListener('click',()=>{
      eaViewMode='landscape';
      document.getElementById('ea-view-landscape').classList.add('active');
      document.getElementById('ea-view-list').classList.remove('active');
      renderEAContent();
    });
    document.getElementById('ea-view-list').addEventListener('click',()=>{
      eaViewMode='list';
      document.getElementById('ea-view-list').classList.add('active');
      document.getElementById('ea-view-landscape').classList.remove('active');
      renderEAContent();
    });
  }
  renderEAContent();
}

function renderEAContent(){
  const search  = (document.getElementById('ea-search')?.value||'').toLowerCase();
  const grpF    = document.getElementById('ea-filter-group')?.value||'';
  const statusF = document.getElementById('ea-filter-status')?.value||'';
  const filtered = apps.filter(a=>{
    if(a.decommissioned) return false;
    if(grpF    && a.eaGroup  !== grpF)    return false;
    if(statusF && a.status   !== statusF) return false;
    if(search){
      const hay = (a.name+a.id+a.eaGroup+a.eaCategory+a.domain).toLowerCase();
      if(!hay.includes(search)) return false;
    }
    return true;
  });
  document.getElementById('ea-count').textContent = `${filtered.length} แอป`;
  const container = document.getElementById('ea-landscape-content');
  eaViewMode==='list' ? renderEAList(filtered,container) : renderEAMap(filtered,container);
}

function renderEAMap(filtered, container){
  const grpFilter = document.getElementById('ea-filter-group')?.value||'';
  const structs = grpFilter ? EA_STRUCTURE.filter(g=>g.group===grpFilter) : EA_STRUCTURE;
  const statusDot = {Active:'var(--green)',"Phase-out":'var(--yellow)',"To-retire":'var(--red)',Planned:'var(--accent)'};
  container.innerHTML = `<div class="ea-landscape-grid">${
    structs.map(grp=>{
      const grpApps = filtered.filter(a=>a.eaGroup===grp.group);
      const catRows = grp.categories.map(cat=>{
        const catCode = `${cat.code} ${cat.name}`;
        const catApps = grpApps.filter(a=>a.eaCategory===catCode);
        const chips = catApps.length
          ? catApps.map(a=>`<div class="ea-app-chip" title="${a.name}"
              onclick="openAppQuickView('${a.id}')" style="cursor:pointer;position:relative">
              <div class="chip-dot" style="background:${statusDot[a.status]||'var(--muted)'}"></div>
              <span class="chip-name">${a.name}</span>
              <span class="chip-health">${a.health}</span>
            </div>`).join('')
          : `<span class="ea-empty-row">— ไม่มีแอป —</span>`;
        return `<div class="ea-cat-row">
          <div class="ea-cat-label" style="border-left:3px solid ${grp.color}">
            <span class="ea-cat-num">${cat.code}</span>
            <span class="ea-cat-title">${cat.name}</span>
            <span class="ea-cat-count">${catApps.length} แอป</span>
          </div>
          <div class="ea-apps-row">${chips}</div>
        </div>`;
      }).join('');
      return `<div class="ea-group-block">
        <div class="ea-group-header" style="background:${grp.bgColor}">
          <div class="ea-group-num" style="background:${grp.color}">${grp.group.split('.')[0]}</div>
          <div>
            <div class="ea-group-name">${grp.group}</div>
            <div style="font-size:11px;color:var(--dim);font-family:var(--mono)">${grpApps.length} แอปพลิเคชัน · ${grp.categories.length} categories</div>
          </div>
          <div class="ea-group-meta">${grp.categories.map(c=>c.code).join(' · ')}</div>
        </div>
        <div class="ea-cats-wrap">${catRows}</div>
      </div>`;
    }).join('')
  }</div>`;
}

function renderEAList(filtered, container){
  const statusColor2 = {Active:'var(--green)',"Phase-out":'var(--yellow)',"To-retire":'var(--red)',Planned:'var(--accent)',Decommissioned:'var(--muted)'};
  const grpColors = {};
  EA_STRUCTURE.forEach(g=>grpColors[g.group]=g.color);
  container.innerHTML = `<div class="card" style="padding:0;overflow:hidden">
    <div class="tbl-scroll" style="max-height:calc(100vh - 220px)">
    <table class="tbl sticky-header ea-list-tbl">
      <thead><tr>
        <th>App ID</th><th>ชื่อแอป</th><th>Domain</th>
        <th>EA Group</th><th>EA Category</th><th>EA Sub-Category</th>
        <th>Status</th><th>Health</th><th>BCG</th>
      </tr></thead>
      <tbody>${
        [...filtered].sort((a,b)=>a.eaGroup.localeCompare(b.eaGroup)||a.eaCategory.localeCompare(b.eaCategory)).map(a=>`
        <tr>
          <td style="font-family:var(--mono);font-size:11px;color:var(--dim)">${a.id}</td>
          <td style="font-weight:700;color:var(--text);font-size:13px">${a.name}</td>
          <td><span class="badge" style="background:rgba(0,229,255,.08);color:var(--accent);border:1px solid rgba(0,229,255,.15)">${a.domain}</span></td>
          <td><span class="badge" style="background:${grpColors[a.eaGroup]||'var(--accent)'}22;color:${grpColors[a.eaGroup]||'var(--accent)'};border:1px solid ${grpColors[a.eaGroup]||'var(--accent)'}44;white-space:nowrap">${a.eaGroup}</span></td>
          <td style="font-size:12px;color:var(--text)">${a.eaCategory}</td>
          <td style="font-size:12px;color:var(--muted);font-family:var(--mono)">${a.eaSubCategory||'-'}</td>
          <td><span class="badge" style="background:${statusColor2[a.status]||'var(--muted)'}22;color:${statusColor2[a.status]||'var(--muted)'};border:1px solid ${statusColor2[a.status]||'var(--muted)'}44">${a.status}</span></td>
          <td>
            <div style="display:flex;align-items:center;gap:6px">
              <div class="hbar-wrap" style="width:44px;height:5px"><div class="hbar-fill" style="width:${a.health}%;background:${a.health>=80?'var(--green)':a.health>=60?'var(--yellow)':'var(--red)'}"></div></div>
              <span style="font-family:var(--mono);font-size:11px;color:${a.health>=80?'var(--green)':a.health>=60?'var(--yellow)':'var(--red)'}">${a.health}</span>
            </div>
          </td>
          <td><span class="badge" style="background:var(--${a.bcg.toLowerCase()})22;color:var(--${a.bcg.toLowerCase()});border:1px solid var(--${a.bcg.toLowerCase()})44">${a.bcg}</span></td>
        </tr>`).join('')
      }</tbody>
    </table>
    </div></div>`;
}

// ─── APP INVENTORY ────────────────────────────────────────────────────────────

function getInvFilters(){
  return {
    search: (document.getElementById('inv-search')?.value||'').toLowerCase(),
    domain: document.getElementById('inv-filter-domain')?.value||'',
    status: document.getElementById('inv-filter-status')?.value||'',
    type:   document.getElementById('inv-filter-type')?.value||'',
    showDecomm: document.getElementById('inv-show-decomm')?.checked||false
  };
}

function renderInventory(){
  // Populate domain filter once
  const dd = document.getElementById('inv-filter-domain');
  if(dd && dd.options.length <= 1){
    const domains = [...new Set(apps.map(a=>a.domain))].sort();
    domains.forEach(d=>{ const o=document.createElement('option'); o.value=d; o.textContent=d; dd.appendChild(o); });
  }

  // Wire up filters (idempotent guard)
  if(!document.getElementById('inv-search').__wired){
    document.getElementById('inv-search').__wired = true;
    ['inv-search','inv-filter-domain','inv-filter-status','inv-filter-type'].forEach(id=>{
      const el = document.getElementById(id);
      const evt = id==='inv-search'?'input':'change';
      el?.addEventListener(evt, ()=>renderInventoryRows());
    });
    document.getElementById('inv-show-decomm')?.addEventListener('change', ()=>renderInventoryRows());
  }

  renderInventoryRows();
}

function renderInventoryRows(){
  const f = getInvFilters();
  const filtered = apps.filter(a=>{
    if(!f.showDecomm && a.decommissioned) return false;
    if(f.domain && a.domain !== f.domain) return false;
    if(f.status && a.status !== f.status) return false;
    if(f.type && a.type !== f.type) return false;
    if(f.search){
      const hay = (a.name+a.id+a.vendor+a.domain+a.capability+a.owner+(a.bizOwner||'')).toLowerCase();
      if(!hay.includes(f.search)) return false;
    }
    return true;
  });

  document.getElementById('inv-count').textContent = `${filtered.length} รายการ`;

  const tbody = document.getElementById('inv-tbody');
  tbody.innerHTML = filtered.map((a,i)=>{
    const isDecomm = !!a.decommissioned;
    const rowClass = isDecomm ? 'row-decomm' : '';
    const hc_ = s=>s>=80?'var(--green)':s>=60?'var(--yellow)':'var(--red)';
    const sc_ = {Active:'var(--green)',"Phase-out":'var(--yellow)',"To-retire":'var(--red)',Planned:'var(--accent)',Decommissioned:'var(--muted)'}[a.status]||'var(--muted)';

    const statusDisplay = isDecomm
      ? `<span class="decomm-strip decomm-badge">🔴 DECOMMISSIONED</span>`
      : `<span class="badge" style="background:${sc_}22;color:${sc_};border:1px solid ${sc_}44">${a.status}</span>`;

    const decomDate = isDecomm && a.decommDate ? `<div style="font-size:10px;color:var(--red);font-family:var(--mono);margin-top:2px">สิ้นสุด: ${a.decommDate}</div>` : '';

    const editDisabled = isDecomm ? 'disabled title="App ถูก Decommission แล้ว"' : '';
    const decommDisabled = isDecomm ? 'disabled title="App ถูก Decommission แล้วแล้ว"' : '';
    const decommIcon = isDecomm ? '🔓' : '🔴';
    const decommTitle = isDecomm ? 'ปลดระวางแล้ว' : 'Decommission';

    return `<tr class="${rowClass}" data-id="${a.id}">
      <td style="text-align:center;color:var(--muted);font-size:11px;font-family:var(--mono)">${i+1}</td>
      <td style="font-family:var(--mono);font-size:11px;color:var(--dim);white-space:nowrap">${a.id}</td>
      <td>
        <div style="font-weight:700;color:${isDecomm?'var(--muted)':'var(--text)'};font-size:13px">${a.name}</div>
        <div style="font-size:10px;color:var(--muted);margin-top:1px">${a.capability||''}</div>
        ${decomDate}
      </td>
      <td><span class="badge" style="background:rgba(0,229,255,.08);color:var(--accent);border:1px solid rgba(0,229,255,.15)">${a.domain}</span></td>
      <td style="font-size:12px;color:var(--dim)">${a.vendor}</td>
      <td><span class="badge" style="background:${a.type==='Inhouse'?'rgba(0,214,143,.1)':'rgba(74,158,255,.1)'};color:${a.type==='Inhouse'?'var(--green)':'var(--blue)'};border:1px solid ${a.type==='Inhouse'?'rgba(0,214,143,.2)':'rgba(74,158,255,.2)'}">${a.type}</span></td>
      <td>${statusDisplay}</td>
      <td><span class="badge" style="background:${a.criticality==='Mission Critical'?'rgba(123,97,255,.15)':'rgba(107,132,160,.1)'};color:${a.criticality==='Mission Critical'?'var(--accent2)':'var(--dim)'};border:1px solid ${a.criticality==='Mission Critical'?'rgba(123,97,255,.3)':'var(--border)'}">${a.criticality}</span></td>
      <td>
        <div style="display:flex;align-items:center;gap:7px">
          <div class="hbar-wrap" style="width:52px;height:6px"><div class="hbar-fill" style="width:${a.health}%;background:${hc_(a.health)}"></div></div>
          <span style="font-family:var(--mono);font-size:12px;font-weight:700;color:${hc_(a.health)}">${a.health}</span>
        </div>
      </td>
      <td style="font-family:var(--mono);font-size:12px;color:var(--accent3);white-space:nowrap">฿${(a.tco||0).toLocaleString()}K</td>
      <td style="font-size:12px;color:var(--dim);white-space:nowrap">${a.owner||'—'}</td>
      <td style="font-size:11px;color:var(--dim);white-space:nowrap;max-width:160px;overflow:hidden;text-overflow:ellipsis" title="${a.bizOwner||'—'}">${a.bizOwner||'—'}</td>
      <td style="font-size:11px;color:var(--muted);font-family:var(--mono);white-space:nowrap">${a.lastUpdated||'—'}</td>
      <td>
        <div class="act-btn-row">
          <button class="act-btn edit-btn" ${editDisabled} onclick="openEditModal('${a.id}')" title="แก้ไข">✏️</button>
          <button class="act-btn decomm-btn" ${decommDisabled} onclick="openDecommModal('${a.id}')" title="${decommTitle}">${decommIcon}</button>
        </div>
      </td>
    </tr>`;
  }).join('');
}

// ── EDIT MODAL ────────────────────────────────────────────────────────────────
let editingAppId = null;

// Tab switching
document.querySelectorAll('.edit-tab').forEach(tab=>{
  tab.addEventListener('click',()=>{
    document.querySelectorAll('.edit-tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.edit-tab-panel').forEach(p=>p.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById('tab-'+tab.dataset.tab).classList.add('active');
  });
});

// EA category options per group
const EA_CAT_OPTIONS = {
  '1. Direction': ['1.1 BOD','1.2 Vision, Mission, Strategies','1.3 Goals, Objectives','1.4 Governance Body','1.5 Standard & Policies','1.6 Business Process & Services'],
  '2. Services':  ['2.1 Customer','2.2 Partner','2.3 Service','2.4 Employee','2.6 Channel','2.7 Portal & Gateway'],
  '3. Core Products': ['3.1 Organization','3.2 Corporate & Core System','3.3 Back Office & Support System'],
  '4. Support':   ['4.1 Training & Communication','4.2 Corporate Information','4.3 Corporate Application & Information Technology'],
  '5. Governance':['5.1 Corporate Security & Policy','5.2 Risk & Internal Control','5.3 Law & Compliance'],
};

function updateEACategoryDropdown(selectedGroup, selectedCat){
  const catSel = document.getElementById('e-ea-category');
  catSel.innerHTML = '<option value="">— เลือก EA Category —</option>';
  const opts = EA_CAT_OPTIONS[selectedGroup]||[];
  opts.forEach(c=>{
    const o = document.createElement('option');
    o.value = c; o.textContent = c;
    if(c === selectedCat) o.selected = true;
    catSel.appendChild(o);
  });
}

function updateEAPreview(){
  const grp  = document.getElementById('e-ea-group').value;
  const cat  = document.getElementById('e-ea-category').value;
  const sub  = document.getElementById('e-ea-subcategory').value.trim();
  const card = document.getElementById('ea-preview-card');
  if(!grp){ card.style.display='none'; return; }
  card.style.display='block';
  document.getElementById('ea-prev-group').textContent = grp;
  document.getElementById('ea-prev-cat').textContent   = cat||'—';
  document.getElementById('ea-prev-sub').textContent   = sub||'-';
}

document.getElementById('e-ea-group').addEventListener('change', function(){
  updateEACategoryDropdown(this.value, '');
  updateEAPreview();
});
document.getElementById('e-ea-category').addEventListener('change', updateEAPreview);
document.getElementById('e-ea-subcategory').addEventListener('input', updateEAPreview);

function openEditModal(id){
  const a = apps.find(x=>x.id===id);
  if(!a) return;
  editingAppId = id;

  // Reset to first tab
  document.querySelectorAll('.edit-tab').forEach((t,i)=>t.classList.toggle('active',i===0));
  document.querySelectorAll('.edit-tab-panel').forEach((p,i)=>p.classList.toggle('active',i===0));

  document.getElementById('edit-app-id').textContent = id;

  // App Info tab
  document.getElementById('e-name').value       = a.name||'';
  document.getElementById('e-vendor').value     = a.vendor||'';
  document.getElementById('e-health').value     = a.health||75;
  document.getElementById('e-tco').value        = a.tco||0;
  document.getElementById('e-users').value      = a.users||0;
  document.getElementById('e-age').value        = a.age||0;
  document.getElementById('e-stack').value      = (a.stack||[]).join(', ');
  document.getElementById('e-capability').value = a.capability||'';
  document.getElementById('e-bizowner').value   = a.bizOwner||'';
  setCheckedCompliance('e-compliance', a.compliance||[]);
  setSelectVal('e-domain',      a.domain);
  setSelectVal('e-type',        a.type);
  setSelectVal('e-status',      a.status);
  setSelectVal('e-bcg',         a.bcg);
  setSelectVal('e-criticality', a.criticality);
  setSelectVal('e-dr',          String(a.dr));

  // EA tab
  const eaGrp = a.eaGroup||'';
  const eaCat = a.eaCategory||'';
  setSelectVal('e-ea-group', eaGrp);
  updateEACategoryDropdown(eaGrp, eaCat);
  document.getElementById('e-ea-subcategory').value = (a.eaSubCategory==='-'?'':a.eaSubCategory)||'';
  updateEAPreview();

  // IT Ops tab
  document.getElementById('e-owner').value      = a.owner||'';
  document.getElementById('e-maintwindow').value = a.maintWindow||'';
  document.getElementById('e-persons').value    = a.persons||0;
  document.getElementById('e-eol').value        = a.eol||'';
  setSelectVal('e-service',  a.serviceHour);
  setSelectVal('e-support',  a.support);
  setSelectVal('e-srcavail', String(a.srcAvail));

  document.getElementById('modal-edit').style.display='flex';
}

function setSelectVal(id, val){
  const sel = document.getElementById(id);
  if(!sel) return;
  for(let o of sel.options) if(o.value===val||o.text===val){ sel.value=o.value; return; }
}

document.getElementById('modal-edit-close').onclick  = ()=>document.getElementById('modal-edit').style.display='none';
document.getElementById('modal-edit-cancel').onclick = ()=>document.getElementById('modal-edit').style.display='none';
document.getElementById('modal-edit').onclick = e=>{ if(e.target===document.getElementById('modal-edit')) document.getElementById('modal-edit').style.display='none'; };

// BUG-03: handler เก่า (local-state-only) ถูกลบออก
// → ใช้ async handler ที่เรียก PUT /api/apps/:id แทน (ดูด้านล่าง)

// ── DECOMMISSION MODAL ────────────────────────────────────────────────────────
let decommAppId = null;

function openDecommModal(id){
  const a = apps.find(x=>x.id===id);
  if(!a || a.decommissioned) return;
  decommAppId = id;

  document.getElementById('decomm-body').innerHTML=`
    <div class="decomm-info-card">
      <div class="di-name">${escapeHTML(a.name)}</div>
      <div class="di-meta">
        <span>${escapeHTML(a.id)}</span>
        <span>•</span><span>${escapeHTML(a.domain)}</span>
        <span>•</span><span>${escapeHTML(a.vendor)}</span>
        <span>•</span><span style="color:${a.criticality==='Mission Critical'?'var(--accent2)':'var(--dim)'}">${escapeHTML(a.criticality)}</span>
      </div>
      ${a.criticality==='Mission Critical'?`<div style="margin-top:8px;font-size:12px;color:var(--red);font-weight:600">⚠️ แอปนี้เป็น Mission Critical — โปรดตรวจสอบแผน Transition ก่อน</div>`:''}
    </div>
    <div class="decomm-warning">
      ⚠️ การ Decommission จะทำให้แอปพลิเคชันนี้ถูกทำเครื่องหมายว่า <strong>สิ้นสุดการใช้งาน</strong>
      แล้ว ข้อมูลยังคงอยู่ในระบบเพื่อการ audit แต่จะไม่ถูกนับใน KPI และ Active Portfolio อีกต่อไป
    </div>
    <div class="decomm-date-field">
      <label class="form-label">วันที่สิ้นสุดการใช้งาน</label>
      <input class="form-input" id="decomm-date" type="date" value="${new Date().toISOString().slice(0,10)}">
    </div>
    <div style="margin-top:10px">
      <label class="form-label" style="margin-bottom:5px;display:block">เหตุผลในการปลดระวาง</label>
      <textarea class="form-input" id="decomm-reason" rows="3" placeholder="เช่น ระบบถูกแทนที่ด้วย SAP S/4HANA, สิ้นสุด contract, ฯลฯ" style="resize:vertical"></textarea>
    </div>`;

  document.getElementById('modal-decomm').style.display='flex';
}

document.getElementById('modal-decomm-close').onclick  = ()=>document.getElementById('modal-decomm').style.display='none';
document.getElementById('modal-decomm-cancel').onclick = ()=>document.getElementById('modal-decomm').style.display='none';
document.getElementById('modal-decomm').onclick = e=>{ if(e.target===document.getElementById('modal-decomm')) document.getElementById('modal-decomm').style.display='none'; };

// BUG-03: handler เก่า (local-state-only) ถูกลบออก
// → ใช้ async handler ที่เรียก POST /api/apps/:id/decommission แทน (ดูด้านล่าง)

// ─── MODAL ─────────────────────────────────────────────────────────────────────
// ── ADD APP MODAL ─────────────────────────────────────────────────────────────
const AM_TABS_LABEL = ['Identity','Technical','Business','EA & Planning','Ownership'];
let amCur = 1;
let amSelGroup = null, amSelCat = null;

// EA structure (same as EA_STRUCTURE above)
const AM_EAS = [
  {g:'1. Direction',    code:'1', c:'#7b61ff', ico:'🎯',
   cats:[{n:'1.1',l:'BOD'},{n:'1.2',l:'Vision, Mission, Strategies'},
         {n:'1.3',l:'Goals, Objectives'},{n:'1.4',l:'Governance Body'},
         {n:'1.5',l:'Standard & Policies'},{n:'1.6',l:'Business Process & Services'}]},
  {g:'2. Services',     code:'2', c:'#00e5ff', ico:'🛎',
   cats:[{n:'2.1',l:'Customer'},{n:'2.2',l:'Partner'},{n:'2.3',l:'Service'},
         {n:'2.4',l:'Employee'},{n:'2.6',l:'Channel'},{n:'2.7',l:'Portal & Gateway'}]},
  {g:'3. Core Products',code:'3', c:'#00d68f', ico:'⚙️',
   cats:[{n:'3.1',l:'Organization'},{n:'3.2',l:'Corporate & Core System'},
         {n:'3.3',l:'Back Office & Support System'}]},
  {g:'4. Support',      code:'4', c:'#ff9f43', ico:'🔧',
   cats:[{n:'4.1',l:'Training & Communication'},{n:'4.2',l:'Corporate Information'},
         {n:'4.3',l:'Corporate Application & Information Technology'}]},
  {g:'5. Governance',   code:'5', c:'#ff4757', ico:'🛡',
   cats:[{n:'5.1',l:'Corporate Security & Policy'},{n:'5.2',l:'Risk & Internal Control'},
         {n:'5.3',l:'Law & Compliance'}]},
];

function amOpenModal(){
  amCur=1; amSelGroup=null; amSelCat=null;
  amGoTab(1);
  // reset all fields
  ['f-name','f-vendor','f-capability','f-lang','f-os','f-db','f-owner','f-owner-email',
   'f-bizowner','f-dept','f-desc','f-notes','f-stream','f-easub'].forEach(id=>{
    const el=document.getElementById(id); if(el) el.value='';
  });
  ['f-integration','f-persons'].forEach(id=>{const el=document.getElementById(id);if(el)el.value=el.id==='f-integration'?'5':'2';});
  document.getElementById('f-tco').value='1000';
  document.getElementById('f-users').value='100';
  document.getElementById('f-age').value='2';
  document.getElementById('f-eol').value='2030-12';
  document.getElementById('f-contractend').value='2027-06';
  document.getElementById('f-assessdate').value='';
  const sh=document.getElementById('f-health'); sh.value=75;
  sh.style.background='linear-gradient(to right,var(--accent) 75%,var(--border) 75%)';
  document.getElementById('am-sv-h').textContent='75';
  const ss=document.getElementById('f-strategic'); ss.value=70;
  ss.style.background='linear-gradient(to right,var(--accent) 70%,var(--border) 70%)';
  document.getElementById('am-sv-s').textContent='70';
  // reset toggles
  ['am-tg-type','am-tg-status','am-tg-dr','am-tg-pi','am-tg-src','am-tg-bcg0'].forEach(id=>{
    const btns=document.querySelectorAll('#'+id+' .am-tgb');
    btns.forEach((b,i)=>b.classList.toggle('am-on',i===0));
  });
  // reset wave
  document.querySelectorAll('.am-wb').forEach((b,i)=>b.classList.toggle('am-on',i===0));
  // reset chips
  const cw=document.getElementById('am-cw-stack');
  cw.querySelectorAll('.am-chip').forEach(c=>c.remove());
  // reset EA
  document.getElementById('am-eac-wrap').classList.remove('am-on');
  document.getElementById('am-easub-wrap').classList.remove('am-on');
  document.getElementById('am-ea-bc').classList.remove('am-on');
  document.getElementById('am-id-out').textContent='APP-???';
  amBuildEAGroups();
  document.getElementById('modal').style.display='flex';
}

function amGoTab(n){
  [1,2,3,4,5].forEach(i=>{
    document.getElementById('am-sec'+i).classList.toggle('am-on',i===n);
    const t=document.getElementById('am-tab'+i);
    t.classList.remove('am-active','am-done');
    if(i===n) t.classList.add('am-active');
    else if(i<n) t.classList.add('am-done');
    t.querySelector('.am-tn').textContent=i<n?'✓':String(i);
  });
  amCur=n;
  document.getElementById('am-step-info').textContent=`Step ${n} of 5 · ${AM_TABS_LABEL[n-1]}`;
  document.getElementById('am-btn-prev').style.display=n>1?'flex':'none';
  document.getElementById('am-btn-next').style.display=n<5?'flex':'none';
  document.getElementById('modal-submit').style.display=n===5?'flex':'none';
  document.getElementById('am-body').scrollTop=0;
}
function amNav(d){ amGoTab(Math.max(1,Math.min(5,amCur+d))); }
function amTog(id,btn){ document.querySelectorAll('#'+id+' .am-tgb').forEach(b=>b.classList.remove('am-on')); btn.classList.add('am-on'); }
function amSelWave(btn){ document.querySelectorAll('.am-wb').forEach(b=>b.classList.remove('am-on')); btn.classList.add('am-on'); }
function amUpId(){
  const v=document.getElementById('f-name').value;
  document.getElementById('am-id-out').textContent=v?'APP-'+String(Math.abs(v.split('').reduce((a,c)=>a+c.charCodeAt(0),0))%900+100):'APP-???';
}
function amChipKey(e,input,wrapId){
  if(e.key==='Enter'||e.key===','){
    e.preventDefault();
    const v=input.value.trim().replace(/,$/,'');
    if(!v) return;
    const c=document.createElement('div'); c.className='am-chip';
    c.innerHTML=v+'<button class="am-chip-x" onclick="this.parentElement.remove()">×</button>';
    document.getElementById(wrapId).insertBefore(c,input); input.value='';
  }
  if(e.key==='Backspace'&&!input.value){
    const ch=document.getElementById(wrapId).querySelectorAll('.am-chip');
    if(ch.length) ch[ch.length-1].remove();
  }
}
function amBuildEAGroups(){
  const grid=document.getElementById('am-eag-grid'); grid.innerHTML='';
  AM_EAS.forEach(g=>{
    const btn=document.createElement('button');
    btn.className='am-eag'; btn.style.setProperty('--eac',g.c);
    btn.innerHTML=`<div class="am-eag-icon">${g.ico}</div><div class="am-eag-code">${g.code}</div><div class="am-eag-name">${g.g.replace(/^\d+\.\s*/,'')}</div><div class="am-eag-n">${g.cats.length} cats</div>`;
    btn.onclick=()=>amSelEAGroup(g,btn);
    grid.appendChild(btn);
  });
}
function amSelEAGroup(g,btn){
  document.querySelectorAll('.am-eag').forEach(b=>b.classList.remove('am-on'));
  btn.classList.add('am-on'); amSelGroup=g; amSelCat=null;
  const list=document.getElementById('am-eac-list'); list.innerHTML='';
  g.cats.forEach(c=>{
    const b=document.createElement('button'); b.className='am-eac'; b.style.setProperty('--eac',g.c);
    b.innerHTML=`<div style="display:flex;align-items:center;gap:11px;flex:1"><span class="am-eac-code">${c.n}</span><span class="am-eac-name">${c.l}</span></div><div class="am-eac-chk">✓</div>`;
    b.onclick=()=>amSelEACat(c,b);
    list.appendChild(b);
  });
  document.getElementById('am-eac-wrap').classList.add('am-on');
  document.getElementById('am-easub-wrap').classList.remove('am-on');
  amUpEAPreview();
}
function amSelEACat(c,btn){
  document.querySelectorAll('.am-eac').forEach(b=>b.classList.remove('am-on'));
  btn.classList.add('am-on'); amSelCat=c;
  document.getElementById('am-easub-wrap').classList.add('am-on');
  document.getElementById('f-easub').value='';
  amUpEAPreview();
  setTimeout(()=>btn.scrollIntoView({behavior:'smooth',block:'nearest'}),50);
}
function amUpEAPreview(){
  const bc=document.getElementById('am-ea-bc'), row=document.getElementById('am-ea-bc-row');
  if(!amSelGroup){bc.classList.remove('am-on');return;}
  bc.classList.add('am-on');
  const col=amSelGroup.c, sub=(document.getElementById('f-easub')||{}).value?.trim()||'';
  let h=`<div class="am-bc-seg" style="border-color:${col}44"><div class="am-bc-dot" style="background:${col}"></div><span class="am-bc-t" style="color:${col}">${amSelGroup.g}</span></div><span class="am-bc-arr">›</span>`;
  if(amSelCat) h+=`<div class="am-bc-seg" style="border-color:${col}28"><span class="am-bc-t">${amSelCat.n} ${amSelCat.l}</span></div>`;
  else h+=`<span class="am-bc-opt">— เลือก Category —</span>`;
  if(sub) h+=`<span class="am-bc-arr">›</span><div class="am-bc-seg"><span class="am-bc-dim" style="font-style:italic">${sub}</span></div>`;
  else if(amSelCat) h+=`<span class="am-bc-arr">›</span><span class="am-bc-opt">Sub-Category (optional)</span>`;
  row.innerHTML=h;
}

// open/close
document.getElementById('btn-add-app').onclick=()=>amOpenModal();
document.getElementById('modal-close').onclick=()=>document.getElementById('modal').style.display='none';
document.getElementById('modal-cancel').onclick=()=>document.getElementById('modal').style.display='none';
document.getElementById('modal').onclick=e=>{ if(e.target===document.getElementById('modal'))document.getElementById('modal').style.display='none'; };

// SUBMIT — collect all 39 fields
document.getElementById('modal-submit').onclick=()=>{
  const name=document.getElementById('f-name').value.trim();
  if(!name){ amGoTab(1); document.getElementById('f-name').focus(); return; }
  const h=+document.getElementById('f-health').value||75;
  // type
  const typeBtn=document.querySelector('#am-tg-type .am-tgb.am-on');
  const type=typeBtn?typeBtn.textContent.replace(/[^\w]/g,'').trim().replace(/^Package$/,'Package').replace(/^Inhouse$/,'Inhouse'):'Package';
  const typeVal=type.includes('Inhouse')?'Inhouse':'Package';
  // status
  const statBtn=document.querySelector('#am-tg-status .am-tgb.am-on');
  const statMap={'Active':'Active','Phaseout':'Phase-out','Toretire':'To-retire','Planned':'Planned'};
  const statRaw=statBtn?statBtn.textContent.replace(/[^A-Za-z]/g,''):'Active';
  const statusVal=statMap[statRaw]||'Active';
  // bcg
  const bcgBtn=document.querySelector('#am-tg-bcg0 .am-tgb.am-on');
  const bcgMap={'Invest':'Invest','Grow':'Grow','Tolerate':'Tolerate','Retire':'Retire'};
  const bcgRaw=bcgBtn?bcgBtn.textContent.replace(/[^A-Za-z]/g,''):'Invest';
  const bcgVal=bcgMap[bcgRaw]||'Invest';
  // dr/pi/src
  const drVal=document.querySelector('#am-tg-dr .am-tgb.am-on')?.textContent.includes('Yes')??true;
  const piVal=document.querySelector('#am-tg-pi .am-tgb.am-on')?.textContent.includes('Yes')??true;
  const srcVal=document.querySelector('#am-tg-src .am-tgb.am-on')?.textContent.includes('Yes')??true;
  // wave
  const waveBtn=document.querySelector('.am-wb.am-on');
  const waveNum=waveBtn?parseInt(waveBtn.textContent.match(/\d+/)?.[0])||1:1;
  // stack chips
  const stackChips=[...document.querySelectorAll('#am-cw-stack .am-chip')].map(c=>c.childNodes[0].textContent.trim()).filter(Boolean);
  // EA
  const eaGroup=amSelGroup?amSelGroup.g:'3. Core Products';
  const eaCatFull=amSelCat?`${amSelCat.n} ${amSelCat.l}`:'3.2 Corporate & Core System';
  const eaSub=(document.getElementById('f-easub').value.trim())||'-';
  // new id
  const newId=`APP-${String(apps.length+1).padStart(3,'0')}`;
  apps.push({
    id:newId, name,
    vendor:document.getElementById('f-vendor').value.trim()||'Unknown',
    domain:document.getElementById('f-domain').value||'Operations',
    type:typeVal, status:statusVal, bcg:bcgVal,
    criticality:document.getElementById('f-criticality').value||'Medium',
    health:h, techDebt:Math.max(0,100-h),
    age:+document.getElementById('f-age').value||0,
    tco:+document.getElementById('f-tco').value||1000,
    users:+document.getElementById('f-users').value||100,
    persons:+document.getElementById('f-persons').value||2,
    integration:+document.getElementById('f-integration').value||5,
    dr:drVal, piSpi:piVal, srcAvail:srcVal,
    eol:document.getElementById('f-eol').value||'2030-12',
    contractEnd:document.getElementById('f-contractend').value||'2027-06',
    stack:stackChips,
    capability:document.getElementById('f-capability').value.trim()||'TBD',
    lang:document.getElementById('f-lang').value.trim()||'TBD',
    os:document.getElementById('f-os').value.trim()||'TBD',
    db:document.getElementById('f-db').value.trim()||'TBD',
    support:document.getElementById('f-support').value||'Inhouse',
    serviceHour:document.getElementById('f-servicehour').value||'24x7',
    maintWindow:document.getElementById('f-maintwindow').value.trim()||'Sat 22:00-02:00',
    strategic:+document.getElementById('f-strategic').value||70,
    assessStatus:document.getElementById('f-assessstatus').value||'Not Started',
    assessDate:document.getElementById('f-assessdate').value||'',
    wave:waveNum,
    approach:document.getElementById('f-approach').value||'Upgrade',
    stream:document.getElementById('f-stream').value.trim()||'Other',
    owner:document.getElementById('f-owner').value.trim()||'TBD',
    bizOwner:document.getElementById('f-bizowner').value.trim()||'TBD',
    eaGroup, eaCategory:eaCatFull, eaSubCategory:eaSub,
  });
  document.getElementById('modal').style.display='none';
  const activeView=document.querySelector('.view.active')?.id?.replace('view-','');
  if(activeView) renderView(activeView);
  // toast notification
  const toast=document.createElement('div');
  toast.style.cssText='position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:var(--accent);color:#000;padding:10px 20px;border-radius:10px;font-weight:700;font-size:13px;z-index:9999;box-shadow:0 4px 20px rgba(0,229,255,.3);animation:fadeIn .25s ease';
  toast.textContent=`✅ เพิ่ม "${name}" (${newId}) สำเร็จแล้ว`;
  document.body.appendChild(toast);
  setTimeout(()=>toast.remove(),3000);
};

// ─── CHART EXPAND MODAL ENGINE ────────────────────────────────────────────────

// Map: canvas DOM id → charts{} key
const CHART_KEY_MAP = {
  'chart-health-dist':      'hd',
  'chart-tco-domain':       'tcoD',
  'chart-debt-donut':       'dD',
  'chart-debt-top10':       'dT',
  'chart-vendor':           'vnd',
  'chart-tco-scatter':      'tcoSc',
  'chart-retire-save':      'retSv',
  'chart-exec-inv':         'exI',
  'chart-exec-scatter':     'exSc',
  'chart-keyperson':        'kp',
  'chart-service-hour':     'svcH',
  'chart-stack-dist':       'stk',
  'chart-platform-coverage':'plc',
  'chart-support-model':    'supM',
  'chart-dep-complexity':   'depCx',
  'chart-effort':           'eff',
  'chart-skills':           'skl',
  'chart-assess-status':    'assSt',
  'chart-assess-timeline':  'assT',
};

let _expandedChart = null;  // Chart.js instance inside modal

function expandChart(canvasId){
  const key     = CHART_KEY_MAP[canvasId];
  const srcChart= key ? charts[key] : null;
  if(!srcChart){ console.warn('expandChart: no chart found for', canvasId); return; }

  // Get title from nearest .card-title sibling
  const srcCanvas  = document.getElementById(canvasId);
  const cardEl     = srcCanvas?.closest('.card, .card-wrap');
  const titleEl    = cardEl?.querySelector('.card-title');
  const title      = titleEl ? titleEl.textContent.trim() : 'Chart';

  // Build modal HTML
  const overlay = document.createElement('div');
  overlay.className = 'chart-modal-overlay';
  overlay.id = 'chart-modal-overlay';
  overlay.innerHTML = `
    <div class="chart-modal-box" role="dialog" aria-modal="true">
      <div class="chart-modal-header">
        <div class="card-title">${title}</div>
        <button class="chart-modal-close" onclick="closeChartModal()" title="ปิด (Esc)">✕</button>
      </div>
      <div class="chart-modal-body">
        <div class="chart-modal-canvas-wrap">
          <canvas id="chart-modal-canvas"></canvas>
        </div>
        <div class="chart-modal-actions">
          <button class="chart-modal-action-btn" onclick="_exportModalChartPNG('${title}')">
            🖼 Export PNG
          </button>
          <button class="chart-modal-action-btn paper-out-btn" style="background:linear-gradient(135deg,#1a1a2e,#16213e);color:#e8e8e8;border-color:rgba(255,255,255,.12)" onclick="_exportModalChartPDF('${title}')">
            <span>🖨</span> <span>Paper Out</span>
          </button>
        </div>
      </div>
    </div>`;

  document.body.appendChild(overlay);

  // Animate in
  requestAnimationFrame(() => {
    requestAnimationFrame(() => overlay.classList.add('open'));
  });

  // Clone config from source chart — deep clone via JSON (handles most types)
  let cfg;
  try {
    cfg = JSON.parse(JSON.stringify({
      type:    srcChart.config.type,
      data:    srcChart.config.data,
      options: srcChart.config.options,
    }));
  } catch(e) {
    // Fallback: reference (may share objects but works for display)
    cfg = {
      type:    srcChart.config.type,
      data:    srcChart.config.data,
      options: srcChart.config.options,
    };
  }

  // Override options for modal: larger fonts, bigger points, responsive
  cfg.options = cfg.options || {};
  cfg.options.responsive          = true;
  cfg.options.maintainAspectRatio = false;
  cfg.options.animation           = { duration: 400 };

  // Scale up fonts
  const scaleFont = (obj) => {
    if(!obj || typeof obj !== 'object') return;
    if(obj.font && typeof obj.font === 'object') obj.font.size = (obj.font.size||12) * 1.25;
    Object.values(obj).forEach(v => { if(v && typeof v === 'object') scaleFont(v); });
  };
  if(cfg.options.plugins) scaleFont(cfg.options.plugins);
  if(cfg.options.scales)  scaleFont(cfg.options.scales);

  // Enlarge scatter/bubble point radius
  if(cfg.data?.datasets){
    cfg.data.datasets.forEach(ds => {
      if(ds.pointRadius) ds.pointRadius = Math.min((ds.pointRadius||3) * 1.4, 10);
      if(ds.r) ds.r = Math.min((ds.r||5) * 1.3, 20);
    });
  }

  // Render new chart in modal
  const modalCanvas = document.getElementById('chart-modal-canvas');
  _expandedChart = new Chart(modalCanvas, cfg);

  // Close on backdrop click
  overlay.addEventListener('click', e => { if(e.target === overlay) closeChartModal(); });

  // Store title on overlay for export use
  overlay._chartTitle = title;
}

function closeChartModal(){
  const overlay = document.getElementById('chart-modal-overlay');
  if(!overlay) return;
  overlay.classList.remove('open');
  setTimeout(() => {
    if(_expandedChart){ _expandedChart.destroy(); _expandedChart = null; }
    overlay.remove();
  }, 250);
}

// Export PNG from modal chart
function _exportModalChartPNG(title){
  if(!_expandedChart) return;
  const canvas = document.getElementById('chart-modal-canvas');
  const link   = document.createElement('a');
  link.download = `${title.replace(/[^a-zA-Z0-9ก-๙]/g,'_')}_${_today()}.png`;
  link.href    = canvas.toDataURL('image/png');
  link.click();
  if(typeof showToast !== 'undefined') showToast(`✅ Export PNG — ${link.download}`, 'success');
}

// Export PDF from modal chart
function _exportModalChartPDF(title){
  function loadScript(src){ return new Promise((res,rej)=>{ if(document.querySelector(`script[src="${src}"]`)){ res(); return; } const s=document.createElement('script'); s.src=src; s.onload=res; s.onerror=rej; document.head.appendChild(s); }); }
  loadScript('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js').then(()=>{
    const { jsPDF } = window.jspdf;
    const canvas    = document.getElementById('chart-modal-canvas');
    const imgData   = canvas.toDataURL('image/jpeg', 0.95);
    const pdf       = new jsPDF({ orientation: 'landscape', unit:'mm', format:'a4' });
    const pdfW      = pdf.internal.pageSize.getWidth();
    const pdfH      = pdf.internal.pageSize.getHeight();
    const margin    = 12;
    const headerH   = 14;
    // Header
    pdf.setFillColor(15,52,96);
    pdf.rect(0,0,pdfW,headerH,'F');
    pdf.setTextColor(255,255,255); pdf.setFontSize(9); pdf.setFont('helvetica','bold');
    pdf.text('MPX Studio', margin, 6);
    pdf.setFontSize(8); pdf.setFont('helvetica','normal'); pdf.setTextColor(0,229,255);
    pdf.text(title, pdfW/2, 9, {align:'center'});
    pdf.setFontSize(7); pdf.setTextColor(180,200,240);
    const now=new Date(); pdf.text(`${now.getDate()}/${now.getMonth()+1}/${now.getFullYear()}`, pdfW-margin, 9, {align:'right'});
    // Image
    const usableW = pdfW - margin*2;
    const usableH = pdfH - headerH - margin - 10;
    const cW = canvas.width, cH = canvas.height;
    const ratio = Math.min(usableW/cW, usableH/cH);
    const dW = cW*ratio, dH = cH*ratio;
    const x = margin + (usableW - dW)/2;
    pdf.addImage(imgData,'JPEG', x, headerH+4, dW, dH);
    // Footer
    pdf.setFillColor(245,247,250); pdf.rect(0,pdfH-8,pdfW,8,'F');
    pdf.setDrawColor(220,225,235); pdf.line(0,pdfH-8,pdfW,pdfH-8);
    pdf.setFontSize(6.5); pdf.setTextColor(120,130,150); pdf.setFont('helvetica','normal');
    pdf.text('MPX Studio EA Portfolio — CONFIDENTIAL',margin,pdfH-3);
    const fname = `${title.replace(/[^a-zA-Z0-9ก-๙]/g,'_')}_${_today()}.pdf`;
    pdf.save(fname);
    if(typeof showToast !== 'undefined') showToast(`✅ Paper Out PDF — ${fname}`, 'success');
  });
}

// Keyboard: Esc to close
document.addEventListener('keydown', e => {
  if(e.key === 'Escape' && document.getElementById('chart-modal-overlay')) closeChartModal();
});

// ── Auto-wire: wrap every chart-wrap with expand button ───────────────────────
function _wireExpandButtons(){
  document.querySelectorAll('.chart-wrap canvas[id]').forEach(canvas => {
    const wrap = canvas.closest('.chart-wrap');
    if(!wrap || wrap.dataset.expandWired) return;
    const canvasId = canvas.id;
    if(!CHART_KEY_MAP[canvasId]) return;  // skip unknown charts

    // Get title from nearest card-title
    const card    = wrap.closest('.card');
    const titleEl = card?.querySelector('.card-title');
    const title   = titleEl?.textContent?.trim() || canvasId;

    // Mark as wired
    wrap.dataset.expandWired = '1';
    wrap.classList.add('chart-expand-wrap');

    // Inject button
    const btn = document.createElement('button');
    btn.className = 'chart-expand-btn';
    btn.title     = `ขยาย: ${title}`;
    btn.innerHTML = '⛶';
    btn.onclick   = (e) => { e.stopPropagation(); expandChart(canvasId); };
    wrap.appendChild(btn);
  });
}
// Wire on initial load (Dashboard charts render immediately)
setTimeout(_wireExpandButtons, 300);

// ─── APP QUICK VIEW ────────────────────────────────────────────────────────────
function openAppQuickView(id){
  const a = apps.find(x => x.id === id);
  if(!a) return;

  // BCG accent color
  const accentCol = bcgColor[a.bcg] || 'var(--accent)';

  // Header
  document.getElementById('aqv-accent').style.background = accentCol;
  document.getElementById('aqv-name').textContent = a.name;
  document.getElementById('aqv-sub').innerHTML =
    `<span>${a.id}</span>
     <span style="color:var(--border2)">·</span>
     <span>${a.vendor}</span>
     <span style="color:var(--border2)">·</span>
     <span>${a.type}</span>
     <span style="color:var(--border2)">·</span>
     <span>${a.domain}</span>`;

  // App Insight button — switch view and close modal
  document.getElementById('aqv-insight-btn').onclick = () => {
    closeAppQuickView();
    // Set the target app before navigating
    insightSelectedId = id;
    // Click sidebar item to trigger proper view switch
    const btn = document.querySelector('[data-view="app-insight"]');
    if(btn) btn.click();
  };

  // ── Helpers ───────────────────────────────────────────────
  const R = bcgColor; // already imported
  const sc = {Active:'var(--green)',"Phase-out":'var(--yellow)',"To-retire":'var(--red)',Planned:'var(--accent)',Decommissioned:'var(--muted)'};
  const cc = {'Mission Critical':'var(--accent2)',High:'var(--blue)',Medium:'var(--dim)',Low:'var(--muted)'};
  const hcol = v => v>=80?'var(--green)':v>=60?'var(--yellow)':'var(--red)';

  const row = (k,v,danger=false) => `
    <div class="aqv-row">
      <span class="aqv-row-key">${k}</span>
      <span class="aqv-row-val" style="${danger?'color:var(--red)':''}">${v??'—'}</span>
    </div>`;

  const scorebar = (k, v, col) => `
    <div class="aqv-score-row">
      <div class="aqv-score-label">
        <span class="aqv-score-key">${k}</span>
        <span class="aqv-score-num" style="color:${col}">${v}</span>
      </div>
      <div style="height:6px;border-radius:4px;background:var(--border);overflow:hidden">
        <div style="height:100%;width:${v}%;background:${col};border-radius:4px;transition:width .4s"></div>
      </div>
    </div>`;

  const pill = (txt, col) =>
    `<span class="badge" style="background:${col}22;color:${col};border:1px solid ${col}44;font-size:11px">${txt}</span>`;

  // ── Zone A — Identity & Status ─────────────────────────────
  const zoneA = `
    <div class="aqv-zone">
      <div class="aqv-zone-title">🪪 Identity & Status</div>
      ${row('Status',    pill(a.status, sc[a.status]||'var(--muted)'))}
      ${row('Criticality', pill(a.criticality, cc[a.criticality]||'var(--dim)'))}
      ${row('BCG',       pill(a.bcg, accentCol))}
      ${row('Domain',    a.domain)}
      ${row('Type',      a.type)}
      ${row('System Age', `${a.age} ปี`, a.age>10)}
      ${row('EoL Date',  a.eol||'—', a.eol&&a.eol<='2026-12')}
      ${row('Contract End', a.contractEnd||'—', a.contractEnd&&a.contractEnd<='2026-12')}
      ${row('DR',        a.dr ? '✅ มี DR' : '❌ ไม่มี DR', !a.dr)}
      ${row('PI/SPI',    a.piSpi ? '⚠️ มีข้อมูลสำคัญ' : '—')}
    </div>`;

  // ── Zone B — Performance & Business ───────────────────────
  const zoneB = `
    <div class="aqv-zone">
      <div class="aqv-zone-title">📊 Performance & Business</div>
      ${scorebar('Health Score',    a.health,                  hcol(a.health))}
      ${scorebar('Tech Debt',       a.techDebt||100-a.health,  hcol(100-(a.techDebt||100-a.health)))}
      ${scorebar('Strategic Value', a.strategic||0,            'var(--accent)')}
      ${row('Annual TCO',    `฿${(a.tco||0).toLocaleString()}K`)}
      ${row('Active Users',  (a.users||0).toLocaleString())}
      ${row('Integrations',  a.integration||0, (a.integration||0)>25)}
      ${row('No. of Persons', a.persons||'—', (a.persons||0)<=1)}
      ${row('Wave',          a.wave ? `Wave ${a.wave}` : '—')}
      ${row('Stream',        a.stream||'—')}
      ${row('Approach',      a.approach||'—')}
      ${row('Assess Status', a.assessStatus||'—')}
      ${row('Assess Date',   a.assessDate||'—')}
    </div>`;

  // ── Zone C — Technical & Ops ───────────────────────────────
  const zoneC = `
    <div class="aqv-zone">
      <div class="aqv-zone-title">⚙️ Technical & Ops</div>
      ${row('Language',     a.lang||'—')}
      ${row('OS',           a.os||'—')}
      ${row('Database',     a.db||'—')}
      ${row('Service Hour', a.serviceHour||'—')}
      ${row('Maint Window', a.maintWindow||'—')}
      ${row('Source Code',  a.srcAvail ? '✅ มี' : '❌ ไม่มี', !a.srcAvail&&a.type==='Inhouse')}
      ${row('Support Type', a.support||'—')}
      <div style="margin-top:10px;padding-top:8px;border-top:1px solid var(--border)">
        <div style="font-size:10px;color:var(--dim);margin-bottom:6px;font-family:var(--mono)">TECH STACK</div>
        <div class="aqv-stack">
          ${(a.stack||[]).map(s=>`<span class="aqv-chip">${s}</span>`).join('')||'<span style="font-size:11px;color:var(--muted)">—</span>'}
        </div>
      </div>
    </div>`;

  // ── Zone D — EA Landscape ──────────────────────────────────
  const eaGroup  = a.eaGroup||'';
  const eaCat    = a.eaCategory||'';
  const eaSub    = (a.eaSubCategory && a.eaSubCategory!=='-') ? a.eaSubCategory : '';
  const eaColors = {'1. Direction':'#9b59b6','2. Services':'#00bcd4','3. Core Products':'#00d68f','4. Support':'#ff9800','5. Governance':'#ff4757'};
  const eaCol    = eaColors[eaGroup] || 'var(--accent2)';
  const eaHtml   = eaGroup
    ? `<div class="aqv-ea-path">
        <span class="aqv-ea-seg" style="color:${eaCol}">${eaGroup}</span>
        ${eaCat ? `<span class="aqv-ea-sep">›</span><span class="aqv-ea-seg" style="color:${eaCol};font-weight:600">${eaCat}</span>` : ''}
        ${eaSub ? `<span class="aqv-ea-sep">›</span><span class="aqv-ea-sub">${eaSub}</span>` : ''}
      </div>`
    : `<div style="font-size:12px;color:var(--muted);font-style:italic">ยังไม่ได้กำหนดตำแหน่งใน EA Landscape</div>`;

  const zoneD = `
    <div class="aqv-zone">
      <div class="aqv-zone-title">🏛 EA Landscape</div>
      ${eaHtml}
    </div>`;

  // ── Zone E — Ownership ─────────────────────────────────────
  const ownerCard = (icon, bg, role, name) => `
    <div class="aqv-owner-card">
      <div class="aqv-owner-avatar" style="background:${bg}">${icon}</div>
      <div class="aqv-owner-info">
        <div class="aqv-owner-role">${role}</div>
        <div class="aqv-owner-name">${name||'—'}</div>
      </div>
    </div>`;

  const zoneE = `
    <div class="aqv-zone">
      <div class="aqv-zone-title">👤 Ownership</div>
      <div class="aqv-owners">
        ${ownerCard('💼','rgba(0,214,143,.12)','Business App Owner', a.bizOwner||'—')}
        ${ownerCard('🖥️','rgba(0,229,255,.12)','IT App Owner', a.owner||'—')}
      </div>
    </div>`;

  // ── Assemble body ──────────────────────────────────────────
  document.getElementById('aqv-body').innerHTML = `
    <div class="aqv-grid3">${zoneA}${zoneB}${zoneC}</div>
    ${zoneD}
    ${zoneE}`;

  // Open overlay
  const overlay = document.getElementById('aqv-overlay');
  overlay.style.display = 'flex';
  requestAnimationFrame(() => requestAnimationFrame(() => overlay.classList.add('open')));
}

function closeAppQuickView(){
  const overlay = document.getElementById('aqv-overlay');
  overlay.classList.remove('open');
  setTimeout(() => { overlay.style.display = 'none'; }, 240);
}

// Backdrop click & Esc
document.getElementById('aqv-overlay').addEventListener('click', e => {
  if(e.target === document.getElementById('aqv-overlay')) closeAppQuickView();
});
document.addEventListener('keydown', e => {
  if(e.key === 'Escape' && document.getElementById('aqv-overlay').classList.contains('open'))
    closeAppQuickView();
});


// ═══════════════════════════════════════════════════════════════════════════
// ASSET MANAGEMENT MODULE
// ═══════════════════════════════════════════════════════════════════════════

// ─── ASSET SAMPLE DATA ────────────────────────────────────────────────────
const ASSET_DATA = [
  // HARDWARE
  {id:'HW-001',name:'DB Server Primary (ESXi-01)',assetType:'hardware',category:'Server',brand:'Dell',model:'PowerEdge R750',serialNumber:'SN-DEL-0012',location:{site:'HQ',room:'DC-1',rack:'Rack-A1'},criticality:'Mission Critical',health:92,status:'active',purchasedYear:'2022',purchaseCost:1.8,tco:0.36,warrantyExpiry:'2027',supportContract:'vendor',firmwareVersion:'iDRAC 6.10.30',lastPatchDate:'2025-01-10',owner:'IT Infra',managedBy:'inhouse',description:'Primary database server running Oracle DB'},
  {id:'HW-002',name:'App Server Cluster (vSphere-01)',assetType:'hardware',category:'Server',brand:'HPE',model:'ProLiant DL380 Gen10',serialNumber:'SN-HPE-4421',location:{site:'HQ',room:'DC-1',rack:'Rack-A2'},criticality:'Business Critical',health:85,status:'active',purchasedYear:'2021',purchaseCost:1.4,tco:0.28,warrantyExpiry:'2026',supportContract:'vendor',firmwareVersion:'SPP 2024.03',lastPatchDate:'2024-12-05',owner:'IT Infra',managedBy:'inhouse',description:'Application server cluster for SAP & ERP'},
  {id:'HW-003',name:'Legacy AS/400 Server',assetType:'hardware',category:'Server',brand:'IBM',model:'Power System S922',serialNumber:'SN-IBM-AS400',location:{site:'HQ',room:'DC-1',rack:'Rack-C1'},criticality:'Business Critical',health:38,status:'review',purchasedYear:'2008',purchaseCost:3.5,tco:0.7,warrantyExpiry:'2025',supportContract:'3rd',firmwareVersion:'OS/400 V7R3',lastPatchDate:'2023-06-01',owner:'IT Infra',managedBy:'3rd',description:'Legacy AS/400 running HR system — EOL'},
  {id:'HW-004',name:'SAN Storage Primary (NetApp AFF A400)',assetType:'hardware',category:'Storage',brand:'NetApp',model:'AFF A400',serialNumber:'SN-NTA-SAN01',location:{site:'HQ',room:'DC-1',rack:'Rack-A5'},criticality:'Mission Critical',health:91,status:'active',purchasedYear:'2022',purchaseCost:6.5,tco:1.3,warrantyExpiry:'2027',supportContract:'vendor',firmwareVersion:'ONTAP 9.13.1',lastPatchDate:'2025-01-05',owner:'IT Infra',managedBy:'inhouse',description:'Primary SAN storage — all-flash NVMe'},
  {id:'HW-005',name:'UPS Primary DC-1 (60kVA)',assetType:'hardware',category:'UPS',brand:'APC',model:'Symmetra PX 60kW',serialNumber:'SN-APC-UPS01',location:{site:'HQ',room:'DC-1',rack:'Power Room'},criticality:'Mission Critical',health:82,status:'active',purchasedYear:'2019',purchaseCost:1.1,tco:0.22,warrantyExpiry:'2026',supportContract:'vendor',firmwareVersion:'UPS FW 6.8',lastPatchDate:'2024-07-01',owner:'Facilities',managedBy:'inhouse',description:'Primary UPS for DC-1'},
  // SECURITY
  {id:'SEC-001',name:'Firewall HQ Edge (FortiGate 1800F)',assetType:'security',category:'Firewall',brand:'Fortinet',model:'FortiGate 1800F',serialNumber:'SN-FTG-FW01',location:{site:'HQ',room:'DC-1',rack:'Rack-FW1'},ipAddress:'10.0.0.1',criticality:'Mission Critical',health:94,status:'active',purchasedYear:'2022',purchaseCost:2.4,tco:0.48,warrantyExpiry:'2027',supportContract:'vendor',firmwareVersion:'FortiOS 7.4.3',lastPatchDate:'2025-02-01',licenseCount:1,licenseExpiry:'2027',owner:'SecOps',managedBy:'inhouse',description:'Primary edge firewall — HQ internet gateway',throughput:'40 Gbps',ports:'8x GE, 4x 10GbE'},
  {id:'SEC-002',name:'NGFW DMZ (Palo Alto PA-5260)',assetType:'security',category:'Firewall',brand:'Palo Alto',model:'PA-5260',serialNumber:'SN-PAN-FW05',location:{site:'HQ',room:'DMZ',rack:'Rack-D2'},ipAddress:'203.0.113.1',criticality:'Mission Critical',health:96,status:'active',purchasedYear:'2023',purchaseCost:3.8,tco:0.76,warrantyExpiry:'2028',supportContract:'vendor',firmwareVersion:'PAN-OS 11.1.3',lastPatchDate:'2025-02-05',licenseCount:1,licenseExpiry:'2028',owner:'SecOps',managedBy:'inhouse',description:'NGFW protecting DMZ public-facing services',throughput:'70 Gbps'},
  {id:'SEC-003',name:'WAF Cloud (Cloudflare Enterprise)',assetType:'security',category:'WAF',brand:'Cloudflare',model:'Enterprise WAF',serialNumber:'CF-ENT-WAF01',location:{site:'Cloud',room:'—',rack:'—'},ipAddress:'',criticality:'Mission Critical',health:99,status:'active',purchasedYear:'2023',purchaseCost:0,tco:0.96,warrantyExpiry:'—',supportContract:'vendor',firmwareVersion:'Managed',lastPatchDate:'Auto',licenseCount:1,licenseExpiry:'2026',owner:'SecOps',managedBy:'vendor',description:'Cloud WAF protecting public web applications'},
  {id:'SEC-004',name:'SIEM Platform (Splunk Enterprise)',assetType:'security',category:'SIEM',brand:'Splunk',model:'Enterprise 9.x',serialNumber:'LIC-SPL-SIEM01',location:{site:'HQ',room:'DC-1',rack:'Virtual'},ipAddress:'10.0.2.50',criticality:'Business Critical',health:88,status:'active',purchasedYear:'2021',purchaseCost:0.5,tco:2.4,warrantyExpiry:'—',supportContract:'vendor',firmwareVersion:'Splunk 9.2.1',lastPatchDate:'2025-01-10',licenseCount:1,licenseExpiry:'2026',owner:'SecOps',managedBy:'inhouse',description:'SIEM for security monitoring and log analytics'},
  {id:'SEC-005',name:'DLP (Forcepoint ONE)',assetType:'security',category:'DLP',brand:'Forcepoint',model:'ONE DLP',serialNumber:'LIC-FCP-DLP01',location:{site:'HQ',room:'DC-1',rack:'Virtual'},ipAddress:'10.0.2.55',criticality:'Business Critical',health:78,status:'review',purchasedYear:'2020',purchaseCost:0.3,tco:0.9,warrantyExpiry:'—',supportContract:'vendor',firmwareVersion:'10.2.1',lastPatchDate:'2024-09-01',licenseCount:1000,licenseExpiry:'2025',owner:'SecOps',managedBy:'inhouse',description:'Data Loss Prevention for email and endpoint'},
  // NETWORK
  {id:'NET-001',name:'Core Switch HQ (Cisco Catalyst 9500)',assetType:'network',category:'Switch (Core)',brand:'Cisco',model:'Catalyst 9500-40X',serialNumber:'SN-CSC-SW01',location:{site:'HQ',room:'DC-1',rack:'Rack-SW1'},ipAddress:'10.0.0.254',criticality:'Mission Critical',health:95,status:'active',purchasedYear:'2021',purchaseCost:1.1,tco:0.22,warrantyExpiry:'2028',supportContract:'vendor',firmwareVersion:'IOS-XE 17.12.1',lastPatchDate:'2025-01-20',owner:'IT Infra',managedBy:'inhouse',description:'Core distribution switch — HQ datacenter'},
  {id:'NET-002',name:'WAN Router HQ (Cisco ISR 4451)',assetType:'network',category:'Router',brand:'Cisco',model:'ISR 4451-X',serialNumber:'SN-CSC-RTR01',location:{site:'HQ',room:'DC-1',rack:'Rack-RTR1'},ipAddress:'10.0.0.2',criticality:'Mission Critical',health:88,status:'active',purchasedYear:'2020',purchaseCost:0.65,tco:0.13,warrantyExpiry:'2026',supportContract:'vendor',firmwareVersion:'IOS-XE 16.12.8',lastPatchDate:'2024-11-01',owner:'IT Infra',managedBy:'inhouse',description:'HQ WAN router — MPLS and internet uplink'},
  {id:'NET-003',name:'SD-WAN Hub (Cisco Viptela)',assetType:'network',category:'SD-WAN',brand:'Cisco',model:'vEdge 5000',serialNumber:'SN-CSC-SDWAN01',location:{site:'HQ',room:'DC-1',rack:'Rack-RTR2'},ipAddress:'10.0.0.3',criticality:'Business Critical',health:90,status:'active',purchasedYear:'2022',purchaseCost:1.8,tco:0.54,warrantyExpiry:'2027',supportContract:'vendor',firmwareVersion:'SD-WAN 20.12',lastPatchDate:'2025-01-10',licenseCount:50,licenseExpiry:'2027',owner:'IT Infra',managedBy:'vendor',description:'SD-WAN hub connecting 20 branches'},
  {id:'NET-004',name:'Core Switch Legacy (Cisco 3650)',assetType:'network',category:'Switch (Core)',brand:'Cisco',model:'Catalyst 3650',serialNumber:'SN-CSC-SW03',location:{site:'HQ',room:'Server Room B',rack:'Rack-E2'},ipAddress:'10.2.0.254',criticality:'Important',health:45,status:'review',purchasedYear:'2014',purchaseCost:0.38,tco:0.076,warrantyExpiry:'2024',supportContract:'none',firmwareVersion:'IOS 16.3.8',lastPatchDate:'2022-01-01',owner:'IT Infra',managedBy:'inhouse',description:'Legacy core switch — EOL, no vendor support'},
  {id:'NET-005',name:'Load Balancer (F5 BIG-IP 2000s)',assetType:'network',category:'Load Balancer',brand:'F5',model:'BIG-IP 2000s',serialNumber:'SN-F5-LB01',location:{site:'HQ',room:'DC-1',rack:'Rack-LB1'},ipAddress:'10.0.4.1',criticality:'Mission Critical',health:91,status:'active',purchasedYear:'2021',purchaseCost:1.9,tco:0.38,warrantyExpiry:'2026',supportContract:'vendor',firmwareVersion:'BIG-IP 17.1.1',lastPatchDate:'2024-12-15',licenseCount:1,licenseExpiry:'2026',owner:'IT Infra',managedBy:'inhouse',description:'Application delivery controller — ADC/LB'},
  // ENDPOINT
  {id:'EP-001',name:'Endpoint Protection (CrowdStrike Falcon)',assetType:'endpoint',category:'Antivirus/EPP',brand:'CrowdStrike',model:'Falcon Prevent',serialNumber:'LIC-CWS-EP01',location:{site:'Cloud',room:'—',rack:'—'},criticality:'Mission Critical',health:98,status:'active',purchasedYear:'2023',purchaseCost:0,tco:1.8,warrantyExpiry:'—',supportContract:'vendor',firmwareVersion:'Sensor 7.10',lastPatchDate:'Auto',licenseCount:2500,licenseExpiry:'2026',deployedCount:2480,owner:'SecOps',managedBy:'vendor',description:'Next-gen EPP/EDR — 2500 endpoints licensed'},
  {id:'EP-002',name:'EDR Platform (CrowdStrike Falcon XDR)',assetType:'endpoint',category:'EDR',brand:'CrowdStrike',model:'Falcon Insight XDR',serialNumber:'LIC-CWS-EDR01',location:{site:'Cloud',room:'—',rack:'—'},criticality:'Mission Critical',health:98,status:'active',purchasedYear:'2023',purchaseCost:0,tco:2.2,warrantyExpiry:'—',supportContract:'vendor',firmwareVersion:'Sensor 7.10',lastPatchDate:'Auto',licenseCount:2500,licenseExpiry:'2026',deployedCount:2480,owner:'SecOps',managedBy:'vendor',description:'EDR/XDR — threat detection and response'},
  {id:'EP-003',name:'Antivirus Legacy (Symantec SEP)',assetType:'endpoint',category:'Antivirus/EPP',brand:'Symantec',model:'Endpoint Protection 14',serialNumber:'LIC-SYM-AV01',location:{site:'HQ',room:'DC-1',rack:'Virtual'},criticality:'Business Critical',health:52,status:'review',purchasedYear:'2018',purchaseCost:0.2,tco:0.6,warrantyExpiry:'—',supportContract:'vendor',firmwareVersion:'SEP 14.3 RU7',lastPatchDate:'2024-08-01',licenseCount:500,licenseExpiry:'2025',deployedCount:488,owner:'SecOps',managedBy:'inhouse',description:'Legacy AV — being replaced by CrowdStrike'},
  {id:'EP-004',name:'MDM (Microsoft Intune M365)',assetType:'endpoint',category:'MDM',brand:'Microsoft',model:'Intune M365',serialNumber:'LIC-MS-MDM01',location:{site:'Cloud',room:'—',rack:'—'},criticality:'Business Critical',health:95,status:'active',purchasedYear:'2022',purchaseCost:0,tco:0.84,warrantyExpiry:'—',supportContract:'vendor',firmwareVersion:'Intune 2502',lastPatchDate:'Auto',licenseCount:2500,licenseExpiry:'2026',deployedCount:2310,owner:'IT Infra',managedBy:'vendor',description:'MDM managing Windows, iOS, Android devices'},
  {id:'EP-005',name:'Patch Management (SCCM/Intune)',assetType:'endpoint',category:'Patch Management',brand:'Microsoft',model:'SCCM/Intune',serialNumber:'LIC-MS-SCCM01',location:{site:'HQ',room:'DC-1',rack:'Virtual'},criticality:'Business Critical',health:82,status:'active',purchasedYear:'2019',purchaseCost:0,tco:0.3,warrantyExpiry:'—',supportContract:'vendor',firmwareVersion:'SCCM 2403',lastPatchDate:'2025-02-01',licenseCount:2500,licenseExpiry:'2026',deployedCount:2450,owner:'IT Infra',managedBy:'inhouse',description:'Centralized patch management — Windows endpoints'}
];

let assetData = [...ASSET_DATA];
let assetFilter = 'all';
let assetSearch = '';
let editAssetId = null;
let pendingDelId = null, pendingDelType = null;

const ASSET_CATS = {
  hardware:['Server','Storage','UPS','Rack/PDU','Workstation','Printer'],
  security:['Firewall','IPS/IDS','WAF','SIEM','PAM','NAC','DLP','Sandbox'],
  network:['Switch (Core)','Switch (Access)','Router','Wireless AP','Load Balancer','SD-WAN','VPN Gateway'],
  endpoint:['Antivirus/EPP','EDR','DLP (Endpoint)','MDM','Patch Management']
};

const AT_LABEL = {hardware:'🖥 HW',security:'🛡 Sec',network:'🌐 Net',endpoint:'💻 EP'};

function aHc(h){return h>=80?'#2ecc8a':h>=60?'#f0c040':'#e05a5a';}
function aExpColor(yr){const d=aYearLeft(yr);return d<=0?'#e05a5a':d===1?'#f08040':d<=2?'#f0c040':'#2ecc8a';}
function aYearLeft(yr){if(!yr||yr==='—')return 99;const y=parseInt(yr);return isNaN(y)?99:y-new Date().getFullYear();}
function aExpBadge(yr){
  const d=aYearLeft(yr);
  if(!yr||yr==='—')return`<span style="padding:2px 8px;border-radius:4px;background:var(--card2);color:var(--dim);font-size:10px;font-family:var(--mono)">—</span>`;
  const c=aExpColor(yr);
  return`<span style="padding:2px 8px;border-radius:4px;background:${c}22;color:${c};font-size:10px;font-family:var(--mono)">${yr}${d<=0?' ⚠':d<=1?' !':''}</span>`;
}
function aStatCard(accent,label,val,sub){
  const colors={bl:'#3d8ef0',og:'#f08040',rd:'#e05a5a',gn:'#2ecc8a',tl:'#2eccc8',gd:'#f0c040',pp:'#9b6ef0'};
  const c=colors[accent]||'#3d8ef0';
  return`<div style="background:var(--card);border:1px solid var(--border2);border-radius:10px;padding:14px;border-left:3px solid ${c}">
    <div style="font-size:10px;color:var(--dim);margin-bottom:4px">${label}</div>
    <div style="font-size:22px;font-weight:800;color:${c};font-family:var(--mono)">${val}</div>
    <div style="font-size:10px;color:var(--dim);margin-top:2px">${sub}</div>
  </div>`;
}
function aInsCard(cls,title,body){return`<div class="asset-ic ${cls}"><div class="asset-it2">${title}</div><div class="asset-ib2">${body}</div></div>`;}

function aGid(type){
  const pfx={hardware:'HW',security:'SEC',network:'NET',endpoint:'EP'}[type]||'AS';
  const n=assetData.filter(a=>a.assetType===type).map(a=>parseInt((a.id||'').replace(pfx+'-',''))||0);
  return`${pfx}-${String(Math.max(0,...n)+1).padStart(3,'0')}`;
}

function sfAsset(v,el){
  assetFilter=v;
  document.querySelectorAll('#view-asset-inventory .asset-ft').forEach(t=>t.classList.remove('active'));
  el.classList.add('active');
  renderAssetInventory();
}
function setAssetSearch(v){assetSearch=v;renderAssetInventory();}

// ─── RENDER: ASSET INVENTORY ──────────────────────────────────────────────
function renderAssetInventory(){
  const AS=assetData;
  const q=assetSearch.toLowerCase();
  const filtered=AS.filter(a=>(assetFilter==='all'||a.assetType===assetFilter)&&(!q||(a.name+(a.brand||'')+(a.model||'')+(a.category||'')).toLowerCase().includes(q)));
  const el=document.getElementById('asset-stats');
  if(el) el.innerHTML=[
    aStatCard('bl','Total Assets',AS.length,'ทั้งหมด'),
    aStatCard('og','Hardware',AS.filter(x=>x.assetType==='hardware').length,'Servers, Storage, UPS'),
    aStatCard('rd','Security',AS.filter(x=>x.assetType==='security').length,'FW, WAF, SIEM, DLP'),
    aStatCard('tl','Network + Endpoint',AS.filter(x=>['network','endpoint'].includes(x.assetType)).length,'SW, Router, AV, EDR'),
  ].join('');
  const tbody=document.getElementById('asset-tbody');
  if(!tbody)return;
  const badgeCls={hardware:'background:#f08040',security:'background:#e05a5a',network:'background:#2eccc8',endpoint:'background:#9b6ef0'};
  tbody.innerHTML=filtered.map(a=>`<tr style="border-bottom:1px solid var(--border2)">
    <td style="padding:9px 12px;font-family:var(--mono);font-size:10px;color:var(--dim)">${a.id}</td>
    <td style="padding:9px 12px"><div style="font-size:12px;font-weight:600;color:var(--text)">${a.name}</div><div style="font-size:10px;color:var(--dim)">${a.description||''}</div></td>
    <td style="padding:9px 12px"><span style="padding:2px 8px;border-radius:4px;${badgeCls[a.assetType]||'background:var(--card2)'};color:#fff;font-size:10px;font-weight:600">${AT_LABEL[a.assetType]||a.assetType}</span></td>
    <td style="padding:9px 12px;font-size:11px;color:var(--dim)">${a.category||'—'}</td>
    <td style="padding:9px 12px;font-size:11px;color:var(--text)">${a.brand||''} ${a.model||''}</td>
    <td style="padding:9px 12px;font-size:10px;color:var(--dim);font-family:var(--mono)">${a.location?`${a.location.site||''}${a.location.room?' / '+a.location.room:''}`:'—'}</td>
    <td style="padding:9px 12px"><span style="color:${aHc(a.health||0)};font-family:var(--mono);font-size:12px;font-weight:700">${a.health||0}</span></td>
    <td style="padding:9px 12px">${aExpBadge(a.warrantyExpiry)}</td>
    <td style="padding:9px 12px">${aExpBadge(a.licenseExpiry)}</td>
    <td style="padding:9px 12px"><div style="display:flex;gap:4px">
      <button onclick="openEditAsset('${a.id.replace(/'/g,"\'")}');event.stopPropagation()" style="padding:3px 8px;background:var(--card2);border:1px solid var(--border2);border-radius:5px;color:var(--text);cursor:pointer;font-size:11px">✏</button>
      <button onclick="openAssetConf('${a.id.replace(/'/g,"\'")}','${a.name.replace(/'/g,"\'")}');event.stopPropagation()" style="padding:3px 8px;background:rgba(224,90,90,.1);border:1px solid rgba(224,90,90,.3);border-radius:5px;color:#e05a5a;cursor:pointer;font-size:11px">🗑</button>
    </div></td>
  </tr>`).join('');
}

// ─── RENDER: HARDWARE ────────────────────────────────────────────────────
function renderAssetHardware(){
  const HW=assetData.filter(a=>a.assetType==='hardware');
  const cats={};HW.forEach(h=>{cats[h.category]=(cats[h.category]||0)+1;});
  const totalCost=HW.reduce((s,h)=>s+(parseFloat(h.purchaseCost)||0),0).toFixed(1);
  const expW=HW.filter(h=>aYearLeft(h.warrantyExpiry)<=1).length;
  const el=document.getElementById('hw-stats');
  if(el) el.innerHTML=[
    aStatCard('og','Hardware Items',HW.length,'Total'),
    aStatCard('rd','Warranty Expiring',expW,'≤ 1 year'),
    aStatCard('bl','Total Asset Cost',`฿${totalCost}M`,'Purchase cost'),
    aStatCard('gn','Avg Health',HW.length?Math.round(HW.reduce((s,h)=>s+(h.health||0),0)/HW.length):0,'Score'),
  ].join('');
  const PAL=['#3d8ef0','#f08040','#2ecc8a','#f0c040','#9b6ef0','#2eccc8','#e05a5a'];
  if(window._aCharts){if(window._aCharts.hwCat)window._aCharts.hwCat.destroy();}else{window._aCharts={};}
  const hwCatCtx=document.getElementById('hwCat');
  if(hwCatCtx) window._aCharts.hwCat=new Chart(hwCatCtx,{type:'doughnut',data:{labels:Object.keys(cats),datasets:[{data:Object.values(cats),backgroundColor:Object.keys(cats).map((_,i)=>PAL[i%PAL.length]+'99'),borderColor:Object.keys(cats).map((_,i)=>PAL[i%PAL.length]),borderWidth:1}]},options:{responsive:true,plugins:{legend:{position:'right',labels:{font:{size:10},padding:7,color:'var(--dim)'}}},cutout:'55%'}});
  const sorted=[...HW].sort((a,b)=>aYearLeft(a.warrantyExpiry)-aYearLeft(b.warrantyExpiry));
  const wEl=document.getElementById('hwWarranty');
  if(wEl) wEl.innerHTML=sorted.slice(0,8).map(h=>{const d=aYearLeft(h.warrantyExpiry),pct=Math.max(3,Math.min(100,(3-d)*34));return`<div class="wt-item"><div style="flex:1;min-width:0"><div style="font-size:11px;font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${h.name}</div><div style="font-size:9px;font-family:var(--mono);color:var(--dim)">${h.category} · ${h.brand} ${h.model}</div></div><div class="wt-bar"><div class="wt-fill" style="width:${pct}%;background:${aExpColor(h.warrantyExpiry)}"></div></div>${aExpBadge(h.warrantyExpiry)}</div>`;}).join('');
  const tbody=document.getElementById('hw-tbody');
  if(tbody) tbody.innerHTML=HW.map(h=>`<tr style="border-bottom:1px solid var(--border2)">
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:var(--dim)">${h.id}</td>
    <td style="padding:8px 12px;font-size:12px;font-weight:600;color:var(--text)">${h.name}</td>
    <td style="padding:8px 12px"><span style="padding:2px 8px;border-radius:4px;background:#f0804022;color:#f08040;font-size:10px">${h.category}</span></td>
    <td style="padding:8px 12px;font-size:11px;color:var(--text)">${h.brand} ${h.model}</td>
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:var(--dim)">${h.serialNumber||'—'}</td>
    <td style="padding:8px 12px;font-size:10px;color:var(--dim)">${h.location?`${h.location.site} / ${h.location.room||'—'}`:'—'}</td>
    <td style="padding:8px 12px;font-family:var(--mono);font-size:11px;color:var(--dim)">${h.purchasedYear||'—'} (${Math.max(0,new Date().getFullYear()-parseInt(h.purchasedYear||new Date().getFullYear()))}y)</td>
    <td style="padding:8px 12px"><span style="color:${aHc(h.health||0)};font-family:var(--mono);font-weight:700">${h.health||0}</span></td>
    <td style="padding:8px 12px">${aExpBadge(h.warrantyExpiry)}</td>
    <td style="padding:8px 12px;font-family:var(--mono);font-size:11px;color:#f08040">฿${h.purchaseCost||0}M</td>
    <td style="padding:8px 12px"><div style="display:flex;gap:4px"><button onclick="openEditAsset('${h.id.replace(/'/g,"\'")}')" style="padding:3px 8px;background:var(--card2);border:1px solid var(--border2);border-radius:5px;color:var(--text);cursor:pointer;font-size:11px">✏</button><button onclick="openAssetConf('${h.id.replace(/'/g,"\'")}','${h.name.replace(/'/g,"\'")}');" style="padding:3px 8px;background:rgba(224,90,90,.1);border:1px solid rgba(224,90,90,.3);border-radius:5px;color:#e05a5a;cursor:pointer;font-size:11px">🗑</button></div></td>
  </tr>`).join('');
}

// ─── RENDER: SECURITY ────────────────────────────────────────────────────
function renderAssetSecurity(){
  const SEC=assetData.filter(a=>a.assetType==='security');
  const cats={};SEC.forEach(s=>{cats[s.category]=(cats[s.category]||0)+1;});
  const expL=SEC.filter(s=>aYearLeft(s.licenseExpiry)<=1).length;
  const avgH=SEC.length?Math.round(SEC.reduce((s,a)=>s+(a.health||0),0)/SEC.length):0;
  const el=document.getElementById('sec-stats2');
  if(el) el.innerHTML=[
    aStatCard('rd','Security Devices',SEC.length,'Total'),
    aStatCard('gd','License Expiring',expL,'≤ 1 year'),
    aStatCard('bl','Avg Health',avgH,'Score'),
    aStatCard('gn','Managed by Vendor',SEC.filter(s=>s.managedBy==='vendor').length,'Devices'),
  ].join('');
  if(!window._aCharts)window._aCharts={};
  if(window._aCharts.secCat)window._aCharts.secCat.destroy();
  const PAL=['#e05a5a','#f08040','#f0c040','#3d8ef0','#9b6ef0','#2ecc8a','#2eccc8'];
  const secCatCtx=document.getElementById('secCat');
  if(secCatCtx) window._aCharts.secCat=new Chart(secCatCtx,{type:'doughnut',data:{labels:Object.keys(cats),datasets:[{data:Object.values(cats),backgroundColor:PAL.slice(0,Object.keys(cats).length).map(c=>c+'99'),borderColor:PAL.slice(0,Object.keys(cats).length),borderWidth:1}]},options:{responsive:true,plugins:{legend:{position:'right',labels:{font:{size:10},padding:7,color:'var(--dim)'}}},cutout:'55%'}});
  const sorted=[...SEC].sort((a,b)=>aYearLeft(a.licenseExpiry)-aYearLeft(b.licenseExpiry));
  const lEl=document.getElementById('secLicense');
  if(lEl) lEl.innerHTML=sorted.slice(0,6).map(s=>`<div class="wt-item"><div style="flex:1;min-width:0"><div style="font-size:11px;font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${s.name}</div><div style="font-size:9px;font-family:var(--mono);color:var(--dim)">${s.category} · ${s.brand}</div></div>${aExpBadge(s.licenseExpiry)}</div>`).join('');
  const tbody=document.getElementById('sec-tbody');
  if(tbody) tbody.innerHTML=SEC.map(s=>`<tr style="border-bottom:1px solid var(--border2)">
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:var(--dim)">${s.id}</td>
    <td style="padding:8px 12px;font-size:12px;font-weight:600;color:var(--text)">${s.name}</td>
    <td style="padding:8px 12px"><span style="padding:2px 8px;border-radius:4px;background:#e05a5a22;color:#e05a5a;font-size:10px">${s.category}</span></td>
    <td style="padding:8px 12px;font-size:11px;color:var(--text)">${s.brand} ${s.model}</td>
    <td style="padding:8px 12px;font-size:10px;color:var(--dim)">${s.location?`${s.location.site}/${s.location.room||'Cloud'}`:'—'}</td>
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:#3d8ef0">${s.firmwareVersion||'—'}</td>
    <td style="padding:8px 12px"><span style="color:${aHc(s.health||0)};font-family:var(--mono);font-weight:700">${s.health||0}</span></td>
    <td style="padding:8px 12px">${aExpBadge(s.licenseExpiry)}</td>
    <td style="padding:8px 12px;font-size:10px;color:var(--dim)">${s.throughput||'—'}</td>
    <td style="padding:8px 12px"><div style="display:flex;gap:4px"><button onclick="openEditAsset('${s.id.replace(/'/g,"\'")}')" style="padding:3px 8px;background:var(--card2);border:1px solid var(--border2);border-radius:5px;color:var(--text);cursor:pointer;font-size:11px">✏</button><button onclick="openAssetConf('${s.id.replace(/'/g,"\'")}','${s.name.replace(/'/g,"\'")}');" style="padding:3px 8px;background:rgba(224,90,90,.1);border:1px solid rgba(224,90,90,.3);border-radius:5px;color:#e05a5a;cursor:pointer;font-size:11px">🗑</button></div></td>
  </tr>`).join('');
}

// ─── RENDER: NETWORK ─────────────────────────────────────────────────────
function renderAssetNetwork(){
  const NET=assetData.filter(a=>a.assetType==='network');
  const cats={};NET.forEach(n=>{cats[n.category]=(cats[n.category]||0)+1;});
  const expW=NET.filter(n=>aYearLeft(n.warrantyExpiry)<=1).length;
  const avgH=NET.length?Math.round(NET.reduce((s,n)=>s+(n.health||0),0)/NET.length):0;
  const el=document.getElementById('net-stats');
  if(el) el.innerHTML=[
    aStatCard('tl','Network Devices',NET.length,'Total'),
    aStatCard('gd','Warranty Expiring',expW,'≤ 1 year'),
    aStatCard('bl','Avg Health',avgH,'Score'),
    aStatCard('rd','Legacy (No Support)',NET.filter(n=>n.supportContract==='none').length,'Devices'),
  ].join('');
  if(!window._aCharts)window._aCharts={};
  if(window._aCharts.netCat)window._aCharts.netCat.destroy();
  const PAL=['#3d8ef0','#f08040','#2ecc8a','#f0c040','#9b6ef0','#2eccc8','#e05a5a'];
  const netCatCtx=document.getElementById('netCat');
  if(netCatCtx) window._aCharts.netCat=new Chart(netCatCtx,{type:'bar',data:{labels:Object.keys(cats),datasets:[{data:Object.values(cats),backgroundColor:PAL.slice(0,Object.keys(cats).length).map(c=>c+'88'),borderColor:PAL.slice(0,Object.keys(cats).length),borderWidth:1,borderRadius:4}]},options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,ticks:{color:'var(--dim)'},grid:{color:'rgba(255,255,255,.05)'}},x:{ticks:{color:'var(--dim)'},grid:{display:false}}}}});
  const fwEl=document.getElementById('netFw');
  if(fwEl) fwEl.innerHTML=[...NET].map(n=>{const ok=n.health>=80;return`<div class="wt-item"><div style="flex:1;min-width:0"><div style="font-size:11px;font-weight:600;color:var(--text)">${n.name}</div><div style="font-size:9px;font-family:var(--mono);color:#2eccc8">${n.firmwareVersion||'—'}</div></div><div style="font-size:10px;font-family:var(--mono);color:var(--dim);margin:0 8px">${n.lastPatchDate||'N/A'}</div><span style="padding:2px 8px;border-radius:4px;background:${ok?'#2ecc8a22':'#e05a5a22'};color:${ok?'#2ecc8a':'#e05a5a'};font-size:10px">${ok?'✓ OK':'⚠ Update'}</span></div>`;}).join('');
  const tbody=document.getElementById('net-tbody');
  if(tbody) tbody.innerHTML=NET.map(n=>`<tr style="border-bottom:1px solid var(--border2)">
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:var(--dim)">${n.id}</td>
    <td style="padding:8px 12px;font-size:12px;font-weight:600;color:var(--text)">${n.name}</td>
    <td style="padding:8px 12px"><span style="padding:2px 8px;border-radius:4px;background:#2eccc822;color:#2eccc8;font-size:10px">${n.category}</span></td>
    <td style="padding:8px 12px;font-size:11px;color:var(--text)">${n.brand} ${n.model}</td>
    <td style="padding:8px 12px;font-size:10px;color:var(--dim)">${n.location?`${n.location.site}/${n.location.room||'—'}`:'—'}</td>
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:#f0c040">${n.ipAddress||'—'}</td>
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:#2eccc8">${n.firmwareVersion||'—'}</td>
    <td style="padding:8px 12px"><span style="color:${aHc(n.health||0)};font-family:var(--mono);font-weight:700">${n.health||0}</span></td>
    <td style="padding:8px 12px">${aExpBadge(n.warrantyExpiry)}</td>
    <td style="padding:8px 12px"><div style="display:flex;gap:4px"><button onclick="openEditAsset('${n.id.replace(/'/g,"\'")}')" style="padding:3px 8px;background:var(--card2);border:1px solid var(--border2);border-radius:5px;color:var(--text);cursor:pointer;font-size:11px">✏</button><button onclick="openAssetConf('${n.id.replace(/'/g,"\'")}','${n.name.replace(/'/g,"\'")}');" style="padding:3px 8px;background:rgba(224,90,90,.1);border:1px solid rgba(224,90,90,.3);border-radius:5px;color:#e05a5a;cursor:pointer;font-size:11px">🗑</button></div></td>
  </tr>`).join('');
}

// ─── RENDER: ENDPOINT ────────────────────────────────────────────────────
function renderAssetEndpoint(){
  const EP=assetData.filter(a=>a.assetType==='endpoint');
  const expL=EP.filter(e=>aYearLeft(e.licenseExpiry)<=1).length;
  const totalLic=EP.reduce((s,e)=>s+(parseInt(e.licenseCount)||0),0);
  const totalDep=EP.reduce((s,e)=>s+(parseInt(e.deployedCount)||0),0);
  const avgCov=totalLic?Math.round(totalDep/totalLic*100):0;
  const el=document.getElementById('ep-stats');
  if(el) el.innerHTML=[
    aStatCard('pp','Endpoint Solutions',EP.length,'Total'),
    aStatCard('gd','License Expiring',expL,'≤ 1 year'),
    aStatCard('bl','Total Licenses',totalLic,'จำนวน seat'),
    aStatCard(avgCov<90?'gd':'gn','Avg Coverage',`${avgCov}%`,`${totalDep}/${totalLic} deployed`),
  ].join('');
  const covEl=document.getElementById('epCoverage');
  if(covEl) covEl.innerHTML=EP.map(e=>{const cov=e.licenseCount?Math.round((e.deployedCount||0)/e.licenseCount*100):0;const cc=cov>=90?'#2ecc8a':cov>=70?'#f0c040':'#e05a5a';return`<div style="margin-bottom:10px"><div style="display:flex;justify-content:space-between;font-size:11px;margin-bottom:3px"><span style="color:var(--text);font-weight:500">${e.name}</span><span style="font-family:var(--mono);color:${cc}">${cov}%</span></div><div class="comp-bar"><div class="comp-fill" style="width:${cov}%;background:${cc}"></div></div><div style="font-size:9px;font-family:var(--mono);color:var(--dim)">${e.deployedCount||0} / ${e.licenseCount||0} endpoints · ${e.brand}</div></div>`;}).join('');
  const licEl=document.getElementById('epLicense');
  if(licEl) licEl.innerHTML=[...EP].sort((a,b)=>aYearLeft(a.licenseExpiry)-aYearLeft(b.licenseExpiry)).map(e=>`<div class="wt-item"><div style="flex:1;min-width:0"><div style="font-size:11px;font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${e.name}</div><div style="font-size:9px;font-family:var(--mono);color:var(--dim)">${e.category} · ${e.licenseCount||0} licenses</div></div>${aExpBadge(e.licenseExpiry)}</div>`).join('');
  const tbody=document.getElementById('ep-tbody');
  if(tbody) tbody.innerHTML=EP.map(e=>{const cov=e.licenseCount?Math.round((e.deployedCount||0)/e.licenseCount*100):0;const cc=cov>=90?'#2ecc8a':cov>=70?'#f0c040':'#e05a5a';return`<tr style="border-bottom:1px solid var(--border2)">
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:var(--dim)">${e.id}</td>
    <td style="padding:8px 12px;font-size:12px;font-weight:600;color:var(--text)">${e.name}</td>
    <td style="padding:8px 12px"><span style="padding:2px 8px;border-radius:4px;background:#9b6ef022;color:#9b6ef0;font-size:10px">${e.category}</span></td>
    <td style="padding:8px 12px;font-size:11px;color:var(--text)">${e.brand}</td>
    <td style="padding:8px 12px;font-family:var(--mono);font-size:10px;color:#3d8ef0">${e.firmwareVersion||e.version||'—'}</td>
    <td style="padding:8px 12px;font-family:var(--mono);font-size:11px;color:var(--dim)">${e.deployedCount||0}</td>
    <td style="padding:8px 12px"><div style="display:flex;align-items:center;gap:5px"><div style="width:40px;height:4px;background:var(--card2);border-radius:2px;overflow:hidden"><div style="width:${cov}%;height:100%;background:${cc}"></div></div><span style="font-family:var(--mono);font-size:10px;color:${cc}">${cov}%</span></div></td>
    <td style="padding:8px 12px">${aExpBadge(e.licenseExpiry)}</td>
    <td style="padding:8px 12px"><span style="color:${aHc(e.health||0)};font-family:var(--mono);font-weight:700">${e.health||0}</span></td>
    <td style="padding:8px 12px"><div style="display:flex;gap:4px"><button onclick="openEditAsset('${e.id.replace(/'/g,"\'")}')" style="padding:3px 8px;background:var(--card2);border:1px solid var(--border2);border-radius:5px;color:var(--text);cursor:pointer;font-size:11px">✏</button><button onclick="openAssetConf('${e.id.replace(/'/g,"\'")}','${e.name.replace(/'/g,"\'")}');" style="padding:3px 8px;background:rgba(224,90,90,.1);border:1px solid rgba(224,90,90,.3);border-radius:5px;color:#e05a5a;cursor:pointer;font-size:11px">🗑</button></div></td>
  </tr>`}).join('');
}

// ─── RENDER: ASSET ANALYTICS ─────────────────────────────────────────────
function renderAssetAnalytics(){
  const AS=assetData;
  const expW1=AS.filter(a=>aYearLeft(a.warrantyExpiry)<=1).length;
  const expL1=AS.filter(a=>aYearLeft(a.licenseExpiry)<=1).length;
  const noFw=AS.filter(a=>!a.firmwareVersion||a.firmwareVersion==='—').length;
  const avgH=AS.length?Math.round(AS.reduce((s,a)=>s+(a.health||0),0)/AS.length):0;
  const el=document.getElementById('anas');
  if(el) el.innerHTML=[
    aStatCard('rd','Warranty Exp ≤1yr',expW1,'Assets'),
    aStatCard('gd','License Exp ≤1yr',expL1,'Assets'),
    aStatCard('og','No Firmware Info',noFw,'Assets'),
    aStatCard('bl','Avg Health',avgH,'All Assets'),
  ].join('');

  // Security compliance
  const SEC=AS.filter(a=>a.assetType==='security');
  const EP=AS.filter(a=>a.assetType==='endpoint');
  const scEl=document.getElementById('secComp');
  if(scEl) scEl.innerHTML=[...SEC,...EP].map(a=>{
    const licOk=!a.licenseExpiry||a.licenseExpiry==='—'||aYearLeft(a.licenseExpiry)>0;
    const fwOk=a.firmwareVersion&&a.firmwareVersion!=='—';
    const patchOk=a.lastPatchDate&&a.lastPatchDate!=='—';
    const score=Math.round(((licOk?1:0)+(fwOk?1:0)+(patchOk?1:0))/3*100);
    const sc=score>=80?'#2ecc8a':score>=60?'#f0c040':'#e05a5a';
    return`<div style="margin-bottom:10px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:3px"><div style="font-size:11px;font-weight:600;color:var(--text)">${a.name}</div><div style="font-size:9px;font-family:var(--mono);color:${sc}">${score}%</div></div><div class="comp-bar"><div class="comp-fill" style="width:${score}%;background:${sc}"></div></div><div style="display:flex;gap:5px;margin-top:3px"><span style="font-size:9px;font-family:var(--mono);padding:1px 5px;border-radius:3px;background:${licOk?'#2ecc8a22':'#e05a5a22'};color:${licOk?'#2ecc8a':'#e05a5a'}">${licOk?'✓ License':'✗ License'}</span><span style="font-size:9px;font-family:var(--mono);padding:1px 5px;border-radius:3px;background:${fwOk?'#2ecc8a22':'#e05a5a22'};color:${fwOk?'#2ecc8a':'#e05a5a'}">${fwOk?'✓ Firmware':'✗ Firmware'}</span><span style="font-size:9px;font-family:var(--mono);padding:1px 5px;border-radius:3px;background:${patchOk?'#2ecc8a22':'#e05a5a22'};color:${patchOk?'#2ecc8a':'#e05a5a'}">${patchOk?'✓ Patch':'✗ Patch'}</span></div></div>`;
  }).join('');

  // Vendor concentration
  const vmap={};AS.forEach(a=>{if(a.brand&&a.brand!=='—')vmap[a.brand]=(vmap[a.brand]||0)+1;});
  const top6=Object.entries(vmap).sort((a,b)=>b[1]-a[1]).slice(0,8);
  const vgEl=document.getElementById('vendorGrid');
  if(vgEl) vgEl.innerHTML=top6.map(([v,c])=>{const rk=c>=4?'#e05a5a':c>=2?'#f0c040':'#2ecc8a';return`<div class="asset-vc"><div class="asset-vn">${v}</div><div class="asset-vv" style="color:${rk}">${c}</div><div style="font-size:9px;color:var(--dim)">Assets</div><div style="font-size:9px;font-family:var(--mono);color:${rk}">${c>=4?'High Conc.':c>=2?'Medium':'Low'}</div></div>`;}).join('');

  // Location chart
  const sites={};AS.forEach(a=>{const s=(a.location||{}).site||'Unknown';sites[s]=(sites[s]||0)+1;});
  if(!window._aCharts)window._aCharts={};
  if(window._aCharts.locChart)window._aCharts.locChart.destroy();
  const PAL=['#3d8ef0','#f08040','#2ecc8a','#f0c040','#9b6ef0','#2eccc8'];
  const lcCtx=document.getElementById('locChart');
  if(lcCtx) window._aCharts.locChart=new Chart(lcCtx,{type:'bar',data:{labels:Object.keys(sites),datasets:[{data:Object.values(sites),backgroundColor:PAL.map(c=>c+'88'),borderColor:PAL,borderWidth:1,borderRadius:4}]},options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true,ticks:{color:'var(--dim)'},grid:{color:'rgba(255,255,255,.05)'}},x:{ticks:{color:'var(--dim)'},grid:{display:false}}}}});

  // Expiry risk
  const allExp=[...AS].map(a=>({...a,_d:Math.min(aYearLeft(a.warrantyExpiry),aYearLeft(a.licenseExpiry))})).filter(a=>a._d<=2).sort((a,b)=>a._d-b._d);
  const erEl=document.getElementById('expRisk');
  if(erEl) erEl.innerHTML=allExp.slice(0,8).map(a=>`<div class="wt-item"><div style="flex:1;min-width:0"><div style="font-size:11px;font-weight:600;color:var(--text);overflow:hidden;text-overflow:ellipsis;white-space:nowrap">${a.name}</div><div style="font-size:9px;font-family:var(--mono);color:var(--dim)">${AT_LABEL[a.assetType]} · W:${a.warrantyExpiry||'—'} L:${a.licenseExpiry||'—'}</div></div><div style="font-size:10px;font-family:var(--mono);color:${a._d<=0?'#e05a5a':a._d<=1?'#f08040':'#f0c040'};min-width:60px;text-align:right">${a._d<=0?'EXPIRED!':a._d+'yr left'}</div></div>`).join('')||'<div style="text-align:center;color:var(--dim);font-size:11px;padding:15px">✅ ไม่มี asset expiring ใน 2 ปี</div>';
}

// ─── MODAL: ADD/EDIT ASSET ────────────────────────────────────────────────
function onAssetTypeChange(){
  const t=document.getElementById('as-type').value;
  const cats=ASSET_CATS[t]||[];
  const catEl=document.getElementById('as-cat');
  if(catEl) catEl.innerHTML=cats.map(c=>`<option>${c}</option>`).join('');
  const depGrp=document.getElementById('dep-group');
  const snGrp=document.getElementById('sn-group');
  if(depGrp) depGrp.style.display=t==='endpoint'?'block':'none';
  if(snGrp) snGrp.style.display='block';
}
function openAddAsset(){
  editAssetId=null;
  document.getElementById('asset-modal-title').textContent='＋ Add Asset';
  document.getElementById('asset-save-btn').textContent='💾 บันทึก';
  ['as-name','as-desc','as-brand','as-model','as-sn','as-site','as-room','as-rack','as-ip',
   'as-health','as-cost','as-tco','as-purchased','as-warranty','as-fw','as-patch',
   'as-liccount','as-licexp','as-deployed','as-throughput','as-ports','as-owner'].forEach(id=>{const el=document.getElementById(id);if(el)el.value='';});
  document.getElementById('as-type').value='hardware';onAssetTypeChange();
  document.getElementById('as-id').value=aGid('hardware');
  document.getElementById('asset-modal').classList.add('open');
}
function openAddAssetType(type){
  openAddAsset();
  document.getElementById('as-type').value=type;onAssetTypeChange();
  document.getElementById('as-id').value=aGid(type);
}
function openEditAsset(id){
  const a=assetData.find(x=>x.id===id);if(!a)return;
  editAssetId=id;
  document.getElementById('asset-modal-title').textContent=`✏ แก้ไข: ${a.name}`;
  document.getElementById('asset-save-btn').textContent='💾 อัพเดต';
  document.getElementById('as-type').value=a.assetType||'hardware';onAssetTypeChange();
  const fields={
    'as-cat':a.category||'','as-id':a.id,'as-name':a.name||'','as-desc':a.description||'',
    'as-brand':a.brand||'','as-model':a.model||'','as-sn':a.serialNumber||'',
    'as-site':(a.location||{}).site||'','as-room':(a.location||{}).room||'','as-rack':(a.location||{}).rack||'',
    'as-ip':a.ipAddress||'','as-crit':a.criticality||'Business Critical','as-health':a.health||'',
    'as-cost':a.purchaseCost||'','as-tco':a.tco||'','as-purchased':a.purchasedYear||'',
    'as-warranty':a.warrantyExpiry||'','as-support':a.supportContract||'vendor',
    'as-fw':a.firmwareVersion||'','as-patch':a.lastPatchDate||'','as-liccount':a.licenseCount||'',
    'as-licexp':a.licenseExpiry||'','as-throughput':a.throughput||'','as-ports':a.ports||'',
    'as-owner':a.owner||'','as-managed':a.managedBy||'inhouse','as-deployed':a.deployedCount||''
  };
  Object.entries(fields).forEach(([id,val])=>{const el=document.getElementById(id);if(el)el.value=val;});
  document.getElementById('asset-modal').classList.add('open');
}
function closeAssetModal(){document.getElementById('asset-modal').classList.remove('open');editAssetId=null;}
function saveAsset(){
  const nameEl=document.getElementById('as-name');if(!nameEl)return;
  const name=nameEl.value.trim();if(!name){alert('กรุณากรอกชื่อ Asset');return;}
  const type=document.getElementById('as-type').value;
  const g=id=>document.getElementById(id);
  const asset={
    id:editAssetId||g('as-id').value,name,assetType:type,
    category:g('as-cat').value,description:g('as-desc').value.trim(),
    brand:g('as-brand').value.trim(),model:g('as-model').value.trim(),
    serialNumber:g('as-sn').value.trim(),
    location:{site:g('as-site').value.trim(),room:g('as-room').value.trim(),rack:g('as-rack').value.trim()},
    ipAddress:g('as-ip').value.trim(),criticality:g('as-crit').value,
    health:parseInt(g('as-health').value)||0,
    purchaseCost:parseFloat(g('as-cost').value)||0,tco:parseFloat(g('as-tco').value)||0,
    purchasedYear:g('as-purchased').value.trim(),warrantyExpiry:g('as-warranty').value.trim()||'—',
    supportContract:g('as-support').value,firmwareVersion:g('as-fw').value.trim(),
    lastPatchDate:g('as-patch').value.trim(),licenseCount:parseInt(g('as-liccount').value)||0,
    licenseExpiry:g('as-licexp').value.trim()||'—',
    throughput:g('as-throughput').value.trim(),ports:g('as-ports').value.trim(),
    owner:g('as-owner').value.trim(),managedBy:g('as-managed').value,status:'active'
  };
  if(type==='endpoint'&&g('as-deployed'))asset.deployedCount=parseInt(g('as-deployed').value)||0;
  const i=assetData.findIndex(a=>a.id===asset.id);
  if(i>=0)assetData[i]={...assetData[i],...asset};
  else assetData.push(asset);
  closeAssetModal();
  // Re-render current asset view
  const curView=document.querySelector('.view.active');
  if(curView){
    const vm={'view-asset-inventory':renderAssetInventory,'view-asset-hardware':renderAssetHardware,'view-asset-security':renderAssetSecurity,'view-asset-network':renderAssetNetwork,'view-asset-endpoint':renderAssetEndpoint,'view-asset-analytics':renderAssetAnalytics};
    if(vm[curView.id])vm[curView.id]();
  }
}

// ─── ASSET DELETE ────────────────────────────────────────────────────────
function openAssetConf(id,name){
  pendingDelId=id;
  const ctxt=document.getElementById('asset-ctxt');
  if(ctxt)ctxt.textContent=`ต้องการลบ "${name}"?`;
  document.getElementById('asset-conf').classList.add('open');
  document.getElementById('asset-cok').onclick=()=>{
    assetData=assetData.filter(a=>a.id!==pendingDelId);
    closeAssetConf();
    const curView=document.querySelector('.view.active');
    if(curView){const vm={'view-asset-inventory':renderAssetInventory,'view-asset-hardware':renderAssetHardware,'view-asset-security':renderAssetSecurity,'view-asset-network':renderAssetNetwork,'view-asset-endpoint':renderAssetEndpoint,'view-asset-analytics':renderAssetAnalytics};if(vm[curView.id])vm[curView.id]();}
  };
}
function closeAssetConf(){document.getElementById('asset-conf').classList.remove('open');pendingDelId=null;}


// ─── FULL STACK: OVERRIDE CRUD HANDLERS ────────────────────────────────────────

// Override: Add App modal submit → POST /api/apps
document.getElementById('modal-submit').onclick = async ()=>{
  const name = document.getElementById('f-name').value.trim();
  if(!name){ document.getElementById('f-name').focus(); return; }
  const h = +document.getElementById('f-health').value||75;
  const btn = document.getElementById('modal-submit');
  btn.disabled = true; btn.textContent = '⏳ กำลังบันทึก…';
  try {
    await apiPost('/api/apps', {
      name,
      vendor:      document.getElementById('f-vendor').value||'Unknown',
      domain:      document.getElementById('f-domain').value,
      type:        document.getElementById('f-type').value,
      status:      document.getElementById('f-status').value,
      bcg:         document.getElementById('f-bcg').value,
      criticality: document.getElementById('f-criticality').value,
      health:      h, tech_debt: 100-h,
      tco:         +document.getElementById('f-tco').value||1000,
      users:       +document.getElementById('f-users').value||100,
      age:         +document.getElementById('f-age').value||0,
      dr:          document.getElementById('f-dr').value==='true',
      stack:       document.getElementById('f-stack').value.split(',').map(s=>s.trim()).filter(Boolean),
      capability:  document.getElementById('f-capability').value||'TBD',
      persons:3, src_avail:true, service_hour:'Business Hours',
      maint_window:'Sat 22:00-02:00', lang:'TBD', os:'TBD',
      db_platform:'TBD', support:'Inhouse', owner:'TBD',
      biz_owner: document.getElementById('f-bizowner')?.value.trim()||'',
      compliance: getCheckedCompliance('f-compliance'),
      stream:'Other', approach:'Upgrade', assess_status:'Not Started', wave:3,
    });
    document.getElementById('modal').style.display='none';
    ['f-name','f-vendor','f-stack','f-capability'].forEach(id=>document.getElementById(id).value='');
    showToast('✅ เพิ่มแอปพลิเคชันเรียบร้อย');
    await refreshAndRender();
  } catch(e){
    showToast('❌ '+e.message, 'error');
  } finally {
    btn.disabled=false; btn.textContent='Add Application';
  }
};

// Override: Edit App modal submit → PUT /api/apps/:id
document.getElementById('modal-edit-submit').onclick = async ()=>{
  const idx = apps.findIndex(x=>x.id===editingAppId);
  if(idx<0) return;
  const h   = +document.getElementById('e-health').value||75;
  const sub = document.getElementById('e-ea-subcategory').value.trim();
  const btn = document.getElementById('modal-edit-submit');
  btn.disabled=true; btn.textContent='⏳ กำลังบันทึก…';
  try {
    await apiPut(`/api/apps/${editingAppId}`, {
      name:           document.getElementById('e-name').value.trim()||apps[idx].name,
      vendor:         document.getElementById('e-vendor').value.trim(),
      domain:         document.getElementById('e-domain').value,
      type:           document.getElementById('e-type').value,
      status:         document.getElementById('e-status').value,
      bcg:            document.getElementById('e-bcg').value,
      criticality:    document.getElementById('e-criticality').value,
      health:h, tech_debt:100-h,
      tco:            +document.getElementById('e-tco').value||apps[idx].tco,
      users:          +document.getElementById('e-users').value||apps[idx].users,
      age:            +document.getElementById('e-age').value||apps[idx].age,
      dr:             document.getElementById('e-dr').value==='true',
      stack:          document.getElementById('e-stack').value.split(',').map(s=>s.trim()).filter(Boolean),
      capability:     document.getElementById('e-capability').value.trim(),
      ea_group:       document.getElementById('e-ea-group').value    ||apps[idx].eaGroup,
      ea_category:    document.getElementById('e-ea-category').value ||apps[idx].eaCategory,
      ea_sub_category:sub||'-',
      owner:          document.getElementById('e-owner').value.trim(),
      biz_owner:      document.getElementById('e-bizowner').value.trim(),
      compliance:     getCheckedCompliance('e-compliance'),
      service_hour:   document.getElementById('e-service').value,
      support:        document.getElementById('e-support').value,
      src_avail:      document.getElementById('e-srcavail').value==='true',
      maint_window:   document.getElementById('e-maintwindow').value.trim(),
      persons:        +document.getElementById('e-persons').value||apps[idx].persons,
      eol:            document.getElementById('e-eol').value.trim()||apps[idx].eol,
    });
    document.getElementById('modal-edit').style.display='none';
    showToast('✅ บันทึกการแก้ไขเรียบร้อย');
    await refreshAndRender();
  } catch(e){
    showToast('❌ '+e.message, 'error');
  } finally {
    btn.disabled=false; btn.textContent='💾 บันทึกการแก้ไข';
  }
};

// Override: Decommission confirm → POST /api/apps/:id/decommission
document.getElementById('modal-decomm-confirm').onclick = async ()=>{
  const date   = document.getElementById('decomm-date')?.value || new Date().toISOString().slice(0,10);
  const reason = document.getElementById('decomm-reason')?.value.trim() || 'ไม่ระบุ';
  const btn    = document.getElementById('modal-decomm-confirm');
  btn.disabled=true; btn.textContent='⏳ กำลังดำเนินการ…';
  try {
    await apiPost(`/api/apps/${decommAppId}/decommission`, {
      decomm_date: date, decomm_reason: reason
    });
    document.getElementById('modal-decomm').style.display='none';
    showToast('🔴 Decommission เรียบร้อย');
    await refreshAndRender();
  } catch(e){
    showToast('❌ '+e.message,'error');
  } finally {
    btn.disabled=false; btn.textContent='🔴 ยืนยัน Decommission';
  }
};


// ─── INIT (FULL STACK) ─────────────────────────────────────────────────────────
(async ()=>{
  try {
    // Build compliance chips from centralized COMPLIANCE_STANDARDS
    buildComplianceChips('e-compliance');
    buildComplianceChips('f-compliance');
    await loadAppsFromAPI();
    initPortfolioFilters();
    renderDashboard();
    renderPortfolio();
  } catch(e){
    console.error('Startup error:', e);
    document.getElementById('content-area').innerHTML =
      `<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:60vh;gap:16px;color:var(--red)">
        <div style="font-size:48px">⚠️</div>
        <div style="font-size:18px;font-weight:700">ไม่สามารถเชื่อมต่อ Backend ได้</div>
        <div style="font-size:13px;color:var(--dim)">กรุณาตรวจสอบว่า server.py กำลังรันอยู่ที่ port 8000</div>
        <div style="font-family:var(--mono);font-size:12px;background:var(--card2);padding:12px 20px;border-radius:8px;color:var(--accent)">python server.py</div>
        <button onclick="location.reload()" style="margin-top:8px;padding:10px 24px;background:var(--accent);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700">🔄 ลองใหม่</button>
      </div>`;
  }
})();

</script>
</body>
</html>
